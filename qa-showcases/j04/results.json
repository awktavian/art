{
  "journey": {
    "$schema": "./journey-schema.json",
    "id": "j04",
    "name": "Voice Commands",
    "description": "Verifies voice command functionality - wake word, natural language commands, and feedback",
    "tags": [
      "voice",
      "assistant",
      "commands",
      "core"
    ],
    "safety_critical": false,
    "phases": [
      {
        "id": "P1",
        "name": "Voice Ready",
        "description": "Voice interface is accessible and ready",
        "assertions": [
          {
            "type": "visible",
            "value": "Kagami",
            "timeout_ms": 5000
          },
          {
            "type": "visible",
            "value": "Voice|Microphone|Speak|Listen",
            "timeout_ms": 3000
          }
        ],
        "screenshot": true
      },
      {
        "id": "P2",
        "name": "Listening State",
        "description": "Tap microphone to start listening",
        "actions": [
          {
            "type": "tap_id",
            "target": "voice-button"
          },
          {
            "type": "wait",
            "duration_ms": 1000
          }
        ],
        "assertions": [
          {
            "type": "visible",
            "value": "Listening|Speak now|Recording",
            "timeout_ms": 3000
          }
        ],
        "screenshot": true
      },
      {
        "id": "P3",
        "name": "Command Processing",
        "description": "Voice command is processed",
        "actions": [
          {
            "type": "wait",
            "duration_ms": 3000
          }
        ],
        "assertions": [
          {
            "type": "visible",
            "value": "Processing|Understanding|Thinking",
            "timeout_ms": 5000
          }
        ],
        "screenshot": true
      },
      {
        "id": "P4",
        "name": "Response Display",
        "description": "Response is shown to user",
        "assertions": [
          {
            "type": "visible",
            "value": "Done|OK|Completed|Response|Result",
            "timeout_ms": 5000
          }
        ],
        "screenshot": true
      },
      {
        "id": "Final",
        "name": "Ready Again",
        "description": "Voice interface returns to ready state",
        "actions": [
          {
            "type": "tap_text",
            "target": "Done|Close|Dismiss"
          },
          {
            "type": "wait",
            "duration_ms": 1000
          }
        ],
        "assertions": [
          {
            "type": "visible",
            "value": "Kagami|Voice|Microphone",
            "timeout_ms": 3000
          }
        ],
        "screenshot": true
      }
    ],
    "platforms": {
      "ios": {
        "enabled": true,
        "bundle_id": "com.kagami.ios",
        "launch_args": [
          "-KagamiSkipOnboarding"
        ]
      },
      "ipad": {
        "enabled": true,
        "bundle_id": "com.kagami.ios",
        "launch_args": [
          "-KagamiSkipOnboarding"
        ]
      },
      "android": {
        "enabled": true,
        "bundle_id": "com.kagami.android",
        "env_vars": {
          "kagami_test_bypass": "1"
        }
      },
      "wearos": {
        "enabled": true,
        "bundle_id": "com.kagami.wear",
        "env_vars": {
          "kagami_test_bypass": "1"
        }
      },
      "watchos": {
        "enabled": true,
        "bundle_id": "com.kagami.ios.watchkitapp",
        "launch_args": [
          "-KagamiSkipOnboarding"
        ]
      },
      "tvos": {
        "enabled": false,
        "bundle_id": "com.kagami.tv",
        "overrides": {
          "comment": "tvOS uses remote-based voice, different flow"
        }
      },
      "visionos": {
        "enabled": true,
        "bundle_id": "com.kagami.vision",
        "launch_args": [
          "-KagamiSkipOnboarding"
        ]
      },
      "desktop": {
        "enabled": true,
        "bundle_id": "com.kagami.desktop"
      }
    },
    "setup": {
      "requires_auth": false,
      "skip_onboarding": true,
      "pre_conditions": [
        "Microphone permission granted",
        "Network connectivity for voice processing"
      ]
    }
  },
  "platforms": [
    {
      "platform": "ios",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "pass",
          "assertions_checked": 2,
          "assertions_passed": 2
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/ios_P1.png"
      ],
      "status": "pass"
    },
    {
      "platform": "ipad",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "pass",
          "assertions_checked": 2,
          "assertions_passed": 2
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/ipad_P1.png"
      ],
      "status": "pass"
    },
    {
      "platform": "android",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "fail",
          "assertions_checked": 1,
          "assertions_passed": 0,
          "failed_assertion": {
            "type": "visible",
            "value": "Kagami",
            "timeout_ms": 5000
          }
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/android_P1.png"
      ],
      "status": "fail"
    },
    {
      "platform": "wearos",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "fail",
          "assertions_checked": 1,
          "assertions_passed": 0,
          "failed_assertion": {
            "type": "visible",
            "value": "Kagami",
            "timeout_ms": 5000
          }
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/wearos_P1.png"
      ],
      "status": "fail"
    },
    {
      "platform": "watchos",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "pass",
          "assertions_checked": 2,
          "assertions_passed": 2
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/watchos_P1.png"
      ],
      "status": "pass"
    },
    {
      "platform": "tvos",
      "status": "skipped",
      "reason": "Platform disabled in journey"
    },
    {
      "platform": "visionos",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "pass",
          "assertions_checked": 2,
          "assertions_passed": 2
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/visionos_P1.png"
      ],
      "status": "pass"
    },
    {
      "platform": "desktop",
      "journey_id": "j04",
      "journey_name": "Voice Commands",
      "phases": [
        {
          "id": "P1",
          "name": "Voice Ready",
          "status": "fail",
          "assertions_checked": 2,
          "assertions_passed": 1,
          "failed_assertion": {
            "type": "visible",
            "value": "Voice|Microphone|Speak|Listen",
            "timeout_ms": 3000
          }
        }
      ],
      "screenshots": [
        "/tmp/kagami-showcases/j04_20260116_074019/desktop_P1.png"
      ],
      "status": "fail"
    }
  ],
  "gemini_report": {
    "journey_id": "j04",
    "all_passed": false,
    "results": {
      "ios": {
        "screen_identified": "Home Screen",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "ios",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "'Kagami' is visible"
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "PASS",
            "details": "Microphone icon is visible"
          }
        ],
        "elements_found": [
          "Kagami",
          "Disconnected",
          "Home Hub",
          "Quick Actions",
          "Emergency",
          "Movie Mode",
          "Goodnight",
          "Lock All",
          "Active Scenes",
          "No active scenes",
          "Occupied Rooms",
          "No rooms currently occupied",
          "Protected",
          "Home",
          "Rooms",
          "Scenes",
          "Settings",
          "Microphone Icon"
        ],
        "elements_missing": [],
        "passed": true,
        "failure_reason": null,
        "issues": [],
        "scores": {
          "technical": 100,
          "accessibility": 100,
          "visual": 100
        },
        "score_justifications": {
          "technical": "All required elements are present and the app is in the expected state.",
          "accessibility": "The app appears to have good contrast and touch target sizes.",
          "visual": "The app follows iOS conventions, has a clear hierarchy, and looks polished."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Uses SF Symbols",
            "System fonts",
            "Navigation follows iOS HIG",
            "Safe area insets respected",
            "Touch targets minimum 44x44 points",
            "Rounded corners match system style"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The app is in the Voice Ready state and all primary elements are visible and conform to iOS conventions.",
        "recommendations": []
      },
      "ipad": {
        "screen_identified": "Home screen with quick actions and status indicators",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "ipad",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "'Kagami' is visible in the top left corner."
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "PASS",
            "details": "Microphone icon is visible in the top right corner."
          }
        ],
        "elements_found": [
          "Kagami",
          "Disconnected status",
          "Home Hub",
          "Quick Actions",
          "Emergency button",
          "Movie Mode button",
          "Goodnight button",
          "Lock All button",
          "Active Scenes section",
          "No active scenes message",
          "Occupied Rooms section",
          "No rooms currently occupied message",
          "Protected status",
          "Home navigation icon",
          "Rooms navigation icon",
          "Scenes navigation icon",
          "Settings navigation icon",
          "Microphone icon"
        ],
        "elements_missing": [],
        "passed": true,
        "failure_reason": null,
        "issues": [],
        "scores": {
          "technical": 100,
          "accessibility": 95,
          "visual": 95
        },
        "score_justifications": {
          "technical": "All required elements are present and visible, indicating a technically sound state.",
          "accessibility": "Good contrast and clear touch targets. Minor improvement could be made with larger touch targets.",
          "visual": "The layout is well-organized and adheres to the platform conventions. Slight improvement could be made by increasing spacing between sections."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Uses bottom navigation bar",
            "Clear visual hierarchy"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The app is in the Voice Ready state. It displays 'Kagami' and a microphone icon, as required. All primary elements are visible and the layout is clear.",
        "recommendations": [
          "Slightly increase spacing between sections for improved readability.",
          "Increase touch target size to improve accessibility"
        ]
      },
      "android": {
        "screen_identified": "Home Screen",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "android",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "'Kagami' is visible in the top left"
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "FAIL",
            "details": "No obvious Voice, Microphone, Speak, or Listen elements are visible on the screen. The screen shows the app in a general, ready state, but is missing the specific voice interaction element that the P1 phase expects."
          }
        ],
        "elements_found": [
          "Kagami",
          "Disconnected",
          "Safety",
          "Latency",
          "Quick Scenes",
          "Goodnight",
          "Movie",
          "Quick Actions",
          "Emergency",
          "Lights On",
          "Lights Off",
          "Open",
          "Close",
          "Control Center",
          "Rooms",
          "Scenes",
          "Home",
          "Rooms",
          "Scenes",
          "Settings"
        ],
        "elements_missing": [
          "Voice trigger",
          "Microphone",
          "Listen indicator"
        ],
        "passed": false,
        "failure_reason": "The screen is missing the required Voice, Microphone, Speak, or Listen element that is expected in Phase 1 for voice commands. It's a functional app screen, but not the 'Voice Ready' screen.",
        "issues": [
          {
            "severity": "critical",
            "category": "technical",
            "element": "Voice Interaction Element",
            "description": "The screen is missing any indication that it is ready to accept voice commands. No microphone icon, listening indicator, or voice trigger is present.",
            "expected": "A clear visual cue (e.g., microphone icon) to indicate the system is listening for voice commands.",
            "actual": "There is no voice element present.",
            "suggested_fix": "Add a prominent microphone icon or other voice trigger element to the screen.",
            "platform": "android"
          }
        ],
        "scores": {
          "technical": 60,
          "accessibility": 90,
          "visual": 85
        },
        "score_justifications": {
          "technical": "Technical score is 60 because a required element (voice trigger) is missing, but the basic app functionality seems to be present.",
          "accessibility": "Accessibility score is 90 because the UI appears reasonably accessible in terms of contrast and element sizes, but needs deeper inspection with assistive technologies.",
          "visual": "Visual score is 85 because the UI is well-designed and follows Android conventions. Minor points deducted for the 'Disconnected' state which is potentially confusing."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Material Design 3 patterns",
            "Edge-to-edge design",
            "System navigation (gesture)",
            "Roboto font",
            "Proper touch target sizes"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The screen is a functional part of the app but fails because it's missing the voice interaction element required for this phase of the voice command journey.",
        "recommendations": [
          "Add a prominent microphone icon or other clear visual cue to indicate the system is ready for voice commands.",
          "Ensure that the voice interaction element is always visible when the app is in the 'Voice Ready' state."
        ]
      },
      "wearos": {
        "screen_identified": "Wear OS watch face with 'Good Morning' and 'Emergency' options.",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "wearos",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "'Kagami'",
            "result": "PASS",
            "details": "'Kagami' is visible."
          },
          {
            "assertion": "'Voice|Microphone|Speak|Listen'",
            "result": "FAIL",
            "details": "No explicit indication of voice functionality visible. The text 'Tap to activate' might imply it, but it's not explicitly clear."
          }
        ],
        "elements_found": [
          "Time (7:41)",
          "Name (Kagami)",
          "Good Morning Button",
          "Tap to activate Text",
          "Emergency Button",
          "Settings Icon"
        ],
        "elements_missing": [
          "Clear voice command indicator/icon"
        ],
        "passed": false,
        "failure_reason": "Missing explicit indication of voice command functionality. The assertion 'Voice|Microphone|Speak|Listen' is not passing.",
        "issues": [
          {
            "severity": "critical",
            "category": "technical",
            "element": "Voice Command Indication",
            "description": "No clear visual cue indicating voice command availability or activation.",
            "expected": "A visible icon or text indicating voice command is ready (e.g., microphone icon).",
            "actual": "Only 'Tap to activate' text, which is ambiguous.",
            "suggested_fix": "Add a prominent microphone icon or text like 'Speak Now' when voice is ready.",
            "platform": "wearos"
          }
        ],
        "scores": {
          "technical": 65,
          "accessibility": 85,
          "visual": 80
        },
        "score_justifications": {
          "technical": "Significant issue: missing voice command indicator. Hence scoring below 70.",
          "accessibility": "Generally good accessibility due to large touch targets and clear text, but needs to clarify what is activated.",
          "visual": "Visually acceptable but could be improved with a more distinct voice command indicator."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Circular layout",
            "Large touch targets",
            "Glanceable information (time, name)"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The watch face is visually appealing and provides key information but lacks a clear indication that voice command functionality is available and ready to be used, hindering the first impression and potentially confusing the user.",
        "recommendations": [
          "Add a microphone icon or text like 'Speak Now' when voice command is ready.",
          "Make the 'Tap to activate' text more descriptive, specifying what is being activated (e.g., 'Tap to speak')."
        ]
      },
      "watchos": {
        "screen_identified": "Voice Ready screen",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "watchos",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "The text 'Kagami' is visible."
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "PASS",
            "details": "A microphone icon is visible."
          }
        ],
        "elements_found": [
          "Time (7:41)",
          "Microphone icon",
          "Kagami",
          "Connecting...",
          "Quick Actions",
          "Emergency button with red shield icon",
          "Activate safety mode"
        ],
        "elements_missing": [],
        "passed": true,
        "failure_reason": null,
        "issues": [],
        "scores": {
          "technical": 100,
          "accessibility": 100,
          "visual": 100
        },
        "score_justifications": {
          "technical": "All required elements are present and the screen appears to be functioning as expected.",
          "accessibility": "The screen has good contrast and touch targets appear to be large enough for easy interaction.",
          "visual": "The layout is clean, follows platform conventions, and has a clear visual hierarchy."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Rounded rectangle display awareness",
            "Large, tappable buttons",
            "SF Compact font for legibility"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The Voice Ready screen is correctly displayed with all required elements and a clean visual presentation.",
        "recommendations": []
      },
      "visionos": {
        "screen_identified": "Home screen with Kagami control panel",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "visionos",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "'Kagami' text is visible in the control panel."
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "FAIL",
            "details": "There is no visible 'Voice', 'Microphone', 'Speak', or 'Listen' indicator. Assuming we are in 'Voice Ready', there should be a microphone indicator."
          }
        ],
        "elements_found": [
          "Home",
          "Emergency",
          "Lights",
          "Movie Mode",
          "Goodnight",
          "All Off",
          "Kagami"
        ],
        "elements_missing": [
          "Voice input indicator (microphone icon or similar)"
        ],
        "passed": false,
        "failure_reason": "Missing voice input indicator while in Voice Ready mode.",
        "issues": [
          {
            "severity": "critical",
            "category": "technical",
            "element": "Voice input indicator",
            "description": "Missing voice input indicator when in voice ready mode. This is essential for the user to know if the system is listening for voice commands.",
            "expected": "Microphone indicator should be visible to indicate voice ready.",
            "actual": "No voice indicator present.",
            "suggested_fix": "Implement a microphone icon or other visual cue to confirm voice input readiness.",
            "platform": "visionos"
          }
        ],
        "scores": {
          "technical": 60,
          "accessibility": 85,
          "visual": 85
        },
        "score_justifications": {
          "technical": "Critical element (voice input indicator) missing. Lowers the score significantly.",
          "accessibility": "UI elements appear large enough and have good contrast.",
          "visual": "The UI is generally well-designed and follows common conventions."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Glass material backgrounds",
            "Eye-tracking friendly hit targets (assuming from button size)"
          ],
          "conventions_violated": [],
          "red_flags_found": [
            "Missing critical voice input indicator."
          ]
        },
        "summary": "The screen is generally well-designed, but the missing voice input indicator renders voice commands unusable for the user, making it a critical issue.",
        "recommendations": [
          "Add a voice input indicator (microphone icon or similar) to indicate when the system is in voice ready mode.",
          "Test the UI with users to identify any other potential usability issues."
        ]
      },
      "desktop": {
        "screen_identified": "Voice Ready screen for Voice Commands",
        "expected_screen": "Voice Ready screen for Voice Commands",
        "screen_matches_expected": true,
        "platform": "desktop",
        "phase": "P1",
        "journey_id": "j04",
        "assertions_checked": [
          {
            "assertion": "VISIBLE: 'Kagami'",
            "result": "PASS",
            "details": "'Kagami' is visible"
          },
          {
            "assertion": "VISIBLE: 'Voice|Microphone|Speak|Listen'",
            "result": "PASS",
            "details": "Microphone icon is visible, 'Type / for commands, @' implies voice input"
          }
        ],
        "elements_found": [
          "Skip to input",
          "Agent",
          "Auto",
          "Type / for commands, @",
          "Microphone icon",
          "Emergency",
          "Ready",
          "esc to close",
          "navigate",
          "switch mode",
          "enter to select",
          "Kagami"
        ],
        "elements_missing": [],
        "passed": true,
        "failure_reason": null,
        "issues": [],
        "scores": {
          "technical": 100,
          "accessibility": 100,
          "visual": 100
        },
        "score_justifications": {
          "technical": "All required elements are present and in the correct state.",
          "accessibility": "The screen appears to be accessible with good contrast and clear touch targets.",
          "visual": "The screen is visually polished and follows platform conventions."
        },
        "platform_compliance": {
          "conventions_followed": [
            "Keyboard navigation support",
            "Hover states (unclear in still image, but assumed)",
            "Appropriate click targets",
            "Command palette (type/for commands)"
          ],
          "conventions_violated": [],
          "red_flags_found": []
        },
        "summary": "The voice ready screen for voice commands is displayed correctly with all primary elements visible and no issues detected.",
        "recommendations": []
      }
    },
    "issues": [
      {
        "severity": "critical",
        "category": "technical",
        "element": "Voice Interaction Element",
        "description": "The screen is missing any indication that it is ready to accept voice commands. No microphone icon, listening indicator, or voice trigger is present.",
        "expected": "A clear visual cue (e.g., microphone icon) to indicate the system is listening for voice commands.",
        "actual": "There is no voice element present.",
        "suggested_fix": "Add a prominent microphone icon or other voice trigger element to the screen.",
        "platform": "android"
      },
      {
        "severity": "critical",
        "category": "technical",
        "element": "Voice Command Indication",
        "description": "No clear visual cue indicating voice command availability or activation.",
        "expected": "A visible icon or text indicating voice command is ready (e.g., microphone icon).",
        "actual": "Only 'Tap to activate' text, which is ambiguous.",
        "suggested_fix": "Add a prominent microphone icon or text like 'Speak Now' when voice is ready.",
        "platform": "wearos"
      },
      {
        "severity": "critical",
        "category": "technical",
        "element": "Voice input indicator",
        "description": "Missing voice input indicator when in voice ready mode. This is essential for the user to know if the system is listening for voice commands.",
        "expected": "Microphone indicator should be visible to indicate voice ready.",
        "actual": "No voice indicator present.",
        "suggested_fix": "Implement a microphone icon or other visual cue to confirm voice input readiness.",
        "platform": "visionos"
      }
    ]
  },
  "timestamp": "20260116_074019"
}