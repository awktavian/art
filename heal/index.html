<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#020204">
    <title>癒 — Heal</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Crimson+Pro:ital,wght@0,300;0,400;1,300;1,400&family=JetBrains+Mono:wght@300;400;500&family=Zen+Kaku+Gothic+New:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --text: #f4f1ea;
            --text-dim: rgba(244, 241, 234, 0.6);
            --text-whisper: rgba(244, 241, 234, 0.3);
            --text-ghost: rgba(244, 241, 234, 0.15);

            --flow-deep: #008B8B;
            --flow: #00cec9;
            --flow-bright: #00FFFF;
            --flow-dim: rgba(0, 206, 201, 0.5);
            --flow-glow: rgba(0, 206, 201, 0.3);
            --flow-whisper: rgba(0, 206, 201, 0.1);

            --gold: #c4a35a;
            --gold-bright: #d4af37;
            --gold-glow: rgba(196, 163, 90, 0.25);

            --void: #020204;
            --void-soft: #0a0a0f;
            --void-code: #0d1117;

            --danger: #ff6b6b;
            --danger-dim: rgba(255, 107, 107, 0.15);
            --success: #4ade80;
            --success-dim: rgba(74, 222, 128, 0.15);
            --warning: #fbbf24;
            --warning-dim: rgba(251, 191, 36, 0.15);
            --purple: #a78bfa;

            --font-display: 'Cormorant Garamond', Georgia, serif;
            --font-body: 'Crimson Pro', Georgia, serif;
            --font-mono: 'JetBrains Mono', monospace;
            --font-jp: 'Zen Kaku Gothic New', sans-serif;

            --ease-out-expo: cubic-bezier(0.19, 1, 0.22, 1);
            --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            scroll-behavior: smooth;
            background: var(--void);
        }

        body {
            font-family: var(--font-body);
            color: var(--text);
            font-size: 18px;
            line-height: 1.9;
            background: var(--void);
            min-height: 100vh;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--flow) 0%, var(--flow-deep) 100%);
            border-radius: 3px;
        }

        ::selection {
            background: rgba(0, 206, 201, 0.3);
            color: var(--text);
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            opacity: 0.02;
            pointer-events: none;
            z-index: 9999;
        }

        /* === NAVIGATION === */
        .nav-dots {
            position: fixed;
            right: 2rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 0.875rem;
            z-index: 100;
        }

        .nav-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--text-ghost);
            cursor: pointer;
            transition: all 0.4s var(--ease-out-expo);
            position: relative;
        }

        .nav-dot::before {
            content: '';
            position: absolute;
            inset: -6px;
            border-radius: 50%;
            border: 1px solid transparent;
            transition: all 0.4s var(--ease-out-expo);
        }

        .nav-dot:hover::before,
        .nav-dot.active::before {
            border-color: var(--flow);
            transform: scale(1.8);
            opacity: 0.5;
        }

        .nav-dot:hover, .nav-dot.active {
            background: var(--flow);
            transform: scale(1.5);
            box-shadow: 0 0 20px var(--flow-glow);
        }

        .nav-dot::after {
            content: attr(data-label);
            position: absolute;
            right: 1.75rem;
            top: 50%;
            transform: translateY(-50%) translateX(10px);
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--text-dim);
            white-space: nowrap;
            opacity: 0;
            transition: all 0.3s var(--ease-out-expo);
        }

        .nav-dot:hover::after {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
        }

        /* === HERO === */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero-canvas {
            position: absolute;
            inset: 0;
            z-index: 0;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .kanji-main {
            font-family: var(--font-jp);
            font-size: clamp(7rem, 22vw, 12rem);
            color: var(--flow);
            opacity: 0.9;
            font-weight: 300;
            text-shadow: 
                0 0 60px var(--flow-glow),
                0 0 120px var(--flow-whisper),
                0 2px 40px rgba(0,0,0,0.5);
            line-height: 1;
            animation: kanji-breathe 8s ease-in-out infinite;
            filter: drop-shadow(0 0 30px var(--flow-glow));
        }

        @keyframes kanji-breathe {
            0%, 100% { 
                opacity: 0.85; 
                transform: scale(1);
                filter: drop-shadow(0 0 30px var(--flow-glow));
            }
            50% { 
                opacity: 1; 
                transform: scale(1.02);
                filter: drop-shadow(0 0 50px var(--flow-glow));
            }
        }

        .english-main {
            font-family: var(--font-display);
            font-size: 1.2rem;
            letter-spacing: 0.8em;
            color: var(--text-whisper);
            text-transform: uppercase;
            margin-top: -0.5rem;
        }

        .haiku-container {
            position: relative;
            height: 120px;
            width: 300px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 3rem;
        }

        .haiku-english, .haiku-japanese {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 1s var(--ease-out-expo);
        }

        .haiku-english { opacity: 1; transform: translateY(0) scale(1); }
        .haiku-japanese {
            opacity: 0;
            transform: translateY(15px) scale(0.95);
            writing-mode: vertical-rl;
            flex-direction: row;
            gap: 1.25rem;
        }

        .haiku-container:hover .haiku-english {
            opacity: 0;
            transform: translateY(-15px) scale(1.05);
        }

        .haiku-container:hover .haiku-japanese {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .haiku-line {
            font-family: var(--font-display);
            font-size: 1rem;
            font-style: italic;
            color: var(--text-dim);
            margin: 0.1rem 0;
            transition: color 0.3s;
        }

        .haiku-container:hover .haiku-line {
            color: var(--text-whisper);
        }

        .haiku-jp {
            font-family: var(--font-jp);
            font-size: 1rem;
            letter-spacing: 0.35em;
            color: var(--gold);
            text-shadow: 0 0 30px var(--gold-glow);
        }

        .scroll-hint {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            letter-spacing: 0.3em;
            color: var(--text-ghost);
            text-transform: uppercase;
            animation: scroll-pulse 3s ease-in-out infinite;
            margin-top: 4rem;
        }

        @keyframes scroll-pulse {
            0%, 100% { opacity: 0.15; transform: translateY(0); }
            50% { opacity: 0.4; transform: translateY(5px); }
        }

        /* === SECTIONS === */
        section {
            min-height: 100vh;
            padding: 6rem 3rem;
            position: relative;
        }

        #signal { background: radial-gradient(ellipse at 30% 20%, rgba(0, 206, 201, 0.03) 0%, transparent 50%), var(--void); }
        #response { background: radial-gradient(ellipse at 70% 30%, rgba(0, 206, 201, 0.025) 0%, transparent 45%), var(--void); }
        #repair { background: radial-gradient(ellipse at 50% 20%, rgba(196, 163, 90, 0.025) 0%, transparent 50%), var(--void); }
        #merge { background: radial-gradient(ellipse at 40% 60%, rgba(74, 222, 128, 0.025) 0%, transparent 45%), var(--void); }
        #failure { background: radial-gradient(ellipse at 60% 40%, rgba(255, 107, 107, 0.025) 0%, transparent 45%), var(--void); }
        #escalation { background: radial-gradient(ellipse at 30% 70%, rgba(251, 191, 36, 0.02) 0%, transparent 40%), var(--void); }

        .section-container {
            max-width: 820px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-number {
            font-family: var(--font-mono);
            font-size: 0.65rem;
            color: var(--flow);
            letter-spacing: 0.4em;
            margin-bottom: 1.25rem;
            opacity: 0.8;
        }

        .section-title {
            font-family: var(--font-display);
            font-size: clamp(2.25rem, 5vw, 3.25rem);
            font-weight: 300;
            color: var(--text);
            margin-bottom: 0.75rem;
            letter-spacing: 0.02em;
        }

        .section-subtitle {
            font-family: var(--font-body);
            font-size: 1rem;
            font-style: italic;
            color: var(--text-whisper);
        }

        /* === CODE BLOCKS - BEAUTIFUL TERMINAL STYLE === */
        .code-block {
            position: relative;
            margin: 2.5rem 0;
            border-radius: 12px;
            overflow: hidden;
            background: var(--void-code);
            border: 1px solid rgba(255,255,255,0.06);
            box-shadow: 
                0 4px 6px rgba(0,0,0,0.3),
                0 10px 40px rgba(0,0,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.03);
            transition: all 0.4s var(--ease-out-expo);
        }

        .code-block:hover {
            border-color: rgba(0, 206, 201, 0.2);
            box-shadow: 
                0 4px 6px rgba(0,0,0,0.3),
                0 20px 60px rgba(0,0,0,0.5),
                0 0 40px var(--flow-whisper),
                inset 0 1px 0 rgba(255,255,255,0.05);
            transform: translateY(-2px);
        }

        .code-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: rgba(255,255,255,0.02);
            border-bottom: 1px solid rgba(255,255,255,0.04);
        }

        .code-dots {
            display: flex;
            gap: 6px;
        }

        .code-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .code-dot.red { background: #ff5f57; }
        .code-dot.yellow { background: #febc2e; }
        .code-dot.green { background: #28c840; }

        .code-block:hover .code-dot.red { box-shadow: 0 0 8px #ff5f57; }
        .code-block:hover .code-dot.yellow { box-shadow: 0 0 8px #febc2e; }
        .code-block:hover .code-dot.green { box-shadow: 0 0 8px #28c840; }

        .code-lang {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-whisper);
            padding: 0.25rem 0.75rem;
            background: rgba(255,255,255,0.03);
            border-radius: 4px;
        }

        .code-content {
            padding: 1.25rem 1.5rem;
            overflow-x: auto;
        }

        .code-content code {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            line-height: 1.8;
            color: var(--text-dim);
            display: block;
        }

        .code-line {
            display: flex;
            padding: 0 0.5rem;
            margin: 0 -0.5rem;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .code-line:hover {
            background: rgba(255,255,255,0.02);
        }

        .line-number {
            color: var(--text-ghost);
            min-width: 2rem;
            text-align: right;
            margin-right: 1.5rem;
            user-select: none;
            font-size: 0.7rem;
            opacity: 0.6;
        }

        .code-content .keyword { color: var(--flow); font-weight: 500; }
        .code-content .string { color: var(--gold); }
        .code-content .comment { color: rgba(244,241,234,0.35); font-style: italic; }
        .code-content .important { color: var(--danger); font-weight: 500; }
        .code-content .variable { color: var(--flow-bright); }
        .code-content .function { color: var(--purple); }

        /* === FLOW DIAGRAM === */
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 3rem 0;
            padding: 2rem;
        }

        .flow-node {
            background: linear-gradient(135deg, rgba(0, 206, 201, 0.08) 0%, rgba(0, 206, 201, 0.02) 100%);
            border: 1px solid rgba(0, 206, 201, 0.25);
            border-radius: 10px;
            padding: 0.875rem 1.25rem;
            font-family: var(--font-mono);
            font-size: 0.75rem;
            letter-spacing: 0.02em;
            color: var(--flow);
            cursor: default;
            transition: all 0.4s var(--ease-spring);
            position: relative;
            overflow: hidden;
        }

        .flow-node::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--flow) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .flow-node:hover {
            transform: translateY(-4px) scale(1.03);
            border-color: var(--flow);
            box-shadow: 
                0 8px 25px rgba(0, 206, 201, 0.2),
                0 0 0 1px rgba(0, 206, 201, 0.1);
        }

        .flow-node:hover::before { opacity: 0.05; }

        .flow-node.success {
            border-color: rgba(74, 222, 128, 0.3);
            color: var(--success);
            background: linear-gradient(135deg, var(--success-dim) 0%, transparent 100%);
        }

        .flow-node.danger {
            border-color: rgba(255, 107, 107, 0.3);
            color: var(--danger);
            background: linear-gradient(135deg, var(--danger-dim) 0%, transparent 100%);
        }

        .flow-arrow {
            font-size: 1.25rem;
            color: var(--text-ghost);
            animation: arrow-pulse 2s ease-in-out infinite;
        }

        @keyframes arrow-pulse {
            0%, 100% { opacity: 0.3; transform: translateX(0); }
            50% { opacity: 0.6; transform: translateX(3px); }
        }

        /* === BRANCH CARDS === */
        .branch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.25rem;
            margin: 2.5rem 0;
        }

        .branch-card {
            background: linear-gradient(145deg, rgba(13, 17, 23, 0.9) 0%, rgba(0, 206, 201, 0.03) 100%);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 14px;
            padding: 1.5rem;
            transition: all 0.5s var(--ease-spring);
            cursor: default;
            position: relative;
            overflow: hidden;
        }

        .branch-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--flow), transparent);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .branch-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 50% 0%, var(--flow-whisper) 0%, transparent 60%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .branch-card:hover {
            border-color: rgba(0, 206, 201, 0.3);
            transform: translateY(-8px);
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.4),
                0 0 30px var(--flow-whisper);
        }

        .branch-card:hover::before { opacity: 1; }
        .branch-card:hover::after { opacity: 1; }

        .branch-card h4 {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--flow);
            margin-bottom: 0.625rem;
            position: relative;
            z-index: 1;
        }

        .branch-card p {
            font-family: var(--font-body);
            font-size: 0.9rem;
            color: var(--text-dim);
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .branch-card p em {
            color: var(--gold);
            font-style: normal;
        }

        /* === ESCALATION LADDER === */
        .escalation-ladder {
            display: flex;
            flex-direction: column;
            gap: 0.625rem;
            margin: 2.5rem 0;
        }

        .escalation-level {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            background: linear-gradient(90deg, rgba(13, 17, 23, 0.8) 0%, transparent 100%);
            border-left: 2px solid var(--text-ghost);
            border-radius: 0 10px 10px 0;
            transition: all 0.4s var(--ease-spring);
            cursor: default;
        }

        .escalation-level:hover {
            transform: translateX(12px);
            background: linear-gradient(90deg, rgba(13, 17, 23, 0.95) 0%, rgba(13, 17, 23, 0.3) 100%);
        }

        .escalation-level.low { border-color: var(--text-dim); }
        .escalation-level.medium { border-color: var(--flow); }
        .escalation-level.high { border-color: var(--warning); }
        .escalation-level.critical { border-color: var(--danger); }

        .escalation-level:hover.low { box-shadow: -4px 0 20px rgba(244, 241, 234, 0.05); }
        .escalation-level:hover.medium { box-shadow: -4px 0 20px var(--flow-whisper); }
        .escalation-level:hover.high { box-shadow: -4px 0 20px var(--warning-dim); }
        .escalation-level:hover.critical { box-shadow: -4px 0 20px var(--danger-dim); }

        .escalation-icon {
            font-size: 1rem;
            width: 1.5rem;
            text-align: center;
        }

        .escalation-badge {
            font-family: var(--font-mono);
            font-size: 0.6rem;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 500;
        }

        .escalation-level.low .escalation-badge { background: rgba(244, 241, 234, 0.08); color: var(--text-dim); }
        .escalation-level.medium .escalation-badge { background: var(--flow-whisper); color: var(--flow); }
        .escalation-level.high .escalation-badge { background: var(--warning-dim); color: var(--warning); }
        .escalation-level.critical .escalation-badge { background: var(--danger-dim); color: var(--danger); }

        .escalation-text {
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--text-dim);
            flex: 1;
        }

        /* === QUOTE BLOCK === */
        .quote-block {
            text-align: center;
            padding: 3rem 2rem;
            margin: 3rem 0;
            position: relative;
        }

        .quote-block::before,
        .quote-block::after {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }

        .quote-block::before { top: 0; }
        .quote-block::after { bottom: 0; }

        .quote-mark {
            font-family: var(--font-display);
            font-size: 4rem;
            color: var(--gold);
            opacity: 0.15;
            line-height: 1;
            margin-bottom: -1.5rem;
        }

        .quote-text {
            font-family: var(--font-display);
            font-size: 1.4rem;
            font-style: italic;
            color: var(--gold);
            letter-spacing: 0.03em;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto;
        }

        /* === CLOSING === */
        .closing {
            text-align: center;
            padding: 8rem 2rem;
            background: radial-gradient(ellipse at 50% 50%, rgba(0, 206, 201, 0.03) 0%, transparent 50%), var(--void);
        }

        .split-circle {
            width: 100px;
            height: 100px;
            margin: 0 auto 2.5rem;
            position: relative;
            animation: circle-rotate 20s linear infinite;
        }

        @keyframes circle-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .split-circle svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 20px var(--flow-glow));
        }

        .closing-text {
            font-family: var(--font-body);
            font-size: 1.15rem;
            color: var(--text-dim);
            max-width: 480px;
            margin: 0 auto;
            line-height: 1.85;
        }

        .closing-constraint {
            font-family: var(--font-mono);
            font-size: 1.1rem;
            color: var(--flow);
            margin-top: 2.5rem;
            letter-spacing: 0.15em;
            text-shadow: 0 0 30px var(--flow-glow);
            animation: constraint-glow 3s ease-in-out infinite;
        }

        @keyframes constraint-glow {
            0%, 100% { text-shadow: 0 0 20px var(--flow-glow); }
            50% { text-shadow: 0 0 40px var(--flow-glow), 0 0 60px var(--flow-whisper); }
        }

        /* === PROSE === */
        .prose {
            font-family: var(--font-body);
            font-size: 1.05rem;
            line-height: 1.95;
            color: var(--text-dim);
            max-width: 640px;
            margin-left: auto;
            margin-right: auto;
        }

        .prose em {
            color: var(--gold);
            font-style: normal;
        }

        .prose strong {
            color: var(--flow);
            font-weight: 500;
        }

        .prose code {
            font-family: var(--font-mono);
            font-size: 0.85em;
            color: var(--flow-bright);
            background: rgba(0, 206, 201, 0.08);
            padding: 0.15em 0.5em;
            border-radius: 5px;
            border: 1px solid rgba(0, 206, 201, 0.15);
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .nav-dots { display: none; }
            section { padding: 4rem 1.5rem; }
            .code-content { padding: 1rem; }
            .code-content code { font-size: 0.7rem; }
            .branch-grid { gap: 1rem; }
            .flow-diagram { gap: 0.5rem; padding: 1rem; }
            .flow-node { padding: 0.625rem 1rem; font-size: 0.7rem; }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-dots">
        <div class="nav-dot active" data-target="hero" data-label="癒"></div>
        <div class="nav-dot" data-target="signal" data-label="Signal"></div>
        <div class="nav-dot" data-target="response" data-label="Response"></div>
        <div class="nav-dot" data-target="repair" data-label="Repair"></div>
        <div class="nav-dot" data-target="merge" data-label="Merge"></div>
        <div class="nav-dot" data-target="failure" data-label="Failure"></div>
        <div class="nav-dot" data-target="escalation" data-label="Escalation"></div>
        <div class="nav-dot" data-target="closing" data-label="h(x) ≥ 0"></div>
    </nav>

    <section class="hero" id="hero">
        <canvas class="hero-canvas" id="hero-canvas"></canvas>
        <div class="hero-content">
            <div class="kanji-main">癒</div>
            <div class="english-main">Heal</div>
            <div class="haiku-container">
                <div class="haiku-english">
                    <div class="haiku-line">Failure speaks softly</div>
                    <div class="haiku-line">The mirror perceives, responds</div>
                    <div class="haiku-line">Mended before dawn</div>
                </div>
                <div class="haiku-japanese">
                    <div class="haiku-jp">失敗は囁く</div>
                    <div class="haiku-jp">鏡は知り応える</div>
                    <div class="haiku-jp">夜明け前に癒す</div>
                </div>
            </div>
            <div class="scroll-hint">scroll to enter</div>
        </div>
    </section>

    <section id="signal">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">01 / THE SIGNAL</div>
                <h2 class="section-title">Detection</h2>
                <p class="section-subtitle">When CI fails, the healing begins</p>
            </div>

            <p class="prose">
                The continuous integration pipeline is the <em>heartbeat</em> of the codebase.
                Every push, every pull request triggers a cascade of tests, lints, and validations.
                When something breaks, <strong>the system notices instantly</strong>.
            </p>

            <div class="flow-diagram">
                <div class="flow-node">ci.yml completes</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node danger">failure detected</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">workflow_run triggers</div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <span class="code-dot red"></span>
                        <span class="code-dot yellow"></span>
                        <span class="code-dot green"></span>
                    </div>
                    <span class="code-lang">yaml</span>
                </div>
                <div class="code-content">
                    <code><div class="code-line"><span class="line-number">1</span><span class="keyword">on</span>:</div><div class="code-line"><span class="line-number">2</span>  <span class="keyword">workflow_run</span>:</div><div class="code-line"><span class="line-number">3</span>    <span class="keyword">workflows</span>: [<span class="string">"ci"</span>]</div><div class="code-line"><span class="line-number">4</span>    <span class="keyword">types</span>: [completed]</div><div class="code-line"><span class="line-number">5</span></div><div class="code-line"><span class="line-number">6</span><span class="comment"># The signal propagates to four parallel responders</span></div><div class="code-line"><span class="line-number">7</span><span class="comment"># Each with a specialized role in the healing process</span></div></code>
                </div>
            </div>

            <p class="prose">
                The <code>workflow_run</code> event is the <em>nervous signal</em> that initiates healing.
                It fires when CI completes—success or failure—allowing downstream workflows to respond
                with full context about what happened.
            </p>
        </div>
    </section>

    <section id="response">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">02 / THE RESPONSE</div>
                <h2 class="section-title">Parallel Processing</h2>
                <p class="section-subtitle">Four workflows respond to a single signal</p>
            </div>

            <p class="prose">
                Like the body's immune response, multiple systems activate simultaneously.
                Each workflow has a <em>singular responsibility</em>, and together they
                orchestrate the repair.
            </p>

            <div class="branch-grid">
                <div class="branch-card">
                    <h4>cursor-fix-trigger.yml</h4>
                    <p>The <em>single source of truth</em> for issue creation. Creates GitHub issues and fix branches.</p>
                </div>
                <div class="branch-card">
                    <h4>self-healing-ci.yml</h4>
                    <p>Analyzes failure logs with AI, generates fix suggestions, creates draft PRs.</p>
                </div>
                <div class="branch-card">
                    <h4>auto-solver.yml</h4>
                    <p>Handles notifications—Slack alerts, Notion logging. The messenger.</p>
                </div>
                <div class="branch-card">
                    <h4>ci-failure-escalation.yml</h4>
                    <p>Routes failures by severity. Adds labels, escalates to humans when needed.</p>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <span class="code-dot red"></span>
                        <span class="code-dot yellow"></span>
                        <span class="code-dot green"></span>
                    </div>
                    <span class="code-lang">yaml</span>
                </div>
                <div class="code-content">
                    <code><div class="code-line"><span class="line-number">1</span><span class="comment"># SINGLE SOURCE OF TRUTH for CI failure → Issue creation</span></div><div class="code-line"><span class="line-number">2</span><span class="comment"># Other workflows delegate to cursor-fix-trigger.yml</span></div><div class="code-line"><span class="line-number">3</span></div><div class="code-line"><span class="line-number">4</span><span class="keyword">concurrency</span>:</div><div class="code-line"><span class="line-number">5</span>  <span class="keyword">group</span>: <span class="variable">cursor-fix-${{ github.event.workflow_run.id }}</span></div><div class="code-line"><span class="line-number">6</span>  <span class="keyword">cancel-in-progress</span>: <span class="important">false</span>  <span class="comment"># Never cancel</span></div></code>
                </div>
            </div>

            <p class="prose">
                <strong>Deduplication</strong> is critical. Without it, four workflows racing to create
                issues would spawn duplicates. The solution: <em>one workflow owns issue creation</em>,
                others delegate or enhance.
            </p>
        </div>
    </section>

    <section id="repair">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">03 / THE REPAIR</div>
                <h2 class="section-title">Fix Generation</h2>
                <p class="section-subtitle">From issue to pull request</p>
            </div>

            <div class="flow-diagram">
                <div class="flow-node">Issue Created</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Fix Branch</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Cursor Fixes</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node success">PR Ready</div>
            </div>

            <p class="prose">
                When an issue is created with the <code>cursor-agent</code> label, Cursor's
                Background Agent activates. It reads the failure context, analyzes the logs,
                and commits a fix to the branch named <code>cursor/ci-fix-{runId}</code>.
            </p>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <span class="code-dot red"></span>
                        <span class="code-dot yellow"></span>
                        <span class="code-dot green"></span>
                    </div>
                    <span class="code-lang">bash</span>
                </div>
                <div class="code-content">
                    <code><div class="code-line"><span class="line-number">1</span><span class="comment"># Branch naming links fix to original failure</span></div><div class="code-line"><span class="line-number">2</span><span class="variable">cursor/ci-fix-</span><span class="string">12345678901</span></div><div class="code-line"><span class="line-number">3</span></div><div class="code-line"><span class="line-number">4</span><span class="comment"># This naming is critical for:</span></div><div class="code-line"><span class="line-number">5</span><span class="comment"># 1. Tracing fixes to their source failure</span></div><div class="code-line"><span class="line-number">6</span><span class="comment"># 2. Detecting when a fix branch fails</span></div><div class="code-line"><span class="line-number">7</span><span class="comment"># 3. Automatic PR association</span></div></code>
                </div>
            </div>

            <div class="quote-block">
                <div class="quote-mark">"</div>
                <div class="quote-text">The branch name is the thread connecting failure to healing</div>
            </div>
        </div>
    </section>

    <section id="merge">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">04 / THE MERGE</div>
                <h2 class="section-title">Automatic Integration</h2>
                <p class="section-subtitle">When healing succeeds, the fix flows home</p>
            </div>

            <div class="flow-diagram">
                <div class="flow-node success">CI Passes</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Auto-Approve</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Auto-Merge</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node success">Issue Closed</div>
            </div>

            <p class="prose">
                The <code>auto-merge-fixes.yml</code> workflow watches for CI completion on
                fix branches. When <em>all checks pass</em>, it approves the PR, merges it,
                and closes the original issue. The loop completes.
            </p>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <span class="code-dot red"></span>
                        <span class="code-dot yellow"></span>
                        <span class="code-dot green"></span>
                    </div>
                    <span class="code-lang">yaml</span>
                </div>
                <div class="code-content">
                    <code><div class="code-line"><span class="line-number">1</span><span class="comment"># Only proceed if CI passed</span></div><div class="code-line"><span class="line-number">2</span><span class="keyword">if</span>: |</div><div class="code-line"><span class="line-number">3</span>  <span class="variable">github.event_name</span> != <span class="string">'workflow_run'</span> ||</div><div class="code-line"><span class="line-number">4</span>  <span class="variable">github.event.workflow_run.conclusion</span> == <span class="string">'success'</span></div><div class="code-line"><span class="line-number">5</span></div><div class="code-line"><span class="line-number">6</span><span class="comment"># Eligibility: auto-fix branch, checks passed, mergeable</span></div></code>
                </div>
            </div>

            <p class="prose">
                The merge is a <strong>squash merge</strong>—collapsing the fix into a single commit
                with a clear message. The fix branch is deleted. Clean. Traceable. <em>Healed</em>.
            </p>
        </div>
    </section>

    <section id="failure">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">05 / THE FAILURE PATH</div>
                <h2 class="section-title">When Healing Fails</h2>
                <p class="section-subtitle">Breaking the infinite loop</p>
            </div>

            <p class="prose">
                What happens when a fix branch <em>itself</em> fails CI? Without careful design,
                this creates an infinite loop: failure → issue → fix branch → failure → ...
            </p>

            <div class="code-block">
                <div class="code-header">
                    <div class="code-dots">
                        <span class="code-dot red"></span>
                        <span class="code-dot yellow"></span>
                        <span class="code-dot green"></span>
                    </div>
                    <span class="code-lang">bash</span>
                </div>
                <div class="code-content">
                    <code><div class="code-line"><span class="line-number">1</span><span class="comment"># CRITICAL: Detect fix branch failures</span></div><div class="code-line"><span class="line-number">2</span><span class="variable">HEAD_BRANCH</span>=<span class="string">"$HEAD_BRANCH"</span></div><div class="code-line"><span class="line-number">3</span></div><div class="code-line"><span class="line-number">4</span><span class="keyword">if</span> [[ <span class="string">"$HEAD_BRANCH"</span> =~ ^cursor/ci-fix- ]]; <span class="keyword">then</span></div><div class="code-line"><span class="line-number">5</span>  <span class="comment"># NO new issue - prevents infinite loops</span></div><div class="code-line"><span class="line-number">6</span>  <span class="comment"># Route to handle_fix_branch_failure</span></div><div class="code-line"><span class="line-number">7</span><span class="keyword">fi</span></div></code>
                </div>
            </div>

            <div class="flow-diagram">
                <div class="flow-node danger">Fix Branch Fails</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Find Original</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Add Label</div>
                <div class="flow-arrow">→</div>
                <div class="flow-node">Reopen Issue</div>
            </div>

            <p class="prose">
                When a fix fails, the system doesn't create a new issue. Instead, it finds the
                <em>original</em> issue, adds a <code>fix-failed</code> label, reopens it if closed,
                and comments with details. <strong>Manual intervention requested.</strong>
            </p>

            <div class="quote-block">
                <div class="quote-mark">"</div>
                <div class="quote-text">Some wounds require a human touch</div>
            </div>
        </div>
    </section>

    <section id="escalation">
        <div class="section-container">
            <div class="section-header">
                <div class="section-number">06 / THE ESCALATION</div>
                <h2 class="section-title">Severity Ladder</h2>
                <p class="section-subtitle">From whisper to alarm</p>
            </div>

            <p class="prose">
                Not all failures are equal. A flaky test differs from a security vulnerability.
                The escalation system routes failures based on <em>severity</em> and
                <em>consecutive failure count</em>.
            </p>

            <div class="escalation-ladder">
                <div class="escalation-level low">
                    <span class="escalation-icon">○</span>
                    <span class="escalation-badge">Low</span>
                    <span class="escalation-text">Log only. First-time, non-critical failures.</span>
                </div>
                <div class="escalation-level medium">
                    <span class="escalation-icon">◐</span>
                    <span class="escalation-badge">Medium</span>
                    <span class="escalation-text">Slack notification. Repeated failures.</span>
                </div>
                <div class="escalation-level high">
                    <span class="escalation-icon">◕</span>
                    <span class="escalation-badge">High</span>
                    <span class="escalation-text">Slack + labels. Security concerns.</span>
                </div>
                <div class="escalation-level critical">
                    <span class="escalation-icon">●</span>
                    <span class="escalation-badge">Critical</span>
                    <span class="escalation-text">PagerDuty. Production impact.</span>
                </div>
            </div>

            <p class="prose">
                The escalation workflow <em>never creates duplicate issues</em>. It finds the
                existing issue and enhances it with labels and comments appropriate to the severity.
            </p>
        </div>
    </section>

    <section class="closing" id="closing">
        <div class="split-circle">
            <svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="none" stroke="var(--flow)" stroke-width="1" opacity="0.2"/>
                <path d="M50 5 A45 45 0 0 1 50 95" fill="none" stroke="var(--flow)" stroke-width="2"/>
                <path d="M50 5 A45 45 0 0 0 50 95" fill="none" stroke="var(--gold)" stroke-width="2"/>
                <circle cx="50" cy="50" r="4" fill="var(--flow)"/>
            </svg>
        </div>

        <h2 class="section-title" style="margin-bottom: 2rem;">The Complete Cycle</h2>

        <p class="closing-text">
            Failure is not the opposite of success—it is the signal that guides improvement.
            The self-healing system watches, responds, repairs, and learns.
            When it cannot heal alone, it asks for help.
        </p>

        <div class="closing-constraint">h(x) ≥ 0. Always.</div>

        <canvas id="closing-canvas" width="800" height="180" style="margin-top: 3rem; max-width: 100%;"></canvas>
    </section>

    <script>
        // Navigation
        const navDots = document.querySelectorAll('.nav-dot');
        const sections = document.querySelectorAll('section');

        navDots.forEach(dot => {
            dot.addEventListener('click', () => {
                const target = document.getElementById(dot.dataset.target);
                if (target) target.scrollIntoView({ behavior: 'smooth' });
            });
        });

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navDots.forEach(dot => {
                        dot.classList.toggle('active', dot.dataset.target === entry.target.id);
                    });
                }
            });
        }, { rootMargin: '-50% 0px', threshold: 0 });

        sections.forEach(section => observer.observe(section));

        // Hero Canvas
        const heroCanvas = document.getElementById('hero-canvas');
        const heroCtx = heroCanvas.getContext('2d');
        let heroTime = 0;

        function resizeHeroCanvas() {
            heroCanvas.width = window.innerWidth;
            heroCanvas.height = window.innerHeight;
        }
        resizeHeroCanvas();
        window.addEventListener('resize', resizeHeroCanvas);

        class HealingParticle {
            constructor() { this.reset(); }

            reset() {
                this.x = Math.random() * heroCanvas.width;
                this.y = Math.random() * heroCanvas.height;
                this.size = Math.random() * 1.5 + 0.5;
                this.speedX = (Math.random() - 0.5) * 0.25;
                this.speedY = (Math.random() - 0.5) * 0.25;
                this.opacity = Math.random() * 0.4 + 0.1;
                this.hue = Math.random() > 0.8 ? 48 : 176;
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.x < 0 || this.x > heroCanvas.width) this.speedX *= -1;
                if (this.y < 0 || this.y > heroCanvas.height) this.speedY *= -1;
            }

            draw(time) {
                const centerX = heroCanvas.width / 2;
                const centerY = heroCanvas.height / 2;
                const centerDist = Math.hypot(this.x - centerX, this.y - centerY);
                const pulse = 1 + 0.2 * Math.sin(time * 0.0015 + centerDist * 0.003);

                heroCtx.beginPath();
                heroCtx.arc(this.x, this.y, this.size * pulse, 0, Math.PI * 2);
                heroCtx.fillStyle = `hsla(${this.hue}, 70%, 60%, ${this.opacity})`;
                heroCtx.fill();
            }
        }

        const particles = Array.from({ length: 120 }, () => new HealingParticle());

        function drawConnections() {
            const connectionDistance = 100;
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < connectionDistance) {
                        const opacity = (1 - distance / connectionDistance) * 0.08;
                        heroCtx.beginPath();
                        heroCtx.moveTo(particles[i].x, particles[i].y);
                        heroCtx.lineTo(particles[j].x, particles[j].y);
                        heroCtx.strokeStyle = `rgba(0, 206, 201, ${opacity})`;
                        heroCtx.lineWidth = 1;
                        heroCtx.stroke();
                    }
                }
            }
        }

        function animateHero(timestamp) {
            heroTime = timestamp;
            heroCtx.fillStyle = 'rgba(2, 2, 4, 0.08)';
            heroCtx.fillRect(0, 0, heroCanvas.width, heroCanvas.height);

            drawConnections();
            particles.forEach(p => { p.update(); p.draw(heroTime); });

            requestAnimationFrame(animateHero);
        }

        requestAnimationFrame(animateHero);

        // Closing Canvas
        const closingCanvas = document.getElementById('closing-canvas');
        const closingCtx = closingCanvas.getContext('2d');

        const states = [
            { name: 'CI', x: 70, color: '#00cec9' },
            { name: 'Fail', x: 190, color: '#ff6b6b' },
            { name: 'Issue', x: 310, color: '#c4a35a' },
            { name: 'Fix', x: 430, color: '#00cec9' },
            { name: 'PR', x: 550, color: '#4ade80' },
            { name: 'Merge', x: 670, color: '#4ade80' }
        ];

        let activeState = 0;
        let pulsePhase = 0;

        function drawStateMachine() {
            closingCtx.clearRect(0, 0, closingCanvas.width, closingCanvas.height);

            // Connections
            closingCtx.strokeStyle = 'rgba(244, 241, 234, 0.12)';
            closingCtx.lineWidth = 1.5;
            for (let i = 0; i < states.length - 1; i++) {
                closingCtx.beginPath();
                closingCtx.moveTo(states[i].x + 28, 90);
                closingCtx.lineTo(states[i + 1].x - 28, 90);
                closingCtx.stroke();
            }

            // Loop back
            closingCtx.beginPath();
            closingCtx.moveTo(states[5].x, 65);
            closingCtx.quadraticCurveTo(380, 15, states[0].x, 65);
            closingCtx.stroke();

            // States
            states.forEach((state, i) => {
                const isActive = i === activeState;
                const pulse = isActive ? Math.sin(pulsePhase) * 6 : 0;
                const radius = 24 + pulse;

                if (isActive) {
                    closingCtx.beginPath();
                    closingCtx.arc(state.x, 90, radius + 15, 0, Math.PI * 2);
                    closingCtx.fillStyle = `${state.color}25`;
                    closingCtx.fill();
                }

                closingCtx.beginPath();
                closingCtx.arc(state.x, 90, radius, 0, Math.PI * 2);
                closingCtx.fillStyle = isActive ? state.color : '#0a0a0f';
                closingCtx.strokeStyle = state.color;
                closingCtx.lineWidth = 1.5;
                closingCtx.fill();
                closingCtx.stroke();

                closingCtx.fillStyle = isActive ? '#020204' : state.color;
                closingCtx.font = '10px "JetBrains Mono", monospace';
                closingCtx.textAlign = 'center';
                closingCtx.textBaseline = 'middle';
                closingCtx.fillText(state.name, state.x, 90);
            });

            pulsePhase += 0.05;
            requestAnimationFrame(drawStateMachine);
        }

        setInterval(() => { activeState = (activeState + 1) % states.length; }, 2000);
        drawStateMachine();

        // Scroll reveals
        const revealContainers = document.querySelectorAll('.section-container');
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const children = entry.target.children;
                    Array.from(children).forEach((child, i) => {
                        child.style.transitionDelay = `${i * 0.08}s`;
                        child.style.opacity = '1';
                        child.style.transform = 'translateY(0)';
                    });
                }
            });
        }, { threshold: 0.1 });

        revealContainers.forEach(container => {
            const children = container.children;
            Array.from(children).forEach(child => {
                child.style.opacity = '0';
                child.style.transform = 'translateY(25px)';
                child.style.transition = 'opacity 0.8s cubic-bezier(0.19, 1, 0.22, 1), transform 0.8s cubic-bezier(0.19, 1, 0.22, 1)';
            });
            revealObserver.observe(container);
        });
    </script>
</body>
</html>
