(kicad_sch
  (version 20231120)
  (generator "kagami")
  (generator_version "8.0")
  (uuid "c0000000-0000-0000-0000-000000000003")
  (paper "A3")
  (title_block
    (title "CM4 Interface")
    (date "2026-01-11")
    (rev "1.0")
    (company "Kagami")
    (comment 1 "Sheet 3 of 7")
    (comment 2 "Raspberry Pi CM4 Module Connector")
  )

  ;; CM4 Connector A (J10)
  (symbol
    (lib_id "kagami_orb:DF40HC-100DS")
    (at 101.6 101.6 0)
    (unit 1)
    (exclude_from_sim no)
    (in_bom yes)
    (on_board yes)
    (dnp no)
    (uuid "11000000-0000-0000-0000-000000000001")
    (property "Reference" "J10"
      (at 101.6 50.8 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Value" "DF40HC(3.0)-100DS-0.4V"
      (at 101.6 53.34 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "Connector_Hirose:Hirose_DF40C-100DP-0.4V"
      (at 101.6 152.4 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "https://www.hirose.com/product/p/CL0684-0033-8-00"
      (at 101.6 154.94 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Description" "CM4 Module Connector A (100-pin)"
      (at 101.6 157.48 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  ;; CM4 Connector B (J11)
  (symbol
    (lib_id "kagami_orb:DF40HC-100DS")
    (at 203.2 101.6 0)
    (unit 1)
    (exclude_from_sim no)
    (in_bom yes)
    (on_board yes)
    (dnp no)
    (uuid "11000000-0000-0000-0000-000000000002")
    (property "Reference" "J11"
      (at 203.2 50.8 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Value" "DF40HC(3.0)-100DS-0.4V"
      (at 203.2 53.34 0)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "Connector_Hirose:Hirose_DF40C-100DP-0.4V"
      (at 203.2 152.4 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  ;; Boot config resistors
  (symbol
    (lib_id "Device:R")
    (at 279.4 76.2 0)
    (unit 1)
    (exclude_from_sim no)
    (in_bom yes)
    (on_board yes)
    (dnp no)
    (uuid "11000000-0000-0000-0000-000000000003")
    (property "Reference" "R1"
      (at 281.94 73.66 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Value" "10k"
      (at 281.94 76.2 0)
      (effects (font (size 1.27 1.27)) (justify left))
    )
    (property "Footprint" "Resistor_SMD:R_0402_1005Metric"
      (at 279.4 88.9 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Description" "nRPIBOOT pullup to 3V3"
      (at 279.4 91.44 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  ;; Power inputs
  (global_label "5V_SYS"
    (shape input)
    (at 63.5 63.5 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid "21000000-0000-0000-0000-000000000001")
  )
  (global_label "3V3"
    (shape input)
    (at 63.5 68.58 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid "21000000-0000-0000-0000-000000000002")
  )
  (global_label "1V8"
    (shape input)
    (at 63.5 73.66 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid "21000000-0000-0000-0000-000000000003")
  )

  ;; GPIO outputs
  (global_label "USB_DP"
    (shape output)
    (at 139.7 83.82 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000004")
  )
  (global_label "USB_DM"
    (shape output)
    (at 139.7 86.36 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000005")
  )
  (global_label "I2S_BCLK"
    (shape output)
    (at 139.7 93.98 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000006")
  )
  (global_label "I2S_LRCK"
    (shape output)
    (at 139.7 96.52 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000007")
  )
  (global_label "I2S_DIN"
    (shape input)
    (at 139.7 99.06 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000008")
  )
  (global_label "I2S_DOUT"
    (shape output)
    (at 139.7 101.6 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000009")
  )
  (global_label "I2C_SDA"
    (shape bidirectional)
    (at 139.7 109.22 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000010")
  )
  (global_label "I2C_SCL"
    (shape output)
    (at 139.7 111.76 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000011")
  )
  (global_label "GPIO18_LED"
    (shape output)
    (at 139.7 119.38 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000012")
  )
  (global_label "GPIO17_CHG"
    (shape input)
    (at 241.3 83.82 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000013")
  )
  (global_label "GPIO22_HALL"
    (shape input)
    (at 241.3 86.36 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000014")
  )
  (global_label "GPIO23_TEMP"
    (shape input)
    (at 241.3 88.9 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000015")
  )
  (global_label "GPIO24_VAD"
    (shape input)
    (at 241.3 91.44 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000016")
  )
  (global_label "GPIO27_BAT"
    (shape input)
    (at 241.3 93.98 0)
    (effects (font (size 1.27 1.27)) (justify left))
    (uuid "21000000-0000-0000-0000-000000000017")
  )

  ;; Section labels
  (text "CM4 MODULE CONNECTOR PINOUT"
    (exclude_from_sim no)
    (at 152.4 38.1 0)
    (effects (font (size 3.81 3.81) (bold yes)))
    (uuid "41000000-0000-0000-0000-000000000001")
  )
  (text "POWER PINS:\n  VBAT (5V) ← VSYS\n  VDD_CORE (1.8V) ← 1V8 rail\n  VDD_IO (3.3V) ← 3V3 rail"
    (exclude_from_sim no)
    (at 50.8 160.02 0)
    (effects (font (size 2.032 2.032)))
    (uuid "41000000-0000-0000-0000-000000000002")
  )
  (text "USB 2.0 HOST:\n  USB_DP → USB Hub\n  USB_DM → USB Hub"
    (exclude_from_sim no)
    (at 139.7 160.02 0)
    (effects (font (size 2.032 2.032)))
    (uuid "41000000-0000-0000-0000-000000000003")
  )
  (text "GPIO STATUS:\n  GPIO17 ← Resonant charging\n  GPIO22 ← Hall sensor (dock)\n  GPIO23 ← Temperature alert\n  GPIO24 ← ReSpeaker VAD\n  GPIO27 ← Battery alert"
    (exclude_from_sim no)
    (at 228.6 160.02 0)
    (effects (font (size 2.032 2.032)))
    (uuid "41000000-0000-0000-0000-000000000004")
  )

  (sheet_instances
    (path "/a0000000-0000-0000-0000-000000000001/a2000000-0000-0000-0000-000000000003"
      (page "3")
    )
  )
)
