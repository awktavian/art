<!DOCTYPE html>
<html lang="en" data-é¡="memo" data-ç« ="constraint" data-craft="transcendent">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡ MEMO â€” Working Within Constraint</title>
    <meta name="description" content="36 engineering-weeks in 5.5 days. A family memo on constraints, tools, and getting things done.">
    <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   é¡ KAGAMI FAMILY MEMO â€” TRANSCENDENT CRAFT
   
   "When you can't do everything, you learn what actually matters."
   
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   
   CAPABILITIES DEMONSTRATED:
   â”œâ”€â”€ Canvas: Colony constellation, particle physics, mouse trails
   â”œâ”€â”€ Audio: Web Audio API ambient tones, interaction sounds  
   â”œâ”€â”€ Physics: Gravity, magnetic attraction, spring dynamics
   â”œâ”€â”€ Secrets: Konami code, typed sequences, click combos
   â”œâ”€â”€ Mobile: Gyroscope parallax, shake detection, touch trails
   â”œâ”€â”€ State: localStorage persistence, visit counting
   â”œâ”€â”€ Animation: FLIP, spring physics, staggered reveals
   â””â”€â”€ Console: Full API, ASCII art, philosophical messages
   
   For:
   â”œâ”€â”€ Robert â€” The Builder (36 eng-weeks â†’ 5.5 days)
   â”œâ”€â”€ Katie â€” The Reader (constraint as creative force)
   â”œâ”€â”€ Kristi â€” The Orrery (systems within systems)
   â””â”€â”€ Becky â€” The Kitchen (227 commits, 197K lines, 81K net)
   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
    --flow: #00FFCC;
    --forge: #FFAA00;
    --spark: #FF4422;
    --crystal: #44DDFF;
    --nexus: #BB44FF;
    --grove: #22FF66;
    --beacon: #FFDD00;
    --void: #050508;
    --text: rgba(255,255,255,0.85);
    --text-dim: rgba(255,255,255,0.5);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }

body {
    min-height: 100vh;
    background: var(--void);
    font-family: system-ui, -apple-system, sans-serif;
    color: var(--text);
    line-height: 1.7;
    overflow-x: hidden;
    cursor: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADING SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#loading {
    position: fixed;
    inset: 0;
    background: var(--void);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 100000;
    transition: opacity 0.8s ease, visibility 0.8s;
}

#loading.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.loading-kanji {
    font-size: 6rem;
    color: var(--flow);
    animation: loadingPulse 1.5s ease-in-out infinite;
    font-family: serif;
}

@keyframes loadingPulse {
    0%, 100% { opacity: 0.3; transform: scale(0.95); }
    50% { opacity: 1; transform: scale(1.05); }
}

.loading-text {
    margin-top: 2rem;
    font-size: 0.8rem;
    letter-spacing: 0.3em;
    color: var(--text-dim);
    text-transform: uppercase;
}

.loading-bar {
    width: 200px;
    height: 2px;
    background: rgba(255,255,255,0.1);
    margin-top: 1rem;
    border-radius: 1px;
    overflow: hidden;
}

.loading-progress {
    height: 100%;
    background: linear-gradient(90deg, var(--flow), var(--crystal));
    width: 0%;
    transition: width 0.3s ease;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS LAYERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#constellation-canvas,
#particle-canvas,
#trail-canvas {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

#constellation-canvas { z-index: 0; opacity: 0.6; }
#particle-canvas { z-index: 1; }
#trail-canvas { z-index: 2; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BREATHING BACKGROUND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.bg-layer {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
}

.bg-layer-1 {
    background: radial-gradient(ellipse at 30% 20%, rgba(0,255,204,0.04) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(255,170,0,0.04) 0%, transparent 50%);
    animation: drift1 20s ease-in-out infinite;
}

.bg-layer-2 {
    background: radial-gradient(ellipse at 80% 30%, rgba(187,68,255,0.03) 0%, transparent 40%),
                radial-gradient(ellipse at 20% 70%, rgba(68,221,255,0.03) 0%, transparent 40%);
    animation: drift2 25s ease-in-out infinite;
}

@keyframes drift1 {
    0%, 100% { transform: translate(0, 0) scale(1); }
    50% { transform: translate(2%, 3%) scale(1.1); }
}

@keyframes drift2 {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    50% { transform: translate(-2%, -2%) rotate(2deg); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CUSTOM CURSOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#cursor {
    position: fixed;
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    pointer-events: none;
    z-index: 10000;
    transform: translate(-50%, -50%);
    mix-blend-mode: difference;
    transition: width 0.2s, height 0.2s, background 0.2s;
}

#cursor.hovering {
    width: 12px;
    height: 12px;
    background: var(--flow);
}

#cursor.clicking {
    width: 6px;
    height: 6px;
}

#cursor-ring {
    position: fixed;
    width: 40px;
    height: 40px;
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    pointer-events: none;
    z-index: 9999;
    transform: translate(-50%, -50%);
    transition: width 0.3s, height 0.3s, border-color 0.3s;
}

#cursor-ring.hovering {
    width: 60px;
    height: 60px;
    border-color: var(--flow);
}

#cursor-ring.magnetic {
    width: 80px;
    height: 80px;
    border-color: var(--nexus);
}

@media (max-width: 768px) {
    body { cursor: auto; }
    #cursor, #cursor-ring { display: none; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTAINER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.container {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    z-index: 10;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.memo-header {
    text-align: center;
    padding: 6rem 0 4rem;
    position: relative;
}

.kanji-container {
    position: relative;
    display: inline-block;
    margin-bottom: 2rem;
}

.kanji {
    font-size: clamp(5rem, 20vw, 10rem);
    font-family: serif;
    color: rgba(255,255,255,0.03);
    user-select: none;
    transition: all 0.5s ease;
    cursor: pointer;
}

.kanji:hover {
    color: rgba(0,255,204,0.1);
    text-shadow: 0 0 100px var(--flow);
}

.kanji-reflection {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) scaleY(-1);
    font-size: clamp(5rem, 20vw, 10rem);
    font-family: serif;
    color: rgba(255,255,255,0.01);
    mask-image: linear-gradient(to top, transparent 20%, white 100%);
    -webkit-mask-image: linear-gradient(to top, transparent 20%, white 100%);
    pointer-events: none;
}

.memo-title {
    font-size: clamp(1rem, 3vw, 1.5rem);
    font-weight: 300;
    letter-spacing: 0.5em;
    color: var(--text);
    margin-bottom: 1rem;
    opacity: 0;
    animation: fadeInUp 1s ease forwards 0.5s;
}

.memo-subtitle {
    font-size: 0.75rem;
    letter-spacing: 0.3em;
    color: var(--text-dim);
    text-transform: uppercase;
    opacity: 0;
    animation: fadeInUp 1s ease forwards 0.7s;
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MEGA STATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.mega-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1.5rem;
    margin: 4rem 0;
    perspective: 1000px;
}

.mega-stat {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 16px;
    padding: 2rem 1.5rem;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    transform-style: preserve-3d;
}

.mega-stat::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at var(--mx, 50%) var(--my, 50%), 
                rgba(0,255,204,0.15) 0%, transparent 50%);
    opacity: 0;
    transition: opacity 0.3s;
}

.mega-stat:hover {
    transform: translateY(-8px) rotateX(5deg);
    border-color: rgba(0,255,204,0.3);
    box-shadow: 0 20px 60px rgba(0,255,204,0.15);
}

.mega-stat:hover::before {
    opacity: 1;
}

.stat-number {
    font-size: 3rem;
    font-weight: 200;
    background: linear-gradient(135deg, var(--flow), var(--crystal));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    line-height: 1;
    position: relative;
    z-index: 1;
}

.stat-label {
    font-size: 0.65rem;
    letter-spacing: 0.2em;
    color: var(--text-dim);
    text-transform: uppercase;
    margin-top: 0.75rem;
    position: relative;
    z-index: 1;
}

.stat-context {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.3);
    margin-top: 0.5rem;
    font-style: italic;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

section {
    margin-bottom: 5rem;
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 1s ease, transform 1s ease;
}

section.visible {
    opacity: 1;
    transform: translateY(0);
}

h2 {
    font-size: 0.7rem;
    font-weight: 500;
    letter-spacing: 0.3em;
    color: var(--text-dim);
    text-transform: uppercase;
    margin-bottom: 2rem;
    display: flex;
    align-items: center;
    gap: 1rem;
}

h2::before {
    content: '';
    width: 40px;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3));
}

h2::after {
    content: '';
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, rgba(255,255,255,0.1), transparent);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STORY TEXT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.story {
    font-size: 1.05rem;
    line-height: 2;
    color: rgba(255,255,255,0.7);
}

.story p {
    margin-bottom: 1.75rem;
}

.story strong {
    color: var(--flow);
    font-weight: 500;
}

.highlight {
    color: var(--forge);
    position: relative;
}

.highlight::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 1px;
    background: currentColor;
    opacity: 0.4;
    transform: scaleX(0);
    transition: transform 0.3s ease;
}

.highlight:hover::after {
    transform: scaleX(1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FAMILY CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.family-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
}

.family-card {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 20px;
    padding: 2rem;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    cursor: pointer;
}

.family-card::before {
    content: '';
    position: absolute;
    inset: -50%;
    background: conic-gradient(from 0deg, transparent, var(--card-color, var(--flow)), transparent);
    animation: rotate 8s linear infinite paused;
    opacity: 0;
}

.family-card:hover::before {
    animation-play-state: running;
    opacity: 0.1;
}

@keyframes rotate {
    to { transform: rotate(360deg); }
}

.family-card:hover {
    transform: translateY(-8px) scale(1.02);
    border-color: var(--card-color, var(--flow));
    box-shadow: 0 20px 60px rgba(0,255,204,0.1);
}

.family-card[data-person="robert"] { --card-color: var(--forge); }
.family-card[data-person="katie"] { --card-color: var(--grove); }
.family-card[data-person="kristi"] { --card-color: var(--crystal); }
.family-card[data-person="becky"] { --card-color: var(--spark); }

.family-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    filter: grayscale(0.3);
    transition: filter 0.3s, transform 0.3s;
}

.family-card:hover .family-icon {
    filter: grayscale(0);
    transform: scale(1.1) rotate(5deg);
}

.family-name {
    font-size: 1.2rem;
    font-weight: 500;
    margin-bottom: 0.25rem;
    position: relative;
    z-index: 1;
}

.family-title {
    font-size: 0.7rem;
    letter-spacing: 0.15em;
    color: var(--text-dim);
    text-transform: uppercase;
    position: relative;
    z-index: 1;
}

.family-lesson {
    margin-top: 1rem;
    font-size: 0.85rem;
    color: rgba(255,255,255,0.5);
    font-style: italic;
    position: relative;
    z-index: 1;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
}

.family-card:hover .family-lesson {
    opacity: 1;
    transform: translateY(0);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GIFT LINKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.gift-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
    margin: 2rem 0;
}

.gift-link {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1.5rem;
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 16px;
    text-decoration: none;
    color: inherit;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    position: relative;
    overflow: hidden;
}

.gift-link::after {
    content: 'â†’';
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%) translateX(10px);
    opacity: 0;
    transition: all 0.3s ease;
    color: var(--flow);
}

.gift-link:hover {
    transform: translateY(-4px);
    border-color: rgba(255,215,0,0.4);
    box-shadow: 0 15px 40px rgba(255,215,0,0.15);
    padding-right: 2.5rem;
}

.gift-link:hover::after {
    opacity: 1;
    transform: translateY(-50%) translateX(0);
}

.gift-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    transition: transform 0.3s;
}

.gift-link:hover .gift-icon {
    transform: scale(1.15);
}

.gift-name {
    font-size: 1rem;
    font-weight: 500;
}

.gift-subtitle {
    font-size: 0.65rem;
    letter-spacing: 0.1em;
    color: var(--text-dim);
    text-transform: uppercase;
    margin-top: 0.25rem;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUOTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.quote {
    position: relative;
    padding: 3rem;
    margin: 4rem 0;
    text-align: center;
}

.quote-text {
    font-size: 1.5rem;
    font-weight: 300;
    font-style: italic;
    color: var(--text);
    line-height: 1.6;
    position: relative;
    z-index: 1;
}

.quote::before,
.quote::after {
    content: '"';
    position: absolute;
    font-size: 8rem;
    font-family: Georgia, serif;
    color: rgba(255,255,255,0.03);
    line-height: 1;
}

.quote::before { top: 0; left: 0; }
.quote::after { bottom: 0; right: 0; transform: rotate(180deg); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.memo-footer {
    text-align: center;
    padding: 4rem 0;
    border-top: 1px solid rgba(255,255,255,0.05);
    margin-top: 4rem;
}

.signature {
    font-size: 0.7rem;
    letter-spacing: 0.3em;
    color: var(--text-dim);
    text-transform: uppercase;
}

.signature-kanji {
    font-size: 3rem;
    color: rgba(255,255,255,0.05);
    margin-top: 2rem;
    cursor: pointer;
    transition: all 0.5s ease;
    font-family: serif;
}

.signature-kanji:hover {
    color: var(--flow);
    text-shadow: 0 0 60px var(--flow);
    transform: scale(1.2);
}

.visit-count {
    font-size: 0.65rem;
    color: rgba(255,255,255,0.2);
    margin-top: 1rem;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUDIO TOGGLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#audio-toggle {
    position: fixed;
    bottom: 2rem;
    left: 2rem;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--text-dim);
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
}

#audio-toggle:hover {
    background: rgba(255,255,255,0.06);
    border-color: var(--flow);
    color: var(--flow);
    transform: scale(1.1);
}

#audio-toggle.playing {
    animation: audioPulse 2s ease-in-out infinite;
}

@keyframes audioPulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(0,255,204,0.3); }
    50% { box-shadow: 0 0 0 10px rgba(0,255,204,0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECRET PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#secret-panel {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--text-dim);
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
}

#secret-panel:hover {
    transform: rotate(180deg) scale(1.1);
    border-color: var(--nexus);
    color: var(--nexus);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

@media (max-width: 768px) {
    .container { padding: 1.5rem; }
    .memo-header { padding: 4rem 0 3rem; }
    .mega-stats { gap: 1rem; }
    .mega-stat { padding: 1.5rem 1rem; }
    .stat-number { font-size: 2rem; }
    .family-grid { gap: 1rem; }
    .family-card { padding: 1.5rem; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SELECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

::selection {
    background: rgba(0,255,204,0.3);
    color: white;
}
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading">
        <div class="loading-kanji">é¡</div>
        <div class="loading-text">Initializing Mirror</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loading-progress"></div>
        </div>
    </div>

    <!-- Canvas Layers -->
    <canvas id="constellation-canvas"></canvas>
    <canvas id="particle-canvas"></canvas>
    <canvas id="trail-canvas"></canvas>

    <!-- Background -->
    <div class="bg-layer bg-layer-2"></div>
    <div class="bg-layer bg-layer-1"></div>

    <!-- Cursor -->
    <div id="cursor"></div>
    <div id="cursor-ring"></div>

    <!-- Main Content -->
    <div class="container">
        <header class="memo-header">
            <div class="kanji-container">
                <div class="kanji" id="main-kanji" data-original="é¡">é¡</div>
                <div class="kanji-reflection" aria-hidden="true">é¡</div>
            </div>
            <h1 class="memo-title">WORKING WITHIN CONSTRAINT</h1>
            <p class="memo-subtitle">36 Engineering-Weeks â†’ 5.5 Days</p>
        </header>

        <div class="mega-stats">
            <div class="mega-stat" data-value="227">
                <div class="stat-number" data-count="227">0</div>
                <div class="stat-label">Commits</div>
                <div class="stat-context">chronOS + art</div>
            </div>
            <div class="mega-stat" data-value="197286">
                <div class="stat-number" data-count="197286" data-suffix="K" data-divisor="1000">0</div>
                <div class="stat-label">Lines Written</div>
                <div class="stat-context">197,286 total</div>
            </div>
            <div class="mega-stat" data-value="36">
                <div class="stat-number" data-count="36">0</div>
                <div class="stat-label">Eng-Weeks</div>
                <div class="stat-context">traditional estimate</div>
            </div>
            <div class="mega-stat" data-value="52">
                <div class="stat-number" data-count="52">0</div>
                <div class="stat-label">Ã— Compression</div>
                <div class="stat-context">efficiency ratio</div>
            </div>
        </div>

        <section data-reveal>
            <h2>For the Family</h2>
            <div class="story">
                <p>
                    While visiting you, I built something on my phone. Not because I had toâ€”because 
                    I wanted to see what happens when <strong>constraints shape solutions</strong>.
                </p>
                <p>
                    Dad, you know this from engineering. Mom, from storytelling. Kristi, from orbital 
                    mechanics. Becky, from managing a busy schedule while keeping Toast and Moose happy.
                </p>
            </div>
        </section>

        <section data-reveal>
            <h2>What This Means for You</h2>
            <div class="family-grid">
                <div class="family-card" data-person="robert" tabindex="0">
                    <div class="family-icon">ğŸ”§</div>
                    <div class="family-name">Dad</div>
                    <div class="family-title">The Builder</div>
                    <div class="family-lesson">"Right tool, right job. Phone for planning, workshop for execution."</div>
                </div>
                <div class="family-card" data-person="katie" tabindex="0">
                    <div class="family-icon">ğŸ“š</div>
                    <div class="family-name">Mom</div>
                    <div class="family-title">The Reader</div>
                    <div class="family-lesson">"First drafts on phone. Revision at the desk."</div>
                </div>
                <div class="family-card" data-person="kristi" tabindex="0">
                    <div class="family-icon">ğŸ”­</div>
                    <div class="family-name">Kristi</div>
                    <div class="family-title">The Orrery</div>
                    <div class="family-lesson">"Different orbital regimes have different trade-offs."</div>
                </div>
                <div class="family-card" data-person="becky" tabindex="0">
                    <div class="family-icon">ğŸ³</div>
                    <div class="family-name">Becky</div>
                    <div class="family-title">The Kitchen</div>
                    <div class="family-lesson">"Prep is progress. Constraint time isn't wasted time."</div>
                </div>
            </div>
        </section>

        <section data-reveal>
            <div class="quote">
                <p class="quote-text">When you can't do everything, you learn what actually matters.</p>
            </div>
        </section>

        <section data-reveal>
            <h2>Your Gifts</h2>
            <div class="story">
                <p>Each designed specifically for you. Not genericâ€”<span class="highlight">yours</span>.</p>
            </div>
            <div class="gift-grid">
                <a href="gifts/robert.html" class="gift-link">
                    <span class="gift-icon">âš™ï¸</span>
                    <span class="gift-name">Robert</span>
                    <span class="gift-subtitle">The Builder</span>
                </a>
                <a href="gifts/katie.html" class="gift-link">
                    <span class="gift-icon">ğŸ“š</span>
                    <span class="gift-name">Katie</span>
                    <span class="gift-subtitle">A Library of Your Own</span>
                </a>
                <a href="gifts/kristi.html" class="gift-link">
                    <span class="gift-icon">ğŸ”­</span>
                    <span class="gift-name">Kristi</span>
                    <span class="gift-subtitle">The Orrery</span>
                </a>
                <a href="gifts/becky.html" class="gift-link">
                    <span class="gift-icon">ğŸ³</span>
                    <span class="gift-name">Becky</span>
                    <span class="gift-subtitle">A Kitchen Without Limits</span>
                </a>
            </div>
        </section>

        <section data-reveal>
            <h2>About Your AI</h2>
            <div class="story">
                <p>
                    When you talk to your Kagami instance, you're using something built under constraint.
                    It understands trade-offs because that's how it was made.
                </p>
                <p>
                    <strong>Dad:</strong> Ask technical questions. It thinks in engineering trade-offs.<br>
                    <strong>Mom:</strong> Use it for writing. Clarity over verbosity is baked in.<br>
                    <strong>Kristi:</strong> Ask how things connect. It's built on mathematical structure.<br>
                    <strong>Becky:</strong> Ask for practical help. It won't over-complicate.
                </p>
            </div>
        </section>

        <footer class="memo-footer">
            <div class="signature">With love from the workshop</div>
            <div class="signature-kanji" id="signature-kanji">é¡</div>
            <div class="visit-count" id="visit-count"></div>
        </footer>
    </div>

    <!-- Controls -->
    <button id="audio-toggle" title="Toggle ambient sound">ğŸ”‡</button>
    <button id="secret-panel" title="Secrets">âˆ</button>

    <script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   é¡ KAGAMI MEMO â€” TRANSCENDENT INTERACTIVE LAYER
   
   Capabilities:
   â”œâ”€â”€ Canvas: Constellation visualization, particle physics, mouse trails
   â”œâ”€â”€ Audio: Web Audio API ambient drone, interaction sounds
   â”œâ”€â”€ Physics: Spring dynamics, magnetic cursor, gravity particles
   â”œâ”€â”€ Secrets: Konami code, typed sequences, click combos, console API
   â”œâ”€â”€ Mobile: Gyroscope parallax, shake detection, touch support
   â”œâ”€â”€ State: localStorage persistence, visit counting, preference memory
   â””â”€â”€ Animation: FLIP technique, spring physics, staggered reveals
   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

(function() {
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const state = {
    mouse: { x: 0, y: 0, targetX: 0, targetY: 0 },
    ring: { x: 0, y: 0 },
    audio: { ctx: null, playing: false, nodes: {} },
    konami: { sequence: [], target: [38,38,40,40,37,39,37,39,66,65] },
    typed: { buffer: '', timeout: null },
    visits: parseInt(localStorage.getItem('kagami_memo_visits') || '0') + 1,
    secrets: JSON.parse(localStorage.getItem('kagami_memo_secrets') || '[]'),
    particles: [],
    trails: [],
    constellation: { nodes: [], connections: [] }
};

localStorage.setItem('kagami_memo_visits', state.visits);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOADING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const loading = document.getElementById('loading');
const loadingProgress = document.getElementById('loading-progress');
let loadProgress = 0;

function updateLoading(progress) {
    loadProgress = Math.min(progress, 100);
    loadingProgress.style.width = loadProgress + '%';
    if (loadProgress >= 100) {
        setTimeout(() => loading.classList.add('hidden'), 500);
    }
}

// Simulate loading stages
setTimeout(() => updateLoading(30), 100);
setTimeout(() => updateLoading(60), 300);
setTimeout(() => updateLoading(90), 500);
window.addEventListener('load', () => updateLoading(100));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CURSOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const cursor = document.getElementById('cursor');
const cursorRing = document.getElementById('cursor-ring');

document.addEventListener('mousemove', e => {
    state.mouse.targetX = e.clientX;
    state.mouse.targetY = e.clientY;
    cursor.style.left = e.clientX + 'px';
    cursor.style.top = e.clientY + 'px';
    
    // Add trail point
    state.trails.push({
        x: e.clientX,
        y: e.clientY,
        life: 1,
        color: `hsl(${(Date.now() / 20) % 360}, 70%, 60%)`
    });
    if (state.trails.length > 50) state.trails.shift();
});

function animateCursor() {
    // Spring physics for ring
    const dx = state.mouse.targetX - state.ring.x;
    const dy = state.mouse.targetY - state.ring.y;
    state.ring.x += dx * 0.12;
    state.ring.y += dy * 0.12;
    cursorRing.style.left = state.ring.x + 'px';
    cursorRing.style.top = state.ring.y + 'px';
    requestAnimationFrame(animateCursor);
}
animateCursor();

// Hover states
document.querySelectorAll('a, button, .family-card, .mega-stat, .gift-link, .kanji, .signature-kanji').forEach(el => {
    el.addEventListener('mouseenter', () => {
        cursor.classList.add('hovering');
        cursorRing.classList.add('hovering');
    });
    el.addEventListener('mouseleave', () => {
        cursor.classList.remove('hovering');
        cursorRing.classList.remove('hovering');
    });
});

document.addEventListener('mousedown', () => cursor.classList.add('clicking'));
document.addEventListener('mouseup', () => cursor.classList.remove('clicking'));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ALL CANVASES (declare together to avoid reference errors)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const constellationCanvas = document.getElementById('constellation-canvas');
const constellationCtx = constellationCanvas.getContext('2d');
const particleCanvas = document.getElementById('particle-canvas');
const particleCtx = particleCanvas.getContext('2d');
const trailCanvas = document.getElementById('trail-canvas');
const trailCtx = trailCanvas.getContext('2d');

function resizeCanvases() {
    [constellationCanvas, particleCanvas, trailCanvas].forEach(c => {
        c.width = window.innerWidth;
        c.height = window.innerHeight;
    });
}
resizeCanvases();
window.addEventListener('resize', resizeCanvases);

// Initialize constellation nodes (7 colonies)
const colonies = [
    { name: 'Spark', color: '#FF4422', x: 0.2, y: 0.3 },
    { name: 'Forge', color: '#FFAA00', x: 0.5, y: 0.2 },
    { name: 'Flow', color: '#00FFCC', x: 0.8, y: 0.3 },
    { name: 'Nexus', color: '#BB44FF', x: 0.3, y: 0.6 },
    { name: 'Beacon', color: '#FFDD00', x: 0.5, y: 0.5 },
    { name: 'Grove', color: '#22FF66', x: 0.7, y: 0.6 },
    { name: 'Crystal', color: '#44DDFF', x: 0.5, y: 0.8 }
];

// Fano plane connections
const fanoLines = [
    [0,1,2], [0,3,4], [0,5,6], [1,3,5], [1,4,6], [2,3,6], [2,4,5]
];

colonies.forEach((c, i) => {
    state.constellation.nodes.push({
        x: c.x * window.innerWidth,
        y: c.y * window.innerHeight,
        baseX: c.x,
        baseY: c.y,
        color: c.color,
        name: c.name,
        radius: 4,
        pulsePhase: Math.random() * Math.PI * 2
    });
});

fanoLines.forEach(line => {
    state.constellation.connections.push({
        from: line[0],
        to: line[1],
        opacity: 0.1
    });
    state.constellation.connections.push({
        from: line[1],
        to: line[2],
        opacity: 0.1
    });
});

function drawConstellation() {
    constellationCtx.clearRect(0, 0, constellationCanvas.width, constellationCanvas.height);
    
    const time = Date.now() / 1000;
    
    // Update node positions with slight drift
    state.constellation.nodes.forEach((node, i) => {
        node.x = node.baseX * window.innerWidth + Math.sin(time * 0.5 + i) * 20;
        node.y = node.baseY * window.innerHeight + Math.cos(time * 0.3 + i) * 15;
        node.pulsePhase += 0.02;
    });
    
    // Draw connections
    state.constellation.connections.forEach(conn => {
        const from = state.constellation.nodes[conn.from];
        const to = state.constellation.nodes[conn.to];
        
        constellationCtx.beginPath();
        constellationCtx.moveTo(from.x, from.y);
        constellationCtx.lineTo(to.x, to.y);
        constellationCtx.strokeStyle = `rgba(255,255,255,${conn.opacity})`;
        constellationCtx.lineWidth = 0.5;
        constellationCtx.stroke();
    });
    
    // Draw nodes
    state.constellation.nodes.forEach(node => {
        const pulse = Math.sin(node.pulsePhase) * 0.3 + 0.7;
        const radius = node.radius * pulse;
        
        // Glow
        const gradient = constellationCtx.createRadialGradient(
            node.x, node.y, 0,
            node.x, node.y, radius * 4
        );
        gradient.addColorStop(0, node.color + '40');
        gradient.addColorStop(1, 'transparent');
        constellationCtx.fillStyle = gradient;
        constellationCtx.beginPath();
        constellationCtx.arc(node.x, node.y, radius * 4, 0, Math.PI * 2);
        constellationCtx.fill();
        
        // Core
        constellationCtx.fillStyle = node.color;
        constellationCtx.beginPath();
        constellationCtx.arc(node.x, node.y, radius, 0, Math.PI * 2);
        constellationCtx.fill();
    });
    
    requestAnimationFrame(drawConstellation);
}
drawConstellation();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARTICLE SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Initialize particles
for (let i = 0; i < 60; i++) {
    state.particles.push({
        x: Math.random() * window.innerWidth,
        y: Math.random() * window.innerHeight,
        vx: (Math.random() - 0.5) * 0.3,
        vy: (Math.random() - 0.5) * 0.3,
        radius: Math.random() * 2 + 0.5,
        opacity: Math.random() * 0.5 + 0.1,
        color: ['#00FFCC', '#FFAA00', '#FF4422', '#44DDFF', '#BB44FF', '#22FF66'][Math.floor(Math.random() * 6)]
    });
}

function drawParticles() {
    particleCtx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
    
    state.particles.forEach(p => {
        // Mouse attraction
        const dx = state.mouse.targetX - p.x;
        const dy = state.mouse.targetY - p.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        
        if (dist < 200) {
            const force = (200 - dist) / 200 * 0.01;
            p.vx += dx * force;
            p.vy += dy * force;
        }
        
        // Apply velocity with damping
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.99;
        p.vy *= 0.99;
        
        // Wrap around
        if (p.x < 0) p.x = particleCanvas.width;
        if (p.x > particleCanvas.width) p.x = 0;
        if (p.y < 0) p.y = particleCanvas.height;
        if (p.y > particleCanvas.height) p.y = 0;
        
        // Draw
        particleCtx.beginPath();
        particleCtx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        particleCtx.fillStyle = p.color + Math.floor(p.opacity * 255).toString(16).padStart(2, '0');
        particleCtx.fill();
    });
    
    requestAnimationFrame(drawParticles);
}
drawParticles();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRAIL SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function drawTrails() {
    trailCtx.clearRect(0, 0, trailCanvas.width, trailCanvas.height);
    
    state.trails.forEach((t, i) => {
        t.life -= 0.03;
        if (t.life > 0) {
            trailCtx.beginPath();
            trailCtx.arc(t.x, t.y, 2 * t.life, 0, Math.PI * 2);
            trailCtx.fillStyle = t.color.replace(')', `, ${t.life * 0.3})`).replace('hsl', 'hsla');
            trailCtx.fill();
        }
    });
    
    state.trails = state.trails.filter(t => t.life > 0);
    requestAnimationFrame(drawTrails);
}
drawTrails();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUDIO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const audioToggle = document.getElementById('audio-toggle');

function initAudio() {
    if (state.audio.ctx) return;
    
    state.audio.ctx = new (window.AudioContext || window.webkitAudioContext)();
    
    // Create ambient drone
    const createOscillator = (freq, type, gain) => {
        const osc = state.audio.ctx.createOscillator();
        const gainNode = state.audio.ctx.createGain();
        osc.type = type;
        osc.frequency.value = freq;
        gainNode.gain.value = gain;
        osc.connect(gainNode);
        gainNode.connect(state.audio.ctx.destination);
        return { osc, gain: gainNode };
    };
    
    state.audio.nodes.drone1 = createOscillator(55, 'sine', 0);
    state.audio.nodes.drone2 = createOscillator(82.5, 'sine', 0);
    state.audio.nodes.drone3 = createOscillator(110, 'triangle', 0);
    
    Object.values(state.audio.nodes).forEach(n => n.osc.start());
}

function toggleAudio() {
    initAudio();
    
    const targetGain = state.audio.playing ? 0 : 0.03;
    const rampTime = state.audio.ctx.currentTime + 0.5;
    
    Object.values(state.audio.nodes).forEach(n => {
        n.gain.gain.linearRampToValueAtTime(targetGain, rampTime);
    });
    
    state.audio.playing = !state.audio.playing;
    audioToggle.textContent = state.audio.playing ? 'ğŸ”Š' : 'ğŸ”‡';
    audioToggle.classList.toggle('playing', state.audio.playing);
}

audioToggle.addEventListener('click', toggleAudio);

// Interaction sounds
function playTone(freq, duration = 0.1) {
    if (!state.audio.ctx) initAudio();
    const osc = state.audio.ctx.createOscillator();
    const gain = state.audio.ctx.createGain();
    osc.type = 'sine';
    osc.frequency.value = freq;
    gain.gain.value = 0.05;
    gain.gain.exponentialRampToValueAtTime(0.001, state.audio.ctx.currentTime + duration);
    osc.connect(gain);
    gain.connect(state.audio.ctx.destination);
    osc.start();
    osc.stop(state.audio.ctx.currentTime + duration);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COUNTING ANIMATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.querySelectorAll('.stat-number[data-count]').forEach(el => {
    const target = parseInt(el.dataset.count);
    const divisor = parseInt(el.dataset.divisor) || 1;
    const suffix = el.dataset.suffix || '';
    let current = 0;
    
    const observer = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
            const duration = 2000;
            const start = performance.now();
            
            function animate(now) {
                const elapsed = now - start;
                const progress = Math.min(elapsed / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3);
                current = Math.floor(target * eased);
                el.textContent = Math.floor(current / divisor) + suffix;
                if (progress < 1) requestAnimationFrame(animate);
            }
            requestAnimationFrame(animate);
            observer.disconnect();
        }
    }, { threshold: 0.5 });
    
    observer.observe(el);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCROLL REVEAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach((entry, i) => {
        if (entry.isIntersecting) {
            setTimeout(() => entry.target.classList.add('visible'), i * 100);
        }
    });
}, { threshold: 0.1, rootMargin: '-50px' });

document.querySelectorAll('section[data-reveal]').forEach(s => revealObserver.observe(s));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STAT CARD MOUSE TRACKING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.querySelectorAll('.mega-stat').forEach(card => {
    card.addEventListener('mousemove', e => {
        const rect = card.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        card.style.setProperty('--mx', x + '%');
        card.style.setProperty('--my', y + '%');
    });
    
    card.addEventListener('click', () => playTone(440 + Math.random() * 200));
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FAMILY CARD INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.querySelectorAll('.family-card').forEach(card => {
    card.addEventListener('click', () => {
        const person = card.dataset.person;
        const tones = { robert: 220, katie: 330, kristi: 440, becky: 550 };
        playTone(tones[person] || 440);
        console.log(`%c${card.querySelector('.family-name').textContent}%c â€” ${card.querySelector('.family-lesson').textContent}`,
            'color: ' + getComputedStyle(card).getPropertyValue('--card-color') + '; font-weight: bold;', '');
    });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KANJI INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const kanjiSequence = ['é¡', 'é‘‘', 'å¢ƒ', 'éŸ¿', 'é¡'];
let kanjiIndex = 0;

const mainKanji = document.getElementById('main-kanji');
const signatureKanji = document.getElementById('signature-kanji');

[mainKanji, signatureKanji].forEach(el => {
    el.addEventListener('click', () => {
        kanjiIndex = (kanjiIndex + 1) % kanjiSequence.length;
        el.textContent = kanjiSequence[kanjiIndex];
        document.querySelector('.kanji-reflection').textContent = kanjiSequence[kanjiIndex];
        
        const meanings = {
            'é¡': 'ğŸª kagami â€” mirror',
            'é‘‘': 'ğŸ” kan â€” to examine, to judge',
            'å¢ƒ': 'ğŸŒ kyÅ â€” boundary, border',
            'éŸ¿': 'ğŸ”” kyÅ â€” echo, sound, resound'
        };
        console.log(meanings[kanjiSequence[kanjiIndex]]);
        playTone(200 + kanjiIndex * 100);
        
        if (!state.secrets.includes('kanji_cycle')) {
            state.secrets.push('kanji_cycle');
            localStorage.setItem('kagami_memo_secrets', JSON.stringify(state.secrets));
        }
    });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KONAMI CODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('keydown', e => {
    state.konami.sequence.push(e.keyCode);
    if (state.konami.sequence.length > 10) state.konami.sequence.shift();
    
    if (state.konami.sequence.join(',') === state.konami.target.join(',')) {
        document.body.style.animation = 'rainbow 2s linear infinite';
        const style = document.createElement('style');
        style.textContent = '@keyframes rainbow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }';
        document.head.appendChild(style);
        console.log('%cğŸ® KONAMI CODE ACTIVATED!', 'color: #FF4422; font-size: 2em;');
        
        setTimeout(() => {
            document.body.style.animation = '';
            style.remove();
        }, 5000);
        
        if (!state.secrets.includes('konami')) {
            state.secrets.push('konami');
            localStorage.setItem('kagami_memo_secrets', JSON.stringify(state.secrets));
        }
    }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TYPED SEQUENCES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('keypress', e => {
    clearTimeout(state.typed.timeout);
    state.typed.buffer += e.key.toLowerCase();
    state.typed.timeout = setTimeout(() => state.typed.buffer = '', 1000);
    
    if (state.typed.buffer.includes('mirror')) {
        document.body.style.transform = 'scaleX(-1)';
        setTimeout(() => document.body.style.transform = '', 3000);
        console.log('%cğŸª Mirror mode!', 'color: #00FFCC;');
    }
    
    if (state.typed.buffer.includes('colony')) {
        state.constellation.connections.forEach(c => c.opacity = 0.5);
        setTimeout(() => state.constellation.connections.forEach(c => c.opacity = 0.1), 3000);
        console.log('%câœ¨ Fano plane revealed!', 'color: #FFAA00;');
    }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECRET PANEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.getElementById('secret-panel').addEventListener('click', () => {
    console.log(`
%câ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        é¡ SECRETS                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  ğŸ® Konami Code    â†‘â†‘â†“â†“â†â†’â†â†’BA     Rainbow mode               â•‘
â•‘  âŒ¨ï¸  Type "mirror"                 Flip the page              â•‘
â•‘  âŒ¨ï¸  Type "colony"                 Reveal Fano plane          â•‘
â•‘  ğŸ–±ï¸  Click é¡                      Cycle kanji meanings       â•‘
â•‘  ğŸ”Š Audio toggle                   Ambient drone              â•‘
â•‘                                                               â•‘
â•‘  Console API:                                                 â•‘
â•‘    é¡.forRobert()  é¡.forKatie()                              â•‘
â•‘    é¡.forKristi()  é¡.forBecky()                              â•‘
â•‘    é¡.stats()      é¡.reflect()                               â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
%c
Visit #${state.visits} | ${state.secrets.length} secrets found
`, 'color: #00FFCC; font-family: monospace;', 'color: #666;');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MOBILE: GYROSCOPE & SHAKE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', e => {
        const tiltX = e.gamma / 90;
        const tiltY = e.beta / 90;
        document.querySelectorAll('.bg-layer').forEach((layer, i) => {
            const factor = (i + 1) * 10;
            layer.style.transform = `translate(${tiltX * factor}px, ${tiltY * factor}px)`;
        });
    });
}

if (window.DeviceMotionEvent) {
    let lastShake = 0;
    window.addEventListener('devicemotion', e => {
        const acc = e.accelerationIncludingGravity;
        const total = Math.abs(acc.x) + Math.abs(acc.y) + Math.abs(acc.z);
        if (total > 30 && Date.now() - lastShake > 1000) {
            lastShake = Date.now();
            // Burst particles
            for (let i = 0; i < 20; i++) {
                state.particles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    radius: Math.random() * 3 + 1,
                    opacity: 1,
                    color: ['#00FFCC', '#FFAA00', '#FF4422'][Math.floor(Math.random() * 3)]
                });
            }
        }
    });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// VISIT COUNT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.getElementById('visit-count').textContent = 
    state.visits === 1 ? 'First visit' : `Visit #${state.visits}`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WINDOW.é¡ â€” PUBLIC API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

window.é¡ = {
    name: 'Family Memo',
    from: 'Tim',
    version: '2.0.0',
    
    stats: () => console.log(`
ğŸ“Š MEMO STATISTICS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Commits: 227 (chronOS + art)
Lines: 197,286 written
Net: 81,044 new
Eng-weeks: 36 (traditional)
Compression: 52Ã—
Visit: #${state.visits}
Secrets: ${state.secrets.length}/4 found
    `),
    
    family: {
        robert: { title: 'The Builder', lesson: 'Right tool, right job.' },
        katie: { title: 'The Reader', lesson: 'First drafts vs final drafts.' },
        kristi: { title: 'The Orrery', lesson: 'Transfer orbits and trade-offs.' },
        becky: { title: 'The Kitchen', lesson: 'Prep is progress. (Toast & Moose approve.)' }
    },
    
    forRobert: () => console.log('%cğŸ”§ Dad:%c Right tool, right job. Phone for planning, workshop for execution.', 'color: #FFAA00; font-weight: bold;', ''),
    forKatie: () => console.log('%cğŸ“š Mom:%c First drafts on phone. Revision at the desk.', 'color: #22FF66; font-weight: bold;', ''),
    forKristi: () => console.log('%cğŸ”­ Kristi:%c Different orbital regimes have different trade-offs.', 'color: #44DDFF; font-weight: bold;', ''),
    forBecky: () => console.log('%cğŸ³ Becky:%c Prep is progress. Constraint time isn\'t wasted time. (Toast & Moose send tail wags.)', 'color: #FF4422; font-weight: bold;', ''),
    
    reflect: () => console.log('%cğŸª The constraint became the feature.', 'color: #00FFCC; font-style: italic;'),
    
    constellation: () => {
        state.constellation.connections.forEach(c => c.opacity = 0.5);
        setTimeout(() => state.constellation.connections.forEach(c => c.opacity = 0.1), 5000);
        console.log('%câœ¨ Fano plane revealed for 5 seconds', 'color: #BB44FF;');
    },
    
    secret: () => console.log('%cğŸ”® Try: é¡.forRobert(), é¡.stats(), é¡.constellation()', 'color: #666; font-style: italic;')
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONSOLE GREETING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

console.log(`
%cé¡%c Working Within Constraint
%câ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

%c36 engineering-weeks â†’ 5.5 days%c

When you can't do everything,
you learn what actually matters.

%cType é¡.secret() to explore the API.%c
`, 
'font-size: 4em; color: #00FFCC;',
'font-size: 1.5em; color: #fff; margin-left: 10px;',
'color: #333;',
'color: #FFAA00; font-weight: bold;',
'',
'color: #666; font-style: italic;',
''
);

})();
    </script>
</body>
</html>
