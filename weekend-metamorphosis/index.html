<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0f0a1e">
    <meta name="description" content="Weekend Metamorphosis — 165 commits in 53 hours. Interactive visualization of a codebase transformation.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <title>Weekend Metamorphosis — 165 Commits in 53 Hours</title>
    
    <style>
        :root {
            /* Deep space palette */
            --void: #0f0a1e;
            --void-purple: #130d24;
            --void-blue: #0d1321;
            
            /* Surfaces */
            --surface-1: #1a1432;
            --surface-2: #231c42;
            --surface-3: #2d2454;
            
            /* Vibrant accents */
            --violet: #8b5cf6;
            --violet-light: #a78bfa;
            --fuchsia: #d946ef;
            --emerald: #10b981;
            --cyan: #06b6d4;
            --orange: #f97316;
            --amber: #f59e0b;
            --rose: #f43f5e;
            
            /* Semantic */
            --success: #4ade80;
            --danger: #f87171;
            
            /* Commit types */
            --color-feature: #4ade80;
            --color-fix: #f87171;
            --color-refactor: #a78bfa;
            --color-chore: #60a5fa;
            --color-docs: #fbbf24;
            --color-other: #94a3b8;
            
            /* Text - LARGER */
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --text-dim: #64748b;
            
            /* Glass */
            --glass-bg: rgba(26, 20, 50, 0.8);
            --glass-border: rgba(139, 92, 246, 0.25);
            
            /* Typography - BIGGER */
            --font-display: "Space Grotesk", system-ui, sans-serif;
            --font-mono: "JetBrains Mono", monospace;
            
            /* Base size increased */
            --text-xs: 0.875rem;
            --text-sm: 1rem;
            --text-base: 1.125rem;
            --text-lg: 1.25rem;
            --text-xl: 1.5rem;
            --text-2xl: 2rem;
            --text-3xl: 2.5rem;
            --text-4xl: 3.5rem;
            --text-5xl: 5rem;
            
            /* Spacing */
            --space-1: 4px; --space-2: 8px; --space-3: 12px; --space-4: 16px;
            --space-5: 24px; --space-6: 32px; --space-7: 48px; --space-8: 64px;
            --space-9: 96px; --space-10: 128px;
            
            --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
            --dur-fast: 150ms;
            --dur-med: 300ms;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        
        html { 
            scroll-behavior: smooth; 
            font-size: 18px; /* Increased base */
        }
        
        /* Scroll progress indicator */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, var(--violet), var(--fuchsia), var(--cyan));
            z-index: 9999;
            transition: width 0.1s ease-out;
        }

        body {
            background: var(--void);
            color: var(--text-primary);
            font-family: var(--font-display);
            font-size: var(--text-base);
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }
        
        ::selection { background: var(--violet); color: white; }
        
        /* ═══════════════════════════════════════════════════════════════════════════
           ANIMATIONS
           ═══════════════════════════════════════════════════════════════════════════ */
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes fade-up {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes glow-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); }
            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.5); }
        }

        .animate-in { animation: fade-up 0.8s var(--ease-out) both; }
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        
        /* Micro-delight: shimmer effect on hover */
        .shimmer-hover {
            position: relative;
            overflow: hidden;
        }
        
        .shimmer-hover::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 100%
            );
            background-size: 200% 100%;
            opacity: 0;
            transition: opacity var(--dur-fast);
        }
        
        .shimmer-hover:hover::after {
            opacity: 1;
            animation: shimmer 1s ease-in-out;
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           HERO
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: var(--space-8);
            position: relative;
            overflow: hidden;
        }
        
        .hero-bg {
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(139, 92, 246, 0.35), transparent),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(217, 70, 239, 0.25), transparent),
                radial-gradient(ellipse 50% 30% at 20% 60%, rgba(6, 182, 212, 0.2), transparent);
        }
        
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            animation: float 20s ease-in-out infinite;
        }
        
        .orb-1 {
            width: 500px; height: 500px;
            background: radial-gradient(circle, var(--violet) 0%, transparent 70%);
            top: 5%; left: 5%;
        }
        
        .orb-2 {
            width: 400px; height: 400px;
            background: radial-gradient(circle, var(--fuchsia) 0%, transparent 70%);
            bottom: 10%; right: 10%;
            animation-delay: -7s;
        }
        
        .grid-lines {
            position: absolute;
            inset: 0;
            background-image: 
                linear-gradient(rgba(139, 92, 246, 0.04) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139, 92, 246, 0.04) 1px, transparent 1px);
            background-size: 80px 80px;
            mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black, transparent);
        }
        
        .hero-content {
            max-width: 900px;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-3);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(16px);
            padding: var(--space-3) var(--space-5);
            border-radius: 100px;
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--violet-light);
            margin-bottom: var(--space-6);
            transition: all var(--dur-med) var(--ease-out);
        }
        
        .hero-badge:hover {
            border-color: var(--violet);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.3);
        }
        
        .badge-dot {
            width: 10px; height: 10px;
            background: var(--emerald);
            border-radius: 50%;
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        .hero-title {
            font-size: clamp(var(--text-4xl), 12vw, 7rem);
            font-weight: 700;
            letter-spacing: -0.04em;
            line-height: 1;
            margin-bottom: var(--space-6);
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--violet-light) 50%, var(--fuchsia) 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-shift 8s ease infinite;
        }
        
        .hero-subtitle {
            font-size: var(--text-xl);
            font-weight: 400;
            color: var(--text-secondary);
            margin-bottom: var(--space-8);
        }
        
        .hero-subtitle strong {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-5);
            margin-bottom: var(--space-8);
        }
        
        .stat-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-6);
            backdrop-filter: blur(20px);
            transition: all var(--dur-med) var(--ease-out);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.08) 50%,
                transparent 100%
            );
            background-size: 200% 100%;
            opacity: 0;
            transition: opacity var(--dur-fast);
        }
        
        .stat-card:hover {
            transform: translateY(-6px);
            border-color: var(--violet);
            box-shadow: 0 24px 48px rgba(139, 92, 246, 0.25);
        }
        
        .stat-card:hover::after {
            opacity: 1;
            animation: shimmer 1s ease-in-out;
        }
        
        .stat-value {
            font-family: var(--font-mono);
            font-size: var(--text-3xl);
            font-weight: 700;
            line-height: 1;
            margin-bottom: var(--space-2);
        }
        
        .stat-value.positive { color: var(--success); }
        .stat-value.negative { color: var(--danger); }
        .stat-value.neutral { 
            background: linear-gradient(135deg, var(--violet-light), var(--fuchsia));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        
        .context-card {
            max-width: 700px;
            margin: 0 auto;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-7);
            backdrop-filter: blur(20px);
            text-align: left;
            transition: all var(--dur-med) var(--ease-out);
        }
        
        .context-card:hover {
            border-color: var(--violet);
            transform: translateY(-4px);
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
        }
        
        .context-header {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            margin-bottom: var(--space-5);
        }
        
        .context-icon {
            width: 44px; height: 44px;
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xl);
        }
        
        .context-title {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--violet-light);
        }
        
        .context-text {
            font-size: var(--text-base);
            color: var(--text-secondary);
            line-height: 1.9;
        }
        
        .context-text code {
            font-family: var(--font-mono);
            background: rgba(139, 92, 246, 0.2);
            color: var(--violet-light);
            padding: 3px 10px;
            border-radius: 6px;
            font-size: 0.9em;
        }
        
        .scroll-hint {
            position: absolute;
            bottom: var(--space-8);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-3);
            color: var(--text-dim);
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            letter-spacing: 0.15em;
            text-transform: uppercase;
        }
        
        .scroll-mouse {
            width: 28px; height: 44px;
            border: 2px solid var(--text-dim);
            border-radius: 14px;
            position: relative;
        }
        
        .scroll-mouse::before {
            content: '';
            position: absolute;
            top: 8px; left: 50%;
            transform: translateX(-50%);
            width: 4px; height: 10px;
            background: var(--violet);
            border-radius: 2px;
            animation: float 1.5s ease-in-out infinite;
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           SECTIONS
           ═══════════════════════════════════════════════════════════════════════════ */
        
        section {
            padding: var(--space-10) var(--space-8);
            position: relative;
        }
        
        .section-header {
            text-align: center;
            max-width: 700px;
            margin: 0 auto var(--space-9);
        }
        
        .section-number {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 600;
            letter-spacing: 0.2em;
            color: var(--violet);
            margin-bottom: var(--space-3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-4);
        }
        
        .section-number::before,
        .section-number::after {
            content: '';
            width: 50px; height: 2px;
            background: linear-gradient(90deg, transparent, var(--violet));
        }
        .section-number::after { background: linear-gradient(90deg, var(--violet), transparent); }
        
        .section-title {
            font-size: var(--text-4xl);
            font-weight: 700;
            letter-spacing: -0.03em;
            margin-bottom: var(--space-5);
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--violet-light) 50%, var(--fuchsia) 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-shift 8s ease infinite;
        }
        
        .section-description {
            color: var(--text-secondary);
            font-size: var(--text-lg);
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           TIMELINE - with sticky view controls
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #timeline {
            background: linear-gradient(180deg, var(--void) 0%, var(--void-purple) 100%);
        }
        
        .timeline-wrapper {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        /* View controls INSIDE timeline section */
        .view-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
            background: var(--surface-1);
            backdrop-filter: blur(20px);
            padding: 10px 16px;
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            margin-bottom: var(--space-6);
            position: sticky;
            top: var(--space-4);
            z-index: 100;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .view-label {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-right: var(--space-3);
        }
        
        .view-btn {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 600;
            padding: var(--space-3) var(--space-5);
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 10px;
            transition: all var(--dur-fast) var(--ease-out);
            position: relative;
            overflow: hidden;
        }
        
        .view-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            opacity: 0;
            transition: opacity var(--dur-fast);
        }
        
        .view-btn span {
            position: relative;
            z-index: 1;
        }
        
        .view-btn:hover {
            color: var(--text-primary);
            background: var(--surface-2);
        }
        
        .view-btn.active {
            color: white;
        }
        
        .view-btn.active::before {
            opacity: 1;
        }
        
        .view-btn-icon {
            display: inline-block;
            margin-right: 6px;
            font-size: 0.9em;
        }
        
        .timeline-viz {
            display: flex;
            gap: var(--space-7);
            align-items: stretch;
            position: relative;
            z-index: 1;
        }
        
        .timeline-labels {
            width: 120px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: var(--space-5) 0;
        }
        
        .timeline-label {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text-muted);
            text-align: right;
            padding-right: var(--space-5);
            border-right: 3px solid var(--surface-2);
            position: relative;
        }
        
        .timeline-label::after {
            content: '';
            position: absolute;
            right: -8px; top: 50%;
            transform: translateY(-50%);
            width: 12px; height: 12px;
            background: var(--surface-3);
            border: 3px solid var(--violet);
            border-radius: 50%;
        }
        
        .timeline-bars-container {
            flex: 1;
            background: var(--surface-1);
            border-radius: 20px;
            padding: var(--space-5);
            border: 1px solid var(--glass-border);
            overflow: hidden;
            min-width: 0;
        }
        
        .timeline-bars {
            display: flex;
            flex-direction: column;
            gap: 2px;
            height: 500px;
            overflow: hidden;
        }
        
        .timeline-bar {
            flex: 1;
            min-height: 2px;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            transition: all var(--dur-med) var(--ease-out);
            transform-origin: left center;
        }
        
        .timeline-bar:hover {
            transform: scaleY(2.5) scaleX(1.03);
            filter: brightness(1.5) saturate(1.2);
            z-index: 10;
            box-shadow: 0 0 20px currentColor;
        }
        
        .timeline-bar.dimmed {
            opacity: 0.15;
            transform: scaleY(0.6);
        }
        
        .timeline-bar.highlighted {
            filter: brightness(1.3);
            box-shadow: 0 0 12px currentColor;
        }
        
        /* Tooltip now positioned by JS for smart positioning */
        .bar-tooltip {
            position: fixed;
            background: var(--surface-3);
            color: var(--text-primary);
            padding: var(--space-4) var(--space-5);
            border-radius: 12px;
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--dur-fast), transform var(--dur-fast);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6);
            border: 1px solid var(--violet);
            z-index: 9999;
            max-width: 320px;
            transform: translateY(-50%) scale(0.95);
        }
        
        .bar-tooltip.visible { 
            opacity: 1; 
            transform: translateY(-50%) scale(1);
        }
        
        .bar-tooltip-hash {
            color: var(--violet-light);
            font-weight: 600;
        }
        
        .bar-tooltip-msg {
            color: var(--text-secondary);
            white-space: normal;
            line-height: 1.4;
            margin-top: 4px;
        }
        
        .bar-tooltip-stats {
            display: flex;
            gap: var(--space-4);
            margin-top: var(--space-3);
            padding-top: var(--space-3);
            border-top: 1px solid var(--glass-border);
        }
        
        .bar-tooltip-stats .add { color: var(--success); }
        .bar-tooltip-stats .del { color: var(--danger); }
        
        .timeline-legend {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-4);
            justify-content: center;
            margin-top: var(--space-7);
            padding: var(--space-5);
            background: var(--surface-1);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            position: relative;
            z-index: 50;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-secondary);
            padding: var(--space-3) var(--space-4);
            background: var(--surface-1);
            border-radius: 8px;
            cursor: pointer;
            transition: all var(--dur-fast);
            border: 2px solid transparent;
            user-select: none;
        }
        
        .legend-item:hover {
            background: var(--surface-2);
            color: var(--text-primary);
            transform: translateY(-2px);
        }
        
        .legend-item.active {
            border-color: var(--violet);
            background: var(--surface-2);
            color: var(--text-primary);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }
        
        .legend-item.dimmed {
            opacity: 0.4;
        }
        
        .legend-swatch {
            width: 16px; height: 16px;
            border-radius: 5px;
            transition: transform var(--dur-fast);
        }
        
        .legend-item:hover .legend-swatch {
            transform: scale(1.2);
        }
        
        .legend-clear {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            color: var(--text-dim);
            padding: var(--space-2) var(--space-4);
            background: transparent;
            border: 1px dashed var(--glass-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all var(--dur-fast);
        }
        
        .legend-clear:hover {
            color: var(--text-primary);
            border-color: var(--violet);
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           PHASES
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #phases {
            background: var(--void-purple);
        }
        
        .phases-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .phase-card {
            background: var(--surface-1);
            border: 1px solid var(--glass-border);
            border-radius: 28px;
            padding: var(--space-8);
            margin-bottom: var(--space-7);
            position: relative;
            overflow: hidden;
            transition: all var(--dur-med) var(--ease-out);
        }
        
        .phase-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 32px 64px rgba(0, 0, 0, 0.35);
            border-color: var(--violet);
        }
        
        .phase-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 5px;
        }
        
        .phase-card.saturday::before { background: linear-gradient(90deg, var(--emerald), var(--cyan)); }
        .phase-card.sunday::before { background: linear-gradient(90deg, var(--violet), var(--fuchsia)); }
        .phase-card.monday::before { background: linear-gradient(90deg, var(--orange), var(--amber)); }
        
        .phase-number-bg {
            position: absolute;
            top: -30px; right: -30px;
            font-family: var(--font-display);
            font-size: 14rem;
            font-weight: 700;
            color: var(--surface-2);
            user-select: none;
            pointer-events: none;
        }
        
        .phase-content {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: var(--space-7);
            align-items: start;
        }
        
        .phase-tag {
            display: inline-flex;
            align-items: center;
            gap: var(--space-3);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: var(--space-3) var(--space-4);
            border-radius: 8px;
            margin-bottom: var(--space-5);
        }
        
        .phase-card.saturday .phase-tag { background: rgba(16, 185, 129, 0.2); color: var(--emerald); }
        .phase-card.sunday .phase-tag { background: rgba(139, 92, 246, 0.2); color: var(--violet-light); }
        .phase-card.monday .phase-tag { background: rgba(249, 115, 22, 0.2); color: var(--orange); }
        
        .phase-title {
            font-size: var(--text-3xl);
            font-weight: 700;
            letter-spacing: -0.03em;
            margin-bottom: var(--space-3);
        }
        
        .phase-subtitle {
            font-family: var(--font-mono);
            font-size: var(--text-base);
            color: var(--text-muted);
            margin-bottom: var(--space-6);
        }
        
        .phase-description {
            font-size: var(--text-lg);
            color: var(--text-secondary);
            line-height: 1.9;
            margin-bottom: var(--space-6);
        }
        
        .phase-changes {
            background: var(--surface-2);
            border-radius: 16px;
            padding: var(--space-5);
        }
        
        .changes-title {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: var(--space-4);
        }
        
        .changes-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }
        
        .changes-list li {
            font-size: var(--text-base);
            color: var(--text-secondary);
            padding-left: var(--space-6);
            position: relative;
        }
        
        .changes-list li::before {
            content: '→';
            position: absolute;
            left: 0;
            color: var(--violet);
            font-weight: 600;
        }
        
        .phase-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
        }
        
        .phase-stat-card {
            background: var(--surface-2);
            border-radius: 12px;
            padding: var(--space-4);
            text-align: center;
            transition: all var(--dur-fast);
        }
        
        .phase-stat-card:hover {
            transform: translateY(-2px);
            background: var(--surface-3);
        }
        
        .phase-stat-value {
            font-family: var(--font-mono);
            font-size: var(--text-2xl);
            font-weight: 700;
            line-height: 1;
            margin-bottom: var(--space-2);
        }
        
        .phase-stat-value.add { color: var(--success); }
        .phase-stat-value.del { color: var(--danger); }
        .phase-stat-value.commits {
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .phase-stat-label {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        
        .phase-progress {
            grid-column: span 2;
            background: var(--surface-2);
            border-radius: 14px;
            padding: var(--space-5);
        }
        
        .progress-bar-container {
            height: 10px;
            background: var(--surface-3);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: var(--space-4);
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 5px;
            transition: width 1s var(--ease-out);
        }
        
        .phase-card.saturday .progress-bar { background: linear-gradient(90deg, var(--emerald), var(--cyan)); }
        .phase-card.sunday .progress-bar { background: linear-gradient(90deg, var(--violet), var(--fuchsia)); }
        .phase-card.monday .progress-bar { background: linear-gradient(90deg, var(--orange), var(--amber)); }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            color: var(--text-muted);
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           CATEGORIES
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #categories {
            background: linear-gradient(180deg, var(--void-purple) 0%, var(--void-blue) 100%);
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-6);
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .category-card {
            background: var(--surface-1);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-6);
            position: relative;
            overflow: hidden;
            transition: all var(--dur-med) var(--ease-out);
            cursor: default;
        }
        
        .category-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(
                135deg,
                transparent 0%,
                rgba(255, 255, 255, 0.05) 50%,
                transparent 100%
            );
            background-size: 200% 200%;
            opacity: 0;
            transition: opacity var(--dur-fast);
        }
        
        .category-card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.35);
            border-color: var(--violet);
        }
        
        .category-card:hover::after {
            opacity: 1;
            animation: shimmer 1.2s ease-in-out;
        }
        
        .category-card:hover .category-icon {
            transform: scale(1.1) rotate(5deg);
        }
        
        .category-icon {
            transition: transform var(--dur-med) var(--ease-out);
        }
        
        .category-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
        }
        
        .category-card[data-category="training"]::before { background: var(--color-feature); }
        .category-card[data-category="cleanup"]::before { background: var(--color-refactor); }
        .category-card[data-category="data"]::before { background: var(--cyan); }
        .category-card[data-category="infrastructure"]::before { background: var(--color-chore); }
        .category-card[data-category="apps"]::before { background: var(--fuchsia); }
        .category-card[data-category="documentation"]::before { background: var(--color-docs); }
        .category-card[data-category="security"]::before { background: var(--rose); }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-5);
        }
        
        .category-icon {
            width: 52px; height: 52px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xl);
        }
        
        .category-card[data-category="training"] .category-icon { background: rgba(74, 222, 128, 0.2); }
        .category-card[data-category="cleanup"] .category-icon { background: rgba(167, 139, 250, 0.2); }
        .category-card[data-category="data"] .category-icon { background: rgba(6, 182, 212, 0.2); }
        .category-card[data-category="infrastructure"] .category-icon { background: rgba(96, 165, 250, 0.2); }
        .category-card[data-category="apps"] .category-icon { background: rgba(217, 70, 239, 0.2); }
        .category-card[data-category="documentation"] .category-icon { background: rgba(251, 191, 36, 0.2); }
        .category-card[data-category="security"] .category-icon { background: rgba(244, 63, 94, 0.2); }
        
        .category-count {
            font-family: var(--font-mono);
            font-size: var(--text-2xl);
            font-weight: 700;
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .category-name {
            font-size: var(--text-xl);
            font-weight: 600;
            margin-bottom: var(--space-3);
            text-transform: capitalize;
        }
        
        .category-stats {
            display: flex;
            gap: var(--space-5);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
        }
        
        .category-stats .add { color: var(--success); }
        .category-stats .del { color: var(--danger); }
        
        .category-bar {
            height: 6px;
            background: var(--surface-3);
            border-radius: 3px;
            margin-top: var(--space-5);
            overflow: hidden;
        }
        
        .category-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 1s var(--ease-out);
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           COMMITS
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #commits {
            background: var(--void-blue);
        }
        
        .commits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: var(--space-5);
            max-width: 1300px;
            margin: 0 auto;
        }
        
        .commit-card {
            background: var(--surface-1);
            border: 1px solid var(--glass-border);
            border-radius: 18px;
            padding: var(--space-6);
            transition: all var(--dur-med) var(--ease-out);
            position: relative;
            overflow: hidden;
        }
        
        .commit-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 0;
            background: linear-gradient(180deg, var(--violet), var(--fuchsia));
            transition: height var(--dur-med) var(--ease-out);
            border-radius: 0 0 4px 0;
        }
        
        .commit-card:hover {
            transform: translateY(-4px);
            border-color: var(--violet);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
        }
        
        .commit-card:hover::before {
            height: 100%;
        }
        
        .commit-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-4);
        }
        
        .commit-type {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: var(--space-2) var(--space-4);
            border-radius: 6px;
        }
        
        .commit-type.feature { background: rgba(74, 222, 128, 0.2); color: var(--color-feature); }
        .commit-type.fix { background: rgba(248, 113, 113, 0.2); color: var(--color-fix); }
        .commit-type.refactor { background: rgba(167, 139, 250, 0.2); color: var(--color-refactor); }
        .commit-type.chore { background: rgba(96, 165, 250, 0.2); color: var(--color-chore); }
        .commit-type.docs { background: rgba(251, 191, 36, 0.2); color: var(--color-docs); }
        .commit-type.other { background: rgba(148, 163, 184, 0.2); color: var(--color-other); }
        
        .commit-hash {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-dim);
            padding: var(--space-2) var(--space-3);
            background: var(--surface-2);
            border-radius: 6px;
        }
        
        .commit-message {
            font-size: var(--text-base);
            color: var(--text-primary);
            line-height: 1.6;
            margin-bottom: var(--space-5);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .commit-stats {
            display: flex;
            gap: var(--space-5);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
        }
        
        .commit-stat.add { color: var(--success); }
        .commit-stat.del { color: var(--danger); }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: var(--space-3);
            margin-top: var(--space-9);
        }
        
        .page-btn {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            font-weight: 600;
            padding: var(--space-3) var(--space-5);
            background: var(--surface-1);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
            border-radius: 10px;
            cursor: pointer;
            transition: all var(--dur-fast);
        }
        
        .page-btn:hover {
            background: var(--surface-2);
            color: var(--text-primary);
            border-color: var(--violet);
        }
        
        .page-btn.active {
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            color: white;
            border-color: transparent;
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           3D VISUALIZATION - MEANINGFUL COMMIT LANDSCAPE
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #visualization {
            background: var(--void);
            min-height: 100vh;
            position: relative;
        }
        
        #canvas-container {
            width: 100%;
            height: 100vh;
            position: relative;
        }
        
        #vizCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .viz-header {
            position: absolute;
            top: var(--space-8);
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 10;
        }
        
        .viz-legend {
            position: absolute;
            bottom: var(--space-8);
            left: var(--space-8);
            z-index: 10;
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-6);
        }
        
        .viz-legend-title {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: var(--space-5);
        }
        
        .viz-legend-items {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }
        
        .viz-legend-row {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }
        
        .viz-legend-dot {
            width: 14px; height: 14px;
            border-radius: 50%;
        }
        
        .viz-axes {
            position: absolute;
            bottom: var(--space-8);
            right: var(--space-8);
            z-index: 10;
            background: var(--glass-bg);
            backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: var(--space-5);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-muted);
        }
        
        .viz-axes strong {
            color: var(--violet-light);
        }
        
        /* Commit detail tooltip */
        #commit-tooltip {
            position: fixed;
            z-index: 1000;
            background: var(--surface-3);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: var(--space-5);
            max-width: 400px;
            pointer-events: none;
            opacity: 0;
            transition: opacity var(--dur-fast);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.5);
        }
        
        #commit-tooltip.visible { opacity: 1; }
        
        .tooltip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-3);
        }
        
        .tooltip-type {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: var(--space-1) var(--space-3);
            border-radius: 4px;
        }
        
        .tooltip-hash {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-dim);
        }
        
        .tooltip-message {
            font-size: var(--text-base);
            color: var(--text-primary);
            line-height: 1.5;
            margin-bottom: var(--space-4);
        }
        
        .tooltip-stats {
            display: flex;
            gap: var(--space-5);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
        }
        
        .tooltip-stats .add { color: var(--success); }
        .tooltip-stats .del { color: var(--danger); }

        /* ═══════════════════════════════════════════════════════════════════════════
           SUMMARY
           ═══════════════════════════════════════════════════════════════════════════ */
        
        #summary {
            background: linear-gradient(180deg, var(--void) 0%, var(--void-purple) 50%, var(--void) 100%);
            position: relative;
            overflow: hidden;
        }
        
        #summary::before {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 1000px; height: 1000px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.15), transparent 70%);
            pointer-events: none;
        }
        
        .summary-container {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        .summary-text {
            font-size: var(--text-xl);
            color: var(--text-secondary);
            line-height: 2;
            margin-bottom: var(--space-6);
            text-align: center;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-6);
            margin: var(--space-10) 0;
        }
        
        .summary-stat {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: var(--space-7);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .summary-stat::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--violet), var(--fuchsia));
        }
        
        .summary-stat-value {
            font-family: var(--font-mono);
            font-size: var(--text-3xl);
            font-weight: 700;
            line-height: 1;
            margin-bottom: var(--space-3);
            background: linear-gradient(135deg, var(--text-primary), var(--violet-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .summary-stat-label {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
        }
        
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-5);
            margin-top: var(--space-9);
        }
        
        .tech-card {
            background: var(--surface-1);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: var(--space-6);
            display: flex;
            align-items: center;
            gap: var(--space-5);
            transition: all var(--dur-med) var(--ease-out);
        }
        
        .tech-card:hover {
            transform: translateY(-4px);
            border-color: var(--violet);
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.3);
        }
        
        .tech-card:hover .tech-icon {
            transform: scale(1.1) rotate(5deg);
        }
        
        .tech-icon {
            transition: transform var(--dur-med) var(--ease-out);
        }
        
        .tech-icon {
            width: 56px; height: 56px;
            background: linear-gradient(135deg, var(--violet), var(--fuchsia));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xl);
            flex-shrink: 0;
        }
        
        .tech-label {
            font-family: var(--font-mono);
            font-size: var(--text-xs);
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: var(--space-2);
        }
        
        .tech-value {
            font-size: var(--text-xl);
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .summary-footer {
            text-align: center;
            margin-top: var(--space-10);
            padding-top: var(--space-8);
            border-top: 1px solid var(--glass-border);
        }
        
        .footer-text {
            font-family: var(--font-mono);
            font-size: var(--text-base);
            color: var(--text-muted);
            letter-spacing: 0.05em;
        }

        /* ═══════════════════════════════════════════════════════════════════════════
           RESPONSIVE
           ═══════════════════════════════════════════════════════════════════════════ */
        
        @media (max-width: 1024px) {
            html { font-size: 16px; }
            .phase-content { grid-template-columns: 1fr; }
            .phase-stats { 
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: var(--space-3);
            }
            .phase-progress {
                grid-column: span 4;
            }
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            html { font-size: 15px; }
            section { padding: var(--space-8) var(--space-5); }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .timeline-viz { flex-direction: column; }
            .timeline-labels { 
                flex-direction: row;
                width: 100%;
                justify-content: space-around;
                padding: var(--space-3) 0;
            }
            .timeline-label { 
                border-right: none;
                text-align: center;
                padding-right: 0;
                font-size: var(--text-xs);
            }
            .timeline-label::after { display: none; }
            .timeline-bars { height: 400px; }
            .view-controls {
                flex-wrap: wrap;
                padding: var(--space-3);
                gap: var(--space-2);
            }
            .view-label { 
                width: 100%; 
                text-align: center;
                margin-right: 0;
                margin-bottom: var(--space-2);
            }
            .view-btn {
                padding: var(--space-2) var(--space-4);
                font-size: var(--text-xs);
            }
            .view-btn-icon { display: none; }
            .commits-grid { grid-template-columns: 1fr; }
            .summary-stats { grid-template-columns: repeat(2, 1fr); }
            .tech-grid { grid-template-columns: 1fr; }
            .phase-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            .phase-stat-card:first-child {
                grid-column: span 2;
            }
            .phase-progress {
                grid-column: span 2;
            }
            .categories-grid {
                grid-template-columns: 1fr;
            }
            .timeline-legend {
                flex-wrap: wrap;
                justify-content: center;
                gap: var(--space-2);
            }
            .legend-item {
                font-size: var(--text-xs);
                padding: var(--space-2) var(--space-3);
            }
            .viz-legend,
            .viz-axes {
                display: none;
            }
        }
        
        @media (max-width: 480px) {
            html { font-size: 14px; }
            .hero-title {
                font-size: clamp(2.5rem, 15vw, 4rem);
            }
            .stats-grid { 
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }
            .stat-card {
                padding: var(--space-4);
            }
            .context-card {
                padding: var(--space-5);
            }
            .phase-card {
                padding: var(--space-5);
            }
        }
    </style>
</head>
<body>
    <div class="scroll-progress" id="scrollProgress"></div>
    <header id="hero">
        <div class="hero-bg"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="grid-lines"></div>
        
        <div class="hero-content">
            <div class="hero-badge animate-in">
                <span class="badge-dot"></span>
                <span>Codebase Transformation · January 2026</span>
            </div>
            
            <h1 class="hero-title animate-in delay-1">Weekend<br>Metamorphosis</h1>
            
            <p class="hero-subtitle animate-in delay-2">
                <strong>165 commits</strong> in <strong>53 hours</strong> — a complete transformation
            </p>
            
            <div class="stats-grid animate-in delay-3">
                <div class="stat-card">
                    <div class="stat-value neutral" data-count="165">0</div>
                    <div class="stat-label">Commits</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value positive" data-count="333" data-suffix="K" data-prefix="+">0</div>
                    <div class="stat-label">Additions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value negative" data-count="509" data-suffix="K" data-prefix="−">0</div>
                    <div class="stat-label">Deletions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value negative" data-count="176" data-suffix="K" data-prefix="−">0</div>
                    <div class="stat-label">Net Change</div>
                </div>
            </div>
            
            <div class="context-card animate-in delay-4">
                <div class="context-header">
                    <div class="context-icon">📋</div>
                    <div class="context-title">Context</div>
                </div>
                <p class="context-text">
                    Repository reset to clean state on Friday evening. The initial <code>clean init</code> commit 
                    established a 1.79M line foundation. Over 53 hours: framework migration 
                    (PyTorch → JAX/TPU), training pipeline completion, and codebase consolidation. 
                    Net result: 176K lines removed through intentional pruning.
                </p>
            </div>
        </div>
        
        <div class="scroll-hint animate-in delay-4">
            <div class="scroll-mouse"></div>
            <span>Scroll to explore</span>
        </div>
    </header>

    <main>
        <section id="timeline">
            <div class="section-header">
                <div class="section-number">01 · TIMELINE</div>
                <h2 class="section-title">Commit Distribution</h2>
                <p class="section-description">
                    165 commits visualized chronologically. Bar height = lines changed. Color = commit type.
                </p>
            </div>
            
            <div class="timeline-wrapper">
                <!-- View controls INSIDE timeline, sticky -->
                <div class="view-controls">
                    <span class="view-label">Color by</span>
                    <button class="view-btn active" data-mode="type"><span><span class="view-btn-icon">🏷️</span>Category</span></button>
                    <button class="view-btn" data-mode="change"><span><span class="view-btn-icon">±</span>Net Change</span></button>
                </div>
                
                <div class="timeline-viz">
                    <div class="timeline-labels">
                        <div class="timeline-label">Monday</div>
                        <div class="timeline-label">Sunday PM</div>
                        <div class="timeline-label">Sunday AM</div>
                        <div class="timeline-label">Saturday</div>
                    </div>
                    
                    <div class="timeline-bars-container">
                        <div class="timeline-bars" id="timelineBars"></div>
                    </div>
                </div>
                
                <div class="timeline-legend" id="timelineLegend"></div>
            </div>
        </section>

        <section id="phases">
            <div class="section-header">
                <div class="section-number">02 · PHASES</div>
                <h2 class="section-title">Day by Day</h2>
                <p class="section-description">
                    The transformation unfolded across three days, each with distinct focus and achievements.
                </p>
            </div>
            
            <div class="phases-container" id="phasesContainer"></div>
        </section>

        <section id="categories">
            <div class="section-header">
                <div class="section-number">03 · ANALYSIS</div>
                <h2 class="section-title">Work Categories</h2>
                <p class="section-description">
                    Commits categorized by primary area of work, based on commit message analysis.
                </p>
            </div>
            
            <div class="categories-grid" id="categoriesGrid"></div>
        </section>

        <section id="commits">
            <div class="section-header">
                <div class="section-number">04 · COMMITS</div>
                <h2 class="section-title">All Changes</h2>
                <p class="section-description">
                    Browse all 165 commits with type classification, message, and line counts.
                </p>
            </div>
            
            <div class="commits-grid" id="commitsGrid"></div>
            <div class="pagination" id="pagination"></div>
        </section>

        <section id="visualization">
            <div id="canvas-container">
                <canvas id="vizCanvas"></canvas>
                
                <div class="viz-header">
                    <div class="section-number">05 · LANDSCAPE</div>
                    <h2 class="section-title" style="color: var(--text-primary)">Commit Terrain</h2>
                    <p class="section-description" style="color: var(--text-secondary)">
                        Each commit as a point in 3D space. X = time, Y = magnitude, Z = category depth.
                    </p>
                </div>
                
                <div class="viz-legend">
                    <div class="viz-legend-title">Commit Type</div>
                    <div class="viz-legend-items">
                        <div class="viz-legend-row">
                            <span class="viz-legend-dot" style="background: var(--color-feature);"></span>
                            <span>Feature</span>
                        </div>
                        <div class="viz-legend-row">
                            <span class="viz-legend-dot" style="background: var(--color-fix);"></span>
                            <span>Fix</span>
                        </div>
                        <div class="viz-legend-row">
                            <span class="viz-legend-dot" style="background: var(--color-refactor);"></span>
                            <span>Refactor</span>
                        </div>
                        <div class="viz-legend-row">
                            <span class="viz-legend-dot" style="background: var(--color-chore);"></span>
                            <span>Chore</span>
                        </div>
                        <div class="viz-legend-row">
                            <span class="viz-legend-dot" style="background: var(--color-other);"></span>
                            <span>Other</span>
                        </div>
                    </div>
                </div>
                
                <div class="viz-axes">
                    <div><strong>X</strong> → Time (chronological)</div>
                    <div><strong>Y</strong> → Lines changed (log)</div>
                    <div><strong>Z</strong> → Category layer</div>
                </div>
            </div>
        </section>

        <section id="summary">
            <div class="summary-container">
                <div class="section-header">
                    <div class="section-number">06 · SUMMARY</div>
                    <h2 class="section-title">Technical Overview</h2>
                </div>
                
                <p class="summary-text">
                    Over 53 hours, the codebase underwent complete transformation: migrating the training 
                    framework from PyTorch to JAX/TPU, implementing a complete ML pipeline with 18 data loaders 
                    covering 11 training phases, and consolidating the codebase through strategic pruning.
                </p>
                
                <p class="summary-text">
                    The net deletion of 176K lines reflects intentional refinement — removing legacy PyTorch code, 
                    deleting 30+ empty stub files, and consolidating duplicate patterns.
                </p>
                
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-value" data-count="165">0</div>
                        <div class="summary-stat-label">Commits</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" data-count="53" data-suffix="h">0</div>
                        <div class="summary-stat-label">Duration</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" data-count="3">0</div>
                        <div class="summary-stat-label">Days</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" data-count="7">0</div>
                        <div class="summary-stat-label">Categories</div>
                    </div>
                </div>
                
                <div class="tech-grid">
                    <div class="tech-card">
                        <div class="tech-icon">🔄</div>
                        <div>
                            <div class="tech-label">Framework Migration</div>
                            <div class="tech-value">PyTorch → JAX/TPU</div>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">📊</div>
                        <div>
                            <div class="tech-label">Data Loaders</div>
                            <div class="tech-value">18 × 11 phases</div>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">🧠</div>
                        <div>
                            <div class="tech-label">Gradient Layers</div>
                            <div class="tech-value">112/112 healthy</div>
                        </div>
                    </div>
                    <div class="tech-card">
                        <div class="tech-icon">🗑️</div>
                        <div>
                            <div class="tech-label">Cleanup</div>
                            <div class="tech-value">30+ stubs removed</div>
                        </div>
                    </div>
                </div>
                
                <div class="summary-footer">
                    <p class="footer-text">Weekend Metamorphosis · January 17–20, 2026</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Tooltip for 3D viz -->
    <div id="commit-tooltip">
        <div class="tooltip-header">
            <span class="tooltip-type"></span>
            <span class="tooltip-hash"></span>
        </div>
        <div class="tooltip-message"></div>
        <div class="tooltip-stats">
            <span class="add"></span>
            <span class="del"></span>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <script>
        let commitsData = null;
        let metricsData = null;
        let narrativeData = null;
        let currentMode = 'type';
        let currentPage = 1;
        const COMMITS_PER_PAGE = 12;
        let scene, camera, renderer, particles, raycaster, mouse;
        let commitObjects = [];
        let hoveredCommit = null;
        
        async function loadData() {
            try {
                const [commits, metrics, narrative] = await Promise.all([
                    fetch('data/commits.json').then(r => r.json()),
                    fetch('data/metrics.json').then(r => r.json()),
                    fetch('data/narrative.json').then(r => r.json())
                ]);
                
                commitsData = commits;
                metricsData = metrics;
                narrativeData = narrative;
                
                renderAll();
                initAnimations();
            } catch (err) {
                console.error('Data load failed:', err);
            }
        }
        
        function formatNumber(n, prefix = '', suffix = '') {
            if (Math.abs(n) >= 1000000) return prefix + (n / 1000000).toFixed(1) + 'M' + suffix;
            if (Math.abs(n) >= 1000) return prefix + Math.round(n / 1000) + 'K' + suffix;
            return prefix + n.toLocaleString() + suffix;
        }
        
        function getCategoryColor(category) {
            const colors = {
                'Feature': 'var(--color-feature)',
                'Fix': 'var(--color-fix)',
                'Refactor': 'var(--color-refactor)',
                'Chore': 'var(--color-chore)',
                'Docs': 'var(--color-docs)',
                'Other': 'var(--color-other)'
            };
            return colors[category] || 'var(--color-other)';
        }
        
        function getCategoryHex(category) {
            const colors = {
                'Feature': 0x4ade80,
                'Fix': 0xf87171,
                'Refactor': 0xa78bfa,
                'Chore': 0x60a5fa,
                'Docs': 0xfbbf24,
                'Other': 0x94a3b8
            };
            return colors[category] || 0x94a3b8;
        }
        
        function getCategoryZ(category) {
            const layers = { 'Feature': 0, 'Fix': 1, 'Refactor': 2, 'Chore': 3, 'Docs': 4, 'Other': 5 };
            return layers[category] !== undefined ? layers[category] : 5;
        }
        
        // Global state for filtering
        let activeFilter = null;
        let barTooltip = null;
        
        // TIMELINE
        function renderTimeline() {
            const container = document.getElementById('timelineBars');
            const legend = document.getElementById('timelineLegend');
            if (!commitsData) return;

            const commits = [...commitsData.commits].reverse();
            const changes = commits.map(c => Math.log1p(c.additions + c.deletions));
            const maxChange = Math.max(...changes);

            container.innerHTML = commits.map((commit, i) => {
                const color = getCategoryColor(commit.category);
                const change = Math.log1p(commit.additions + commit.deletions);
                const normalized = change / maxChange;
                const height = 2 + normalized * 8;

                return `
                    <div class="timeline-bar"
                         style="background: ${color}; flex: 0 0 ${height}px;"
                         data-index="${commits.length - 1 - i}"
                         data-category="${commit.category}"
                         data-hash="${commit.shortHash}"
                         data-msg="${commit.subject.replace(/"/g, '&quot;')}"
                         data-add="${commit.additions}"
                         data-del="${commit.deletions}">
                    </div>
                `;
            }).join('');
            
            // Create floating tooltip element
            if (!barTooltip) {
                barTooltip = document.createElement('div');
                barTooltip.className = 'bar-tooltip';
                document.body.appendChild(barTooltip);
            }
            
            // Add hover events for smart tooltip positioning
            container.querySelectorAll('.timeline-bar').forEach(bar => {
                bar.addEventListener('mouseenter', showBarTooltip);
                bar.addEventListener('mousemove', updateTooltipPosition);
                bar.addEventListener('mouseleave', hideBarTooltip);
            });

            const counts = {};
            commitsData.commits.forEach(c => { counts[c.category] = (counts[c.category] || 0) + 1; });

            legend.innerHTML = Object.entries(counts)
                .sort((a, b) => b[1] - a[1])
                .map(([cat, count]) => `
                    <div class="legend-item" data-filter="${cat}">
                        <span class="legend-swatch" style="background: ${getCategoryColor(cat)};"></span>
                        <span>${cat} <strong>${count}</strong></span>
                    </div>
                `).join('') + `<button class="legend-clear" style="display: none;">Clear filter</button>`;
            
            // Add legend click handlers for filtering
            legend.querySelectorAll('.legend-item').forEach(item => {
                item.addEventListener('click', () => toggleFilter(item.dataset.filter));
            });
            
            legend.querySelector('.legend-clear').addEventListener('click', clearFilter);
        }
        
        function showBarTooltip(e) {
            const bar = e.target;
            const shortMsg = bar.dataset.msg.substring(0, 60) + (bar.dataset.msg.length > 60 ? '…' : '');
            
            barTooltip.innerHTML = `
                <div class="bar-tooltip-hash">${bar.dataset.hash}</div>
                <div class="bar-tooltip-msg">${shortMsg}</div>
                <div class="bar-tooltip-stats">
                    <span class="add">+${formatNumber(parseInt(bar.dataset.add))}</span>
                    <span class="del">−${formatNumber(parseInt(bar.dataset.del))}</span>
                </div>
            `;
            barTooltip.classList.add('visible');
            updateTooltipPosition(e);
        }
        
        function updateTooltipPosition(e) {
            const padding = 15;
            const tooltipRect = barTooltip.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            let left = e.clientX + padding;
            let top = e.clientY;
            
            // Check right edge
            if (left + tooltipRect.width > viewportWidth - padding) {
                left = e.clientX - tooltipRect.width - padding;
            }
            
            // Check bottom edge
            if (top + tooltipRect.height / 2 > viewportHeight - padding) {
                top = viewportHeight - tooltipRect.height / 2 - padding;
            }
            
            // Check top edge
            if (top - tooltipRect.height / 2 < padding) {
                top = tooltipRect.height / 2 + padding;
            }
            
            barTooltip.style.left = left + 'px';
            barTooltip.style.top = top + 'px';
        }
        
        function hideBarTooltip() {
            barTooltip.classList.remove('visible');
        }
        
        function toggleFilter(category) {
            const legend = document.getElementById('timelineLegend');
            const clearBtn = legend.querySelector('.legend-clear');
            
            if (activeFilter === category) {
                clearFilter();
                return;
            }
            
            activeFilter = category;
            
            // Update legend items
            legend.querySelectorAll('.legend-item').forEach(item => {
                if (item.dataset.filter === category) {
                    item.classList.add('active');
                    item.classList.remove('dimmed');
                } else {
                    item.classList.remove('active');
                    item.classList.add('dimmed');
                }
            });
            
            // Update timeline bars
            document.querySelectorAll('.timeline-bar').forEach(bar => {
                if (bar.dataset.category === category) {
                    bar.classList.remove('dimmed');
                    bar.classList.add('highlighted');
                } else {
                    bar.classList.add('dimmed');
                    bar.classList.remove('highlighted');
                }
            });
            
            clearBtn.style.display = 'block';
        }
        
        function clearFilter() {
            activeFilter = null;
            const legend = document.getElementById('timelineLegend');
            const clearBtn = legend.querySelector('.legend-clear');
            
            legend.querySelectorAll('.legend-item').forEach(item => {
                item.classList.remove('active', 'dimmed');
            });
            
            document.querySelectorAll('.timeline-bar').forEach(bar => {
                bar.classList.remove('dimmed', 'highlighted');
            });
            
            clearBtn.style.display = 'none';
        }
        
        // PHASES
        function renderPhases() {
            const container = document.getElementById('phasesContainer');
            if (!narrativeData) return;

            const dayIcons = { 1: '🌅', 2: '☀️', 3: '🌙' };
            const dayClasses = { 1: 'saturday', 2: 'sunday', 3: 'monday' };
            const dayStats = metricsData?.byDay || {};
            
            container.innerHTML = narrativeData.acts.map(act => {
                const dayClass = dayClasses[act.number] || 'saturday';
                const stats = dayStats[act.title] || { commits: act.commitCount, additions: act.additions, deletions: act.deletions };
                const totalCommits = commitsData?.commits?.length || 165;
                const progress = Math.round((stats.commits / totalCommits) * 100);
                const net = (stats.additions || act.additions) - (stats.deletions || act.deletions);
                const netFormatted = net >= 0 ? '+' + formatNumber(net) : '−' + formatNumber(Math.abs(net));
                const netClass = net >= 0 ? 'add' : 'del';
                
                return `
                    <div class="phase-card ${dayClass}">
                        <div class="phase-number-bg">${String(act.number).padStart(2, '0')}</div>
                        <div class="phase-content">
                            <div class="phase-main">
                                <div class="phase-tag">${dayIcons[act.number] || '📅'} Day ${act.number} · ${act.subtitle || ''}</div>
                                <h3 class="phase-title">${act.title}</h3>
                                <p class="phase-description">${act.summary}</p>
                                ${act.keyChanges ? `
                                <div class="phase-changes">
                                    <div class="changes-title">Key Changes</div>
                                    <ul class="changes-list">
                                        ${act.keyChanges.map(c => `<li>${c}</li>`).join('')}
                                    </ul>
                                </div>
                                ` : ''}
                            </div>
                            <div class="phase-stats">
                                <div class="phase-stat-card">
                                    <div class="phase-stat-value commits">${stats.commits || act.commitCount}</div>
                                    <div class="phase-stat-label">Commits</div>
                                </div>
                                <div class="phase-stat-card">
                                    <div class="phase-stat-value add">${formatNumber(stats.additions || act.additions, '+')}</div>
                                    <div class="phase-stat-label">Added</div>
                                </div>
                                <div class="phase-stat-card">
                                    <div class="phase-stat-value del">${formatNumber(stats.deletions || act.deletions, '−')}</div>
                                    <div class="phase-stat-label">Deleted</div>
                                </div>
                                <div class="phase-stat-card">
                                    <div class="phase-stat-value ${netClass}">${netFormatted}</div>
                                    <div class="phase-stat-label">Net</div>
                                </div>
                                <div class="phase-progress">
                                    <div class="progress-bar-container">
                                        <div class="progress-bar" style="width: ${progress}%"></div>
                                    </div>
                                    <div class="progress-labels">
                                        <span>${progress}% of total commits</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // CATEGORIES
        function renderCategories() {
            const grid = document.getElementById('categoriesGrid');
            if (!narrativeData || !narrativeData.workCategories) return;

            const icons = {
                training: '🚀', cleanup: '🧹', data: '📊',
                infrastructure: '🏗️', apps: '📱', documentation: '📝', security: '🔐'
            };
            const maxCommits = Math.max(...Object.values(narrativeData.workCategories).map(c => c.commits));

            grid.innerHTML = Object.entries(narrativeData.workCategories)
                .sort((a, b) => b[1].commits - a[1].commits)
                .map(([name, data]) => {
                    const barWidth = (data.commits / maxCommits) * 100;
                    return `
                        <div class="category-card" data-category="${name}">
                            <div class="category-header">
                                <div class="category-icon">${icons[name] || '📦'}</div>
                                <div class="category-count">${data.commits}</div>
                            </div>
                            <div class="category-name">${name}</div>
                            <div class="category-stats">
                                <span class="add">${formatNumber(data.additions, '+')}</span>
                                <span class="del">${formatNumber(data.deletions, '−')}</span>
                            </div>
                            <div class="category-bar">
                                <div class="category-bar-fill" style="width: ${barWidth}%; background: linear-gradient(90deg, var(--violet), var(--fuchsia));"></div>
                            </div>
                        </div>
                    `;
                }).join('');
        }
        
        // COMMITS
        function renderCommits() {
            const grid = document.getElementById('commitsGrid');
            if (!commitsData) return;
            
            const start = (currentPage - 1) * COMMITS_PER_PAGE;
            const items = commitsData.commits.slice(start, start + COMMITS_PER_PAGE);
            
            grid.innerHTML = items.map(commit => `
                <div class="commit-card">
                    <div class="commit-header">
                        <span class="commit-type ${commit.category.toLowerCase()}">${commit.category}</span>
                        <span class="commit-hash">${commit.shortHash}</span>
                    </div>
                    <p class="commit-message">${commit.subject}</p>
                    <div class="commit-stats">
                        <span class="commit-stat add">+${formatNumber(commit.additions)}</span>
                        <span class="commit-stat del">−${formatNumber(commit.deletions)}</span>
                    </div>
                </div>
            `).join('');
            
            renderPagination();
        }
        
        function renderPagination() {
            const container = document.getElementById('pagination');
            const totalPages = Math.ceil(commitsData.commits.length / COMMITS_PER_PAGE);
            
            let buttons = '';
            for (let i = 1; i <= Math.min(totalPages, 8); i++) {
                buttons += `<button class="page-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
            }
            if (totalPages > 8) {
                buttons += `<button class="page-btn" data-page="${totalPages}">${totalPages}</button>`;
            }
            
            container.innerHTML = buttons;
            container.querySelectorAll('.page-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentPage = parseInt(btn.dataset.page);
                    renderCommits();
                    document.getElementById('commits').scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
        }
        
        // 3D VISUALIZATION - MEANINGFUL COMMIT LANDSCAPE
        function init3D() {
            const canvas = document.getElementById('vizCanvas');
            const container = document.getElementById('canvas-container');
            
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0f0a1e);
            scene.fog = new THREE.FogExp2(0x0f0a1e, 0.12);
            
            camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 100);
            camera.position.set(8, 4, 10);
            camera.lookAt(0, 1, 0);
            
            renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            
            raycaster = new THREE.Raycaster();
            raycaster.params.Points.threshold = 0.15;
            mouse = new THREE.Vector2();
            
            // Create meaningful visualization
            createCommitLandscape();
            createAxesHelpers();
            
            // Controls
            let isDragging = false;
            let previousMousePosition = { x: 0, y: 0 };
            
            container.addEventListener('mousedown', (e) => {
                isDragging = true;
                previousMousePosition = { x: e.clientX, y: e.clientY };
            });
            
            container.addEventListener('mouseup', () => isDragging = false);
            container.addEventListener('mouseleave', () => isDragging = false);
            
            container.addEventListener('mousemove', (e) => {
                const rect = container.getBoundingClientRect();
                mouse.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
                
                if (isDragging) {
                    const deltaMove = {
                        x: e.clientX - previousMousePosition.x,
                        y: e.clientY - previousMousePosition.y
                    };
                    
                    const rotationSpeed = 0.005;
                    scene.rotation.y += deltaMove.x * rotationSpeed;
                    
                    previousMousePosition = { x: e.clientX, y: e.clientY };
                }
                
                checkHover(e);
            });
            
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                camera.position.z += e.deltaY * 0.01;
                camera.position.z = Math.max(5, Math.min(20, camera.position.z));
            });
            
            animate();
            
            window.addEventListener('resize', () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        }
        
        function createCommitLandscape() {
            if (!commitsData) return;
            
            const commits = commitsData.commits;
            const geometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];
            const sizes = [];
            
            // Calculate ranges
            const magnitudes = commits.map(c => Math.log1p(c.additions + c.deletions));
            const maxMag = Math.max(...magnitudes);
            
            // Position commits meaningfully:
            // X = time (index / total) * 10 - 5 (centered)
            // Y = magnitude (log lines changed) scaled
            // Z = category layer
            
            commits.forEach((commit, i) => {
                const x = (i / commits.length) * 12 - 6;  // Time: -6 to +6
                const y = (magnitudes[i] / maxMag) * 5;    // Magnitude: 0 to 5
                const z = getCategoryZ(commit.category) * 0.8 - 2;  // Category layers: -2 to +2
                
                positions.push(x, y, z);
                
                const color = new THREE.Color(getCategoryHex(commit.category));
                colors.push(color.r, color.g, color.b);
                
                const size = 0.15 + (magnitudes[i] / maxMag) * 0.25;
                sizes.push(size);
                
                commitObjects.push({ commit, position: new THREE.Vector3(x, y, z) });
            });
            
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
            geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1));
            
            const material = new THREE.ShaderMaterial({
                uniforms: { time: { value: 0 } },
                vertexShader: `
                    attribute float size;
                    varying vec3 vColor;
                    uniform float time;
                    void main() {
                        vColor = color;
                        vec3 pos = position;
                        pos.y += sin(time * 0.5 + position.x * 0.3) * 0.05;
                        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
                        gl_PointSize = size * (400.0 / -mvPosition.z);
                        gl_Position = projectionMatrix * mvPosition;
                    }
                `,
                fragmentShader: `
                    varying vec3 vColor;
                    void main() {
                        float dist = length(gl_PointCoord - vec2(0.5));
                        if (dist > 0.5) discard;
                        float alpha = 1.0 - smoothstep(0.15, 0.5, dist);
                        float glow = exp(-dist * 4.0) * 0.6;
                        gl_FragColor = vec4(vColor + glow * 0.5, alpha);
                    }
                `,
                transparent: true,
                vertexColors: true,
                blending: THREE.AdditiveBlending,
                depthWrite: false
            });
            
            particles = new THREE.Points(geometry, material);
            scene.add(particles);
            
            // Add ground plane for reference
            const groundGeom = new THREE.PlaneGeometry(14, 6);
            const groundMat = new THREE.MeshBasicMaterial({ 
                color: 0x1a1432, 
                side: THREE.DoubleSide,
                transparent: true,
                opacity: 0.3
            });
            const ground = new THREE.Mesh(groundGeom, groundMat);
            ground.rotation.x = Math.PI / 2;
            ground.position.y = -0.1;
            scene.add(ground);
            
            // Grid lines on ground
            const gridHelper = new THREE.GridHelper(14, 14, 0x8b5cf6, 0x2d2454);
            gridHelper.position.y = 0;
            scene.add(gridHelper);
        }
        
        function createAxesHelpers() {
            // Time axis (X)
            const timeAxisGeom = new THREE.BufferGeometry().setFromPoints([
                new THREE.Vector3(-6, 0, -3),
                new THREE.Vector3(6, 0, -3)
            ]);
            const timeAxis = new THREE.Line(timeAxisGeom, new THREE.LineBasicMaterial({ color: 0x8b5cf6, linewidth: 2 }));
            scene.add(timeAxis);
            
            // Magnitude axis (Y)
            const magAxisGeom = new THREE.BufferGeometry().setFromPoints([
                new THREE.Vector3(-6, 0, -3),
                new THREE.Vector3(-6, 5, -3)
            ]);
            const magAxis = new THREE.Line(magAxisGeom, new THREE.LineBasicMaterial({ color: 0x4ade80, linewidth: 2 }));
            scene.add(magAxis);
        }
        
        function checkHover(event) {
            if (!particles) return;
            
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(particles);
            
            const tooltip = document.getElementById('commit-tooltip');
            
            if (intersects.length > 0) {
                const idx = intersects[0].index;
                const commit = commitsData.commits[idx];
                
                if (commit) {
                    tooltip.querySelector('.tooltip-type').textContent = commit.category;
                    tooltip.querySelector('.tooltip-type').className = 'tooltip-type commit-type ' + commit.category.toLowerCase();
                    tooltip.querySelector('.tooltip-hash').textContent = commit.shortHash;
                    tooltip.querySelector('.tooltip-message').textContent = commit.subject;
                    tooltip.querySelector('.add').textContent = '+' + formatNumber(commit.additions);
                    tooltip.querySelector('.del').textContent = '−' + formatNumber(commit.deletions);
                    
                    // Smart positioning for 3D tooltip
                    const padding = 20;
                    const tooltipRect = tooltip.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    
                    let left = event.clientX + padding;
                    let top = event.clientY - padding;
                    
                    // Check right edge
                    if (left + tooltipRect.width > viewportWidth - padding) {
                        left = event.clientX - tooltipRect.width - padding;
                    }
                    
                    // Check bottom edge
                    if (top + tooltipRect.height > viewportHeight - padding) {
                        top = viewportHeight - tooltipRect.height - padding;
                    }
                    
                    // Check top edge
                    if (top < padding) {
                        top = padding;
                    }
                    
                    tooltip.style.left = left + 'px';
                    tooltip.style.top = top + 'px';
                    tooltip.classList.add('visible');
                    
                    document.body.style.cursor = 'pointer';
                }
            } else {
                tooltip.classList.remove('visible');
                document.body.style.cursor = 'default';
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (particles) {
                particles.material.uniforms.time.value = performance.now() * 0.001;
            }
            
            renderer.render(scene, camera);
        }
        
        // VIEW MODE SWITCHING
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMode = btn.dataset.mode;
                updateViewMode();
            });
        });
        
        function updateViewMode() {
            if (!commitsData) return;
            
            const commits = commitsData.commits;
            const bars = document.querySelectorAll('.timeline-bar');
            const reversedCommits = [...commits].reverse();
            
            bars.forEach((bar, i) => {
                const commit = reversedCommits[i];
                if (!commit) return;
                
                let color;
                switch(currentMode) {
                    case 'type':
                        color = getCategoryColor(commit.category);
                        break;
                    case 'change':
                        const net = commit.additions - commit.deletions;
                        color = net > 0 ? 'var(--color-feature)' : 'var(--color-fix)';
                        break;
                    default:
                        color = getCategoryColor(commit.category);
                }
                bar.style.background = color;
            });
        }
        
        // ANIMATIONS
        function initAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const counters = entry.target.querySelectorAll('[data-count]');
                        counters.forEach(counter => {
                            if (counter.dataset.animated) return;
                            counter.dataset.animated = 'true';
                            
                            const target = parseInt(counter.dataset.count);
                            const prefix = counter.dataset.prefix || '';
                            const suffix = counter.dataset.suffix || '';
                            const duration = 1500;
                            const startTime = performance.now();
                            
                            function update(currentTime) {
                                const elapsed = currentTime - startTime;
                                const progress = Math.min(elapsed / duration, 1);
                                const easeOut = 1 - Math.pow(1 - progress, 3);
                                const current = Math.floor(target * easeOut);
                                counter.textContent = prefix + current.toLocaleString() + suffix;
                                if (progress < 1) requestAnimationFrame(update);
                            }
                            
                            requestAnimationFrame(update);
                        });
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.3 });
            
            document.querySelectorAll('.stats-grid, .summary-stats').forEach(el => observer.observe(el));
            
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });
            
            document.querySelectorAll('section').forEach(section => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(40px)';
                section.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
                revealObserver.observe(section);
            });
        }
        
        function renderAll() {
            renderTimeline();
            renderPhases();
            renderCategories();
            renderCommits();
            init3D();
            initScrollProgress();
        }
        
        // Scroll progress indicator
        function initScrollProgress() {
            const progressBar = document.getElementById('scrollProgress');
            
            window.addEventListener('scroll', () => {
                const windowHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrolled = (window.scrollY / windowHeight) * 100;
                progressBar.style.width = scrolled + '%';
            }, { passive: true });
        }
        
        loadData();
    </script>
</body>
</html>
