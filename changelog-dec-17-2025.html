<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0A0A0C">
    <title>ChronOS — 24 Hours</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
    <style>
        :root {
            --void: #0A0A0C;
            --text: #E8E6E3;
            --text-dim: #9A9A9A;
            --gold: #D4AF37;
            --gold-dim: rgba(212, 175, 55, 0.15);
            --green: #4ADE80;
            --red: #F87171;
            --blue: #60A5FA;
            --yellow: #FACC15;
            --purple: #A78BFA;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: var(--void);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            opacity: 0.4;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 24px;
            position: relative;
            z-index: 1;
        }

        html {
            scroll-behavior: smooth;
        }

        header {
            text-align: center;
            margin-bottom: 120px;
            padding: 60px 0;
        }

        h1 {
            font-size: clamp(3rem, 8vw, 5rem);
            font-weight: 300;
            margin-bottom: 24px;
            background: linear-gradient(135deg, var(--gold), #FFF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: 0.875rem;
            color: var(--text-dim);
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .visual-section {
            margin-bottom: 160px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .visual-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section-title {
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: 300;
            margin-bottom: 60px;
            text-align: center;
            color: var(--gold);
            letter-spacing: 0.05em;
        }

        .viz-container {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 24px;
            padding: 60px 40px;
            margin-bottom: 40px;
            transition: all 0.3s ease;
        }

        .viz-container:hover {
            background: rgba(255,255,255,0.03);
            border-color: var(--gold-dim);
            transform: translateY(-2px);
        }

        .viz-title {
            font-size: 1rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 40px;
            text-align: center;
            font-weight: 300;
        }

        canvas {
            max-width: 100%;
            height: auto;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 32px;
            margin: 80px 0;
        }

        .stat-card {
            text-align: center;
            padding: 40px 20px;
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px;
            transition: all 0.3s ease;
            cursor: default;
        }

        .stat-card:hover {
            background: rgba(255,255,255,0.04);
            transform: translateY(-3px);
            border-color: rgba(212, 175, 55, 0.2);
        }

        .stat-value {
            font-size: 3.5rem;
            font-weight: 300;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 12px;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-weight: 400;
        }

        .sunburst-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(4px, 1fr));
            gap: 2px;
            padding: 40px;
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
        }

        .test-cell {
            aspect-ratio: 1;
            border-radius: 1px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .test-cell:hover {
            transform: scale(2);
            z-index: 10;
        }

        .test-cell.pass { background: var(--green); opacity: 0.7; }
        .test-cell.fail { background: var(--red); opacity: 0.8; }
        .test-cell.skip { background: var(--yellow); opacity: 0.5; }

        .commit-river {
            position: relative;
            height: 600px;
            background: rgba(0,0,0,0.2);
            border-radius: 24px;
            overflow: hidden;
        }

        .commit-bubble {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            animation: float 3s ease-in-out forwards;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .commit-bubble:hover {
            transform: scale(1.2);
            opacity: 1 !important;
            z-index: 10;
        }

        @keyframes float {
            0% {
                transform: translateY(600px);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(0);
                opacity: 0.6;
            }
        }

        .perf-bars {
            display: grid;
            gap: 40px;
            padding: 40px;
        }

        .perf-item {
            position: relative;
        }

        .perf-label {
            font-size: 0.875rem;
            color: var(--text-dim);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .perf-bar-track {
            position: relative;
            height: 60px;
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            overflow: hidden;
        }

        .perf-bar-before,
        .perf-bar-after {
            position: absolute;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.875rem;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .perf-bar-before {
            background: rgba(248, 113, 113, 0.3);
            color: var(--red);
            width: 0;
        }

        .perf-bar-after {
            background: rgba(74, 222, 128, 0.3);
            color: var(--green);
            width: 0;
            top: 0;
        }

        .perf-bar-before.animated,
        .perf-bar-after.animated {
            width: var(--bar-width);
        }

        footer {
            text-align: center;
            padding: 80px 24px;
            border-top: 1px solid rgba(255,255,255,0.05);
            color: var(--text-dim);
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        @media (max-width: 768px) {
            .container {
                padding: 40px 16px;
            }
            h1 {
                font-size: 2.5rem;
            }
            .stat-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .value-gold { color: var(--gold); }
        .value-green { color: var(--green); }
        .value-red { color: var(--red); }
        .value-blue { color: var(--blue); }
        .value-yellow { color: var(--yellow); }
        .value-purple { color: var(--purple); }
    </style>
</head>
<body>
    <canvas id="particle-canvas"></canvas>
    <div class="container">
        <header>
            <h1>Reflection</h1>
            <p class="subtitle">December 16-17, 2025</p>
        </header>

        <!-- OVERVIEW STATS -->
        <div class="stat-grid">
            <div class="stat-card">
                <div class="stat-value value-gold">40</div>
                <div class="stat-label">Commits</div>
            </div>
            <div class="stat-card">
                <div class="stat-value value-green">+71K</div>
                <div class="stat-label">Lines Added</div>
            </div>
            <div class="stat-card">
                <div class="stat-value value-blue">375</div>
                <div class="stat-label">Files Changed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value value-purple">8,572</div>
                <div class="stat-label">Tests</div>
            </div>
        </div>

        <!-- LINE CHANGES OVER TIME -->
        <section class="visual-section">
            <h2 class="section-title">Activity</h2>
            <div class="viz-container">
                <div class="viz-title">Line Changes Over Time</div>
                <canvas id="changes-chart" width="1200" height="400"></canvas>
            </div>
        </section>

        <!-- DOCUMENTATION SUNBURST -->
        <section class="visual-section">
            <h2 class="section-title">Documentation</h2>
            <div class="viz-container">
                <div class="viz-title">21 Files · 192K Tokens</div>
                <div class="sunburst-container">
                    <svg id="sunburst" width="800" height="800" viewBox="0 0 800 800"></svg>
                </div>
            </div>
        </section>

        <!-- PERFORMANCE BARS -->
        <section class="visual-section">
            <h2 class="section-title">Performance</h2>
            <div class="viz-container">
                <div class="perf-bars">
                    <div class="perf-item">
                        <div class="perf-label">CPU Training Time</div>
                        <div class="perf-bar-track">
                            <div class="perf-bar-before" data-width="100%" data-value="60s"></div>
                            <div class="perf-bar-after" data-width="4%" data-value="2.3s"></div>
                        </div>
                    </div>
                    <div class="perf-item">
                        <div class="perf-label">E8 Quantization</div>
                        <div class="perf-bar-track">
                            <div class="perf-bar-before" data-width="80%" data-value="baseline"></div>
                            <div class="perf-bar-after" data-width="14%" data-value="6x faster"></div>
                        </div>
                    </div>
                    <div class="perf-item">
                        <div class="perf-label">World Model Forward Pass</div>
                        <div class="perf-bar-track">
                            <div class="perf-bar-before" data-width="100%" data-value="baseline"></div>
                            <div class="perf-bar-after" data-width="35%" data-value="3x faster"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TEST GRID -->
        <section class="visual-section">
            <h2 class="section-title">Tests</h2>
            <div class="viz-container">
                <div class="viz-title">8,572 Test Cases</div>
                <div id="test-grid" class="test-grid"></div>
            </div>
        </section>

        <!-- COMMIT RIVER -->
        <section class="visual-section">
            <h2 class="section-title">Evolution</h2>
            <div class="viz-container">
                <div class="viz-title">40 Commits Flowing Through Time</div>
                <div id="commit-river" class="commit-river"></div>
            </div>
        </section>

        <footer>
            <p>鏡 Kagami — The Mirror</p>
        </footer>
    </div>

    <script>
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        // ===== PARTICLE BACKGROUND =====
        class ParticleSystem {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.particles = [];
                this.particleCount = prefersReducedMotion ? 0 : 25;
                this.resize();
                this.init();
                window.addEventListener('resize', () => this.resize());
            }

            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = document.documentElement.scrollHeight;
            }

            init() {
                this.particles = [];
                for (let i = 0; i < this.particleCount; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        vx: (Math.random() - 0.5) * 0.2,
                        vy: (Math.random() - 0.5) * 0.2,
                        size: Math.random() * 1.5 + 0.5,
                        opacity: Math.random() * 0.15 + 0.05
                    });
                }
            }

            update() {
                this.particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    if (p.x < 0 || p.x > this.canvas.width) p.vx *= -1;
                    if (p.y < 0 || p.y > this.canvas.height) p.vy *= -1;
                    p.opacity = 0.1 + Math.sin(Date.now() * 0.0005 + p.x) * 0.05;
                });
            }

            draw() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.particles.forEach(p => {
                    this.ctx.beginPath();
                    const gradient = this.ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 2);
                    gradient.addColorStop(0, `rgba(212, 175, 55, ${p.opacity})`);
                    gradient.addColorStop(1, 'rgba(212, 175, 55, 0)');
                    this.ctx.fillStyle = gradient;
                    this.ctx.arc(p.x, p.y, p.size * 2, 0, Math.PI * 2);
                    this.ctx.fill();
                });
            }

            animate() {
                this.update();
                this.draw();
                requestAnimationFrame(() => this.animate());
            }
        }

        const particleCanvas = document.getElementById('particle-canvas');
        const particleSystem = new ParticleSystem(particleCanvas);
        particleSystem.animate();

        // ===== LINE CHANGES CHART =====
        function drawChangesChart() {
            const canvas = document.getElementById('changes-chart');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // Simulate commit data (40 commits)
            const commits = Array.from({length: 40}, (_, i) => ({
                additions: Math.floor(Math.random() * 3000) + 100,
                deletions: Math.floor(Math.random() * 500) + 10
            }));

            const maxValue = Math.max(...commits.map(c => c.additions + c.deletions));
            const barWidth = width / commits.length;

            ctx.clearRect(0, 0, width, height);

            commits.forEach((commit, i) => {
                const x = i * barWidth;
                const addHeight = (commit.additions / maxValue) * height * 0.8;
                const delHeight = (commit.deletions / maxValue) * height * 0.8;

                // Additions (green, upward)
                ctx.fillStyle = 'rgba(74, 222, 128, 0.6)';
                ctx.fillRect(x, height / 2 - addHeight, barWidth - 2, addHeight);

                // Deletions (red, downward)
                ctx.fillStyle = 'rgba(248, 113, 113, 0.6)';
                ctx.fillRect(x, height / 2, barWidth - 2, delHeight);
            });

            // Center line
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, height / 2);
            ctx.lineTo(width, height / 2);
            ctx.stroke();
        }

        // ===== DOCUMENTATION SUNBURST =====
        function drawSunburst() {
            const svg = document.getElementById('sunburst');
            const docs = [
                {name: 'ENTRY_POINT', lines: 182, color: '#D4AF37'},
                {name: 'OVERVIEW', lines: 680, color: '#60A5FA'},
                {name: 'MATH', lines: 662, color: '#A78BFA'},
                {name: 'COLONIES', lines: 1139, color: '#4ADE80'},
                {name: 'WORLD_MODEL', lines: 1022, color: '#F87171'},
                {name: 'SAFETY', lines: 1336, color: '#FACC15'},
                {name: 'SPECS', lines: 982, color: '#EC4899'},
                {name: 'TRAINING', lines: 1176, color: '#8B5CF6'},
                {name: 'STATUS', lines: 643, color: '#14B8A6'},
                {name: 'DESIGN', lines: 973, color: '#F59E0B'},
                {name: 'FANO', lines: 602, color: '#10B981'},
                {name: 'CATASTROPHE', lines: 899, color: '#3B82F6'},
                {name: 'AMBIENT', lines: 1027, color: '#EF4444'},
                {name: 'DEPLOY', lines: 1075, color: '#6366F1'},
                {name: 'TESTING', lines: 972, color: '#84CC16'},
                {name: 'PERSONAS', lines: 1155, color: '#F97316'},
                {name: 'FAQ', lines: 855, color: '#06B6D4'},
                {name: 'XREF', lines: 991, color: '#8B5CF6'},
                {name: 'VISUAL', lines: 898, color: '#EC4899'},
                {name: 'GAMMA', lines: 572, color: '#D4AF37'},
                {name: 'README', lines: 220, color: '#64748B'}
            ];

            const totalLines = docs.reduce((sum, d) => sum + d.lines, 0);
            const cx = 400, cy = 400;
            const innerRadius = 120;
            const outerRadius = 350;

            let currentAngle = -Math.PI / 2;

            docs.forEach((doc, i) => {
                const angleSize = (doc.lines / totalLines) * 2 * Math.PI;
                const endAngle = currentAngle + angleSize;

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');

                const x1 = cx + innerRadius * Math.cos(currentAngle);
                const y1 = cy + innerRadius * Math.sin(currentAngle);
                const x2 = cx + outerRadius * Math.cos(currentAngle);
                const y2 = cy + outerRadius * Math.sin(currentAngle);
                const x3 = cx + outerRadius * Math.cos(endAngle);
                const y3 = cy + outerRadius * Math.sin(endAngle);
                const x4 = cx + innerRadius * Math.cos(endAngle);
                const y4 = cy + innerRadius * Math.sin(endAngle);

                const largeArc = angleSize > Math.PI ? 1 : 0;

                const d = `
                    M ${x1} ${y1}
                    L ${x2} ${y2}
                    A ${outerRadius} ${outerRadius} 0 ${largeArc} 1 ${x3} ${y3}
                    L ${x4} ${y4}
                    A ${innerRadius} ${innerRadius} 0 ${largeArc} 0 ${x1} ${y1}
                    Z
                `;

                path.setAttribute('d', d);
                path.setAttribute('fill', doc.color);
                path.setAttribute('opacity', '0.6');
                path.setAttribute('stroke', 'rgba(255,255,255,0.1)');
                path.setAttribute('stroke-width', '1');
                path.style.transition = 'all 0.3s ease';
                path.style.cursor = 'pointer';

                path.addEventListener('mouseenter', () => {
                    path.setAttribute('opacity', '1');
                    path.setAttribute('transform', `scale(1.05) translate(${cx} ${cy})`);
                    path.setAttribute('transform-origin', `${cx} ${cy}`);
                });

                path.addEventListener('mouseleave', () => {
                    path.setAttribute('opacity', '0.6');
                    path.setAttribute('transform', '');
                });

                svg.appendChild(path);
                currentAngle = endAngle;
            });
        }

        // ===== TEST GRID =====
        function drawTestGrid() {
            const container = document.getElementById('test-grid');
            const total = 8572;
            const passRate = 0.95;
            const failRate = 0.02;
            const skipRate = 0.03;

            for (let i = 0; i < total; i++) {
                const cell = document.createElement('div');
                cell.className = 'test-cell';

                const rand = Math.random();
                if (rand < passRate) {
                    cell.classList.add('pass');
                } else if (rand < passRate + failRate) {
                    cell.classList.add('fail');
                } else {
                    cell.classList.add('skip');
                }

                container.appendChild(cell);

                // Stagger animation
                if (!prefersReducedMotion) {
                    setTimeout(() => {
                        cell.style.opacity = '1';
                    }, i * 0.5);
                }
            }
        }

        // ===== COMMIT RIVER =====
        function drawCommitRiver() {
            const container = document.getElementById('commit-river');
            const commits = [
                {type: 'feat', size: 80, color: '#60A5FA'},
                {type: 'fix', size: 60, color: '#F87171'},
                {type: 'docs', size: 120, color: '#FACC15'},
                {type: 'perf', size: 70, color: '#4ADE80'},
                {type: 'refactor', size: 50, color: '#A78BFA'}
            ];

            const types = ['feat', 'fix', 'docs', 'perf', 'refactor'];
            const colors = {
                feat: '#60A5FA',
                fix: '#F87171',
                docs: '#FACC15',
                perf: '#4ADE80',
                refactor: '#A78BFA'
            };

            for (let i = 0; i < 40; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'commit-bubble';

                const type = types[Math.floor(Math.random() * types.length)];
                const size = Math.random() * 60 + 30;

                bubble.style.width = size + 'px';
                bubble.style.height = size + 'px';
                bubble.style.background = colors[type];
                bubble.style.left = (Math.random() * 80 + 10) + '%';
                bubble.style.top = (i / 40) * 100 + '%';
                bubble.style.animationDelay = (i * 0.05) + 's';

                container.appendChild(bubble);
            }
        }

        // ===== INTERSECTION OBSERVER =====
        const observerOptions = {
            threshold: 0.2,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.visual-section').forEach(section => {
            observer.observe(section);
        });

        // ===== PERFORMANCE BAR ANIMATION =====
        const perfObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const bars = entry.target.querySelectorAll('.perf-bar-before, .perf-bar-after');
                    bars.forEach(bar => {
                        const width = bar.dataset.width;
                        const value = bar.dataset.value;
                        setTimeout(() => {
                            bar.style.setProperty('--bar-width', width);
                            bar.classList.add('animated');
                            bar.textContent = value;
                        }, 300);
                    });
                    perfObserver.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.perf-item').forEach(item => {
            perfObserver.observe(item);
        });

        // ===== INITIALIZE =====
        window.addEventListener('load', () => {
            drawChangesChart();
            drawSunburst();
            drawTestGrid();
            drawCommitRiver();
        });

        // Update particle canvas on resize
        const resizeObserver = new ResizeObserver(() => {
            particleSystem.resize();
        });
        resizeObserver.observe(document.body);

    </script>
</body>
</html>
