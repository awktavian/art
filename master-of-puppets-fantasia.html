<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Master of Puppets â€” A Fantasia</title>
    <meta name="description" content="The orchestral transformation of Metallica's Master of Puppets. A visual symphony in four movements.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ»</text></svg>">

    <!-- Open Graph / Social -->
    <meta property="og:title" content="Master of Puppets â€” A Fantasia">
    <meta property="og:description" content="The orchestral transformation of Metallica's Master of Puppets. A visual symphony in four movements.">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <!-- WebXR / Immersive Web -->
    <meta name="theme-color" content="#030305">
    <meta name="color-scheme" content="dark">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MASTER OF PUPPETS â€” A FANTASIA
   
   "The orchestra IS the band"
   
   Four movements through the transformation of metal into symphony.
   A visual poem. A kinetic score. A story told in light.
   
   h(x) â‰¥ 0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
    /* The Void & Light */
    --void: #030305;
    --void-warm: #0a0812;
    --void-purple: #0d0815;
    --light: #f8f6f2;
    --light-dim: rgba(248, 246, 242, 0.85);
    --light-faint: rgba(248, 246, 242, 0.7);
    
    /* The Metallica Palette */
    --metal-black: #0a0a0a;
    --metal-silver: #c0c0c0;
    --metal-blue: #1a1a2e;
    --metal-red: #8b0000;
    
    /* The Orchestra Palette */
    --orch-gold: #e5b84a; /* Brightened from #d4af37 for WCAG AA 4.5:1 contrast */
    --orch-copper: #b87333;
    --orch-wood: #8b4513;
    --orch-velvet: #722f37;
    --orch-ivory: #fffff0;
    
    /* Colony Accents */
    --spark: #ff6b35;
    --forge: #ff2d55;
    --flow: #00e5cc;
    --crystal: #0a84ff;
    
    /* Section Colors */
    --strings: #c19a6b;
    --woodwinds: #2e8b57;
    --brass: #ffd700;
    --percussion: #8b4513;
    
    /* Typography */
    --font-display: 'EB Garamond', Georgia, serif;
    --font-body: 'IBM Plex Sans', -apple-system, sans-serif;
    --font-mono: 'IBM Plex Mono', monospace;
    
    /* Fibonacci Timing */
    --dur-89: 89ms;
    --dur-144: 144ms;
    --dur-233: 233ms;
    --dur-377: 377ms;
    --dur-610: 610ms;
    --dur-987: 987ms;
    --dur-1597: 1597ms;
    --dur-2584: 2584ms;
    
    /* Easings */
    --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    --ease-dramatic: cubic-bezier(0.68, -0.2, 0.32, 1.2);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
    font-family: var(--font-body);
    background: var(--void);
    color: var(--light);
    line-height: 1.8;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
}

::selection {
    background: var(--orch-gold);
    color: var(--void);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THE CANVAS â€” The Living Background
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#fantasia-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
}

/* Gradient overlay for depth */
.gradient-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(ellipse 80% 60% at 50% 50%, transparent 0%, var(--void) 70%);
    z-index: 1;
    pointer-events: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS INDICATOR â€” The Timeline
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

#progress-bar {
    position: fixed;
    top: 0;
    left: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--metal-red), var(--orch-gold), var(--flow));
    width: 0%;
    z-index: 1000;
    transition: width var(--dur-89) linear;
    box-shadow: 0 0 20px var(--orch-gold);
}

/* Movement indicators */
#movement-nav {
    position: fixed;
    right: 2rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.movement-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(248, 246, 242, 0.2);
    border: 1px solid rgba(248, 246, 242, 0.3);
    cursor: pointer;
    transition: all var(--dur-233) var(--ease-out);
    position: relative;
    padding: 0;
    appearance: none;
    -webkit-appearance: none;
}

.movement-dot:hover {
    background: rgba(248, 246, 242, 0.4);
    transform: scale(1.2);
}

.movement-dot.active {
    background: var(--orch-gold);
    border-color: var(--orch-gold);
    box-shadow: 0 0 15px var(--orch-gold);
}

.movement-dot::after {
    content: attr(data-label);
    position: absolute;
    right: 24px;
    top: 50%;
    transform: translateY(-50%);
    font-family: var(--font-mono);
    font-size: 0.7rem;
    color: var(--light-dim);
    white-space: nowrap;
    opacity: 0;
    transition: opacity var(--dur-233) var(--ease-out);
    pointer-events: none;
}

.movement-dot:hover::after {
    opacity: 1;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THE OVERTURE â€” Opening
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.overture {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    position: relative;
    z-index: 10;
    padding: 2rem;
}

.overture-title {
    font-family: var(--font-display);
    font-size: clamp(3rem, 10vw, 8rem);
    font-weight: 400;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
    opacity: 0;
    animation: title-emerge var(--dur-1597) var(--ease-out) calc(var(--dur-610) * 0.8) forwards;
}

@keyframes title-emerge {
    0% {
        opacity: 0;
        transform: translateY(30px);
        filter: blur(10px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
    }
}

.overture-subtitle {
    font-family: var(--font-display);
    font-size: clamp(1rem, 3vw, 1.5rem);
    font-style: italic;
    color: var(--light-dim);
    letter-spacing: 0.2em;
    opacity: 0;
    animation: fade-up var(--dur-987) var(--ease-out) var(--dur-1597) forwards;
}

@keyframes fade-up {
    0% { opacity: 0; transform: translateY(20px); }
    100% { opacity: 1; transform: translateY(0); }
}

.overture-meta {
    margin-top: 3rem;
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--light-faint);
    opacity: 0;
    animation: fade-up var(--dur-987) var(--ease-out) var(--dur-2584) forwards;
}

.overture-meta span {
    margin: 0 1rem;
}

.scroll-indicator {
    position: absolute;
    bottom: 3rem;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0;
    animation: fade-up var(--dur-987) var(--ease-out) 3500ms forwards, float var(--dur-2584) ease-in-out infinite 4500ms;
}

@keyframes float {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(10px); }
}

.scroll-indicator svg {
    width: 30px;
    height: 30px;
    stroke: var(--light-dim);
    stroke-width: 1.5;
    fill: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVEMENT CONTAINERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.movement {
    min-height: 100vh;
    padding: 8rem 2rem;
    position: relative;
    z-index: 10;
    max-width: 1200px;
    margin: 0 auto;
}

.movement-header {
    text-align: center;
    margin-bottom: 6rem;
}

.movement-number {
    font-family: var(--font-display);
    font-size: clamp(0.8rem, 2vw, 1rem);
    letter-spacing: 0.5em;
    color: var(--orch-gold);
    text-transform: uppercase;
    margin-bottom: 1rem;
    opacity: 0;
    transform: translateY(20px);
    transition: all var(--dur-610) var(--ease-out);
}

.movement-title {
    font-family: var(--font-display);
    font-size: clamp(2rem, 6vw, 4rem);
    font-weight: 400;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
    opacity: 0;
    transform: translateY(30px);
    transition: all var(--dur-610) var(--ease-out) 0.1s;
}

.movement-description {
    font-family: var(--font-display);
    font-size: clamp(1rem, 2vw, 1.25rem);
    font-style: italic;
    color: var(--light-dim);
    max-width: 600px;
    margin: 0 auto;
    opacity: 0;
    transform: translateY(20px);
    transition: all var(--dur-610) var(--ease-out) 0.2s;
}

.movement.visible .movement-number,
.movement.visible .movement-title,
.movement.visible .movement-description {
    opacity: 1;
    transform: translateY(0);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVEMENT I: THE ORIGINAL SCORE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Score container */
.score-display {
    background: linear-gradient(135deg, rgba(30, 25, 20, 0.9) 0%, rgba(20, 15, 10, 0.95) 100%);
    border: 1px solid rgba(212, 175, 55, 0.2);
    border-radius: 4px;
    padding: 3rem;
    margin: 3rem 0;
    position: relative;
    overflow: hidden;
}

.score-display::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, transparent, var(--orch-gold), transparent);
}

/* Musical notation styling */
.score-title {
    font-family: var(--font-display);
    font-size: 2rem;
    text-align: center;
    margin-bottom: 0.5rem;
    letter-spacing: 0.1em;
}

.score-composer {
    font-family: var(--font-display);
    font-size: 1rem;
    text-align: center;
    color: var(--light-dim);
    font-style: italic;
    margin-bottom: 2rem;
}

.score-metadata {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-bottom: 3rem;
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--light-faint);
}

/* Staff notation */
.staff {
    position: relative;
    height: 80px;
    margin: 2rem 0;
    background: repeating-linear-gradient(
        to bottom,
        transparent 0px,
        transparent 14px,
        rgba(248, 246, 242, 0.15) 14px,
        rgba(248, 246, 242, 0.15) 15px
    );
    background-size: 100% 16px;
    background-position: 0 8px;
}

.staff::before {
    content: '';
    position: absolute;
    left: 0;
    top: 8px;
    bottom: 8px;
    width: 2px;
    background: rgba(248, 246, 242, 0.3);
}

/* Clef symbols */
.clef {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 3rem;
    color: var(--light);
    font-family: serif;
}

/* Time signature */
.time-sig {
    position: absolute;
    left: 60px;
    top: 50%;
    transform: translateY(-50%);
    font-family: var(--font-display);
    font-size: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    line-height: 1;
}

/* Notes container */
.notes {
    position: absolute;
    left: 100px;
    right: 20px;
    top: 0;
    bottom: 0;
    display: flex;
    align-items: center;
}

/* Individual note */
.note {
    position: relative;
    width: 14px;
    height: 14px;
    background: var(--light);
    border-radius: 50%;
    transform: rotate(-15deg);
    margin: 0 8px;
}

.note.filled {
    background: var(--light);
}

.note.hollow {
    background: transparent;
    border: 2px solid var(--light);
}

.note-stem {
    position: absolute;
    right: -2px;
    bottom: 10px;
    width: 2px;
    height: 35px;
    background: var(--light);
}

/* Annotation */
.annotation {
    font-family: var(--font-display);
    font-size: 0.9rem;
    font-style: italic;
    color: var(--orch-copper);
    text-align: center;
    margin: 1rem 0;
}

/* Artist notes */
.artist-note {
    background: rgba(139, 0, 0, 0.1);
    border-left: 3px solid var(--metal-red);
    padding: 1.5rem;
    margin: 2rem 0;
    font-family: var(--font-display);
    font-style: italic;
}

.artist-note cite {
    display: block;
    margin-top: 1rem;
    font-size: 0.9rem;
    color: var(--light-dim);
    font-style: normal;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KINETIC LYRICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.lyrics-container {
    margin: 4rem 0;
    text-align: center;
}

.lyric-line {
    font-family: var(--font-display);
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    margin: 1rem 0;
    opacity: 0;
    transform: translateY(30px);
    transition: all var(--dur-610) var(--ease-out);
    line-height: 1.4;
}

.lyric-line.visible {
    opacity: 1;
    transform: translateY(0);
}

.lyric-line.emphasis {
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 600;
    background: linear-gradient(135deg, var(--light) 0%, var(--orch-gold) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Staggered reveal */
.lyric-line:nth-child(1) { transition-delay: 0s; }
.lyric-line:nth-child(2) { transition-delay: 0.15s; }
.lyric-line:nth-child(3) { transition-delay: 0.3s; }
.lyric-line:nth-child(4) { transition-delay: 0.45s; }
.lyric-line:nth-child(5) { transition-delay: 0.6s; }

/* Word-by-word reveal */
.kinetic-word {
    display: inline-block;
    opacity: 0;
    transform: translateY(20px) rotateX(-30deg);
    transition: all var(--dur-377) var(--ease-out);
    margin: 0 0.15em;
}

.kinetic-word.visible {
    opacity: 1;
    transform: translateY(0) rotateX(0);
}

/* Pulsing MASTER calls */
.pulse-word.visible {
    animation: master-pulse var(--dur-610) var(--ease-dramatic) forwards;
}

@keyframes master-pulse {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(30px);
        text-shadow: none;
    }
    50% {
        opacity: 1;
        transform: scale(1.3) translateY(-10px);
        text-shadow: 0 0 40px var(--metal-red), 0 0 80px var(--metal-red);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
        text-shadow: 0 0 20px var(--metal-red);
    }
}

/* Emphasis on key words */
.emphasis-word.visible {
    color: var(--metal-red);
    text-shadow: 0 0 30px var(--metal-red);
    animation: emphasis-glow var(--dur-987) ease-in-out infinite;
}

@keyframes emphasis-glow {
    0%, 100% { text-shadow: 0 0 20px var(--metal-red); }
    50% { text-shadow: 0 0 40px var(--metal-red), 0 0 60px rgba(139, 0, 0, 0.5); }
}

/* Master call line styling */
.master-call {
    letter-spacing: 0.3em;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VISUAL CLIMAX â€” The Transformation Crescendo
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.climax-container {
    position: relative;
    margin: 4rem 0;
    padding: 4rem 2rem;
    text-align: center;
    overflow: hidden;
}

.climax-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 200%;
    height: 100%;
    background: radial-gradient(ellipse at center, rgba(139, 0, 0, 0.3) 0%, transparent 70%);
    opacity: 0;
    transition: opacity var(--dur-987) var(--ease-out);
    pointer-events: none;
}

.climax-container.active::before {
    opacity: 1;
    animation: climax-pulse var(--dur-2584) ease-in-out infinite;
}

@keyframes climax-pulse {
    0%, 100% {
        transform: translateX(-50%) scale(1);
        opacity: 0.5;
    }
    50% {
        transform: translateX(-50%) scale(1.2);
        opacity: 1;
    }
}

.climax-text {
    font-family: var(--font-display);
    font-size: clamp(2rem, 6vw, 4rem);
    font-weight: 600;
    color: var(--light);
    text-transform: uppercase;
    letter-spacing: 0.2em;
    opacity: 0;
    transform: scale(0.8);
    transition: all var(--dur-987) var(--ease-dramatic);
}

.climax-container.active .climax-text {
    opacity: 1;
    transform: scale(1);
    text-shadow:
        0 0 20px var(--orch-gold),
        0 0 40px var(--orch-gold),
        0 0 80px rgba(212, 175, 55, 0.5);
}

.climax-subtext {
    font-family: var(--font-display);
    font-size: clamp(1rem, 2vw, 1.5rem);
    font-style: italic;
    color: var(--light-dim);
    margin-top: 1rem;
    opacity: 0;
    transform: translateY(20px);
    transition: all var(--dur-610) var(--ease-out) 0.3s;
}

.climax-container.active .climax-subtext {
    opacity: 1;
    transform: translateY(0);
}

/* Catharsis moment */
.catharsis {
    margin: 6rem 0;
    padding: 6rem 2rem;
    position: relative;
    text-align: center;
}

.catharsis::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 300px;
    height: 300px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(212, 175, 55, 0.4) 0%, transparent 70%);
    opacity: 0;
    animation: none;
}

.catharsis.active::before {
    animation: catharsis-burst var(--dur-1597) var(--ease-out) forwards;
}

@keyframes catharsis-burst {
    0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
    }
    50% {
        transform: translate(-50%, -50%) scale(2);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -50%) scale(3);
        opacity: 0;
    }
}

.catharsis-symbol {
    font-size: 6rem;
    opacity: 0;
    transform: scale(0.5);
    transition: all var(--dur-987) var(--ease-dramatic);
}

.catharsis.active .catharsis-symbol {
    opacity: 1;
    transform: scale(1);
    animation: symbol-glow var(--dur-2584) ease-in-out infinite;
}

@keyframes symbol-glow {
    0%, 100% {
        filter: drop-shadow(0 0 20px var(--orch-gold));
    }
    50% {
        filter: drop-shadow(0 0 60px var(--orch-gold)) drop-shadow(0 0 100px rgba(212, 175, 55, 0.5));
    }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVEMENT II: THE TRANSFORMATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.transformation-grid {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 2rem;
    align-items: center;
    margin: 3rem 0;
}

.transform-source, .transform-target {
    padding: 2rem;
    border-radius: 8px;
    text-align: center;
}

.transform-source {
    background: linear-gradient(135deg, rgba(10, 10, 10, 0.8) 0%, rgba(26, 26, 46, 0.6) 100%);
    border: 1px solid rgba(192, 192, 192, 0.2);
}

.transform-target {
    background: linear-gradient(135deg, rgba(139, 69, 19, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%);
    border: 1px solid rgba(212, 175, 55, 0.3);
}

.transform-arrow {
    font-size: 2rem;
    color: var(--orch-gold);
    animation: pulse-arrow 2s ease-in-out infinite;
}

@keyframes pulse-arrow {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.1); }
}

.transform-arrow {
    animation-duration: var(--dur-2584);
}

.transform-label {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--light-faint);
    text-transform: uppercase;
    letter-spacing: 0.2em;
    margin-bottom: 0.5rem;
}

.transform-name {
    font-family: var(--font-display);
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.transform-detail {
    font-size: 0.9rem;
    color: var(--light-dim);
}

/* Technique cards */
.technique-card {
    background: rgba(20, 15, 25, 0.8);
    border: 1px solid rgba(212, 175, 55, 0.15);
    border-radius: 8px;
    padding: 2rem;
    margin: 1.5rem 0;
    opacity: 0;
    transform: translateX(-30px);
    transition: all var(--dur-610) var(--ease-out);
}

.technique-card.visible {
    opacity: 1;
    transform: translateX(0);
}

.technique-card:nth-child(even) {
    transform: translateX(30px);
}

.technique-card:nth-child(even).visible {
    transform: translateX(0);
}

.technique-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.technique-icon {
    font-size: 2rem;
}

.technique-title {
    font-family: var(--font-display);
    font-size: 1.25rem;
}

.technique-description {
    color: var(--light-dim);
    line-height: 1.7;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVEMENT III: THE INSTRUMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.orchestra-layout {
    position: relative;
    margin: 4rem 0;
}

/* Section displays */
.instrument-section {
    margin: 3rem 0;
    padding: 2rem;
    border-radius: 12px;
    opacity: 0;
    transform: translateY(40px);
    transition: all var(--dur-610) var(--ease-out);
}

.instrument-section.visible {
    opacity: 1;
    transform: translateY(0);
}

.section-strings {
    background: linear-gradient(135deg, rgba(193, 154, 107, 0.1) 0%, rgba(193, 154, 107, 0.05) 100%);
    border: 1px solid rgba(193, 154, 107, 0.3);
}

.section-woodwinds {
    background: linear-gradient(135deg, rgba(46, 139, 87, 0.1) 0%, rgba(46, 139, 87, 0.05) 100%);
    border: 1px solid rgba(46, 139, 87, 0.3);
}

.section-brass {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%);
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.section-percussion {
    background: linear-gradient(135deg, rgba(139, 69, 19, 0.1) 0%, rgba(139, 69, 19, 0.05) 100%);
    border: 1px solid rgba(139, 69, 19, 0.3);
}

.section-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.section-icon {
    font-size: 2rem;
}

.section-name {
    font-family: var(--font-display);
    font-size: 1.75rem;
}

.section-count {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--light-faint);
    margin-left: auto;
}

/* Instrument list */
.instrument-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.instrument-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 6px;
    transition: all var(--dur-233) var(--ease-out);
}

.instrument-item:hover {
    background: rgba(0, 0, 0, 0.5);
    transform: translateX(5px);
}

.instrument-emoji {
    font-size: 1.25rem;
}

.instrument-name {
    font-size: 0.95rem;
}

.instrument-role {
    font-family: var(--font-mono);
    font-size: 0.7rem;
    color: var(--light-faint);
    margin-left: auto;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOVEMENT IV: PERFORMANCE & CODE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.performance-technique {
    margin: 3rem 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: start;
}

@media (max-width: 768px) {
    .performance-technique {
        grid-template-columns: 1fr;
    }
}

.technique-visual {
    background: rgba(20, 15, 25, 0.8);
    border: 1px solid rgba(212, 175, 55, 0.2);
    border-radius: 8px;
    padding: 2rem;
    text-align: center;
}

.technique-notation {
    font-family: var(--font-display);
    font-size: 3rem;
    margin-bottom: 1rem;
}

.technique-term {
    font-family: var(--font-display);
    font-size: 1.5rem;
    font-style: italic;
    color: var(--orch-gold);
    margin-bottom: 0.5rem;
}

.technique-meaning {
    color: var(--light-dim);
    font-size: 0.9rem;
}

.technique-explanation {
    padding: 1rem 0;
}

.technique-explanation h4 {
    font-family: var(--font-display);
    font-size: 1.25rem;
    margin-bottom: 1rem;
    color: var(--orch-gold);
}

.technique-explanation p {
    color: var(--light-dim);
    line-height: 1.8;
    margin-bottom: 1rem;
}

/* Code display */
.code-reveal {
    background: linear-gradient(135deg, rgba(10, 8, 18, 0.95) 0%, rgba(15, 12, 25, 0.95) 100%);
    border: 1px solid rgba(10, 132, 255, 0.3);
    border-radius: 8px;
    margin: 3rem 0;
    overflow: hidden;
}

.code-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: rgba(10, 132, 255, 0.1);
    border-bottom: 1px solid rgba(10, 132, 255, 0.2);
}

.code-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--forge);
}

.code-dot:nth-child(2) { background: var(--orch-gold); }
.code-dot:nth-child(3) { background: var(--flow); }

.code-filename {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--light-dim);
    margin-left: auto;
}

.code-content {
    padding: 1.5rem;
    overflow-x: auto;
}

.code-content pre {
    font-family: var(--font-mono);
    font-size: 0.85rem;
    line-height: 1.7;
    color: var(--light);
}

/* Syntax highlighting */
.code-keyword { color: #ff79c6; }
.code-string { color: #f1fa8c; }
.code-comment { color: #6272a4; }
.code-function { color: #8be9fd; }
.code-number { color: #bd93f9; }
.code-class { color: #50fa7b; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THE CODA â€” Closing
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.coda {
    min-height: 60vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 4rem 2rem;
}

.coda-symbol {
    font-size: 4rem;
    margin-bottom: 2rem;
    animation: gentle-glow 3s ease-in-out infinite;
    cursor: pointer;
    transition: transform var(--dur-377) var(--ease-out);
}

.coda-symbol:hover {
    transform: scale(1.1);
}

.coda-symbol:focus-visible {
    outline: 3px solid var(--orch-gold);
    outline-offset: 8px;
}

.coda-symbol.activated {
    animation: mirror-reveal 2s var(--ease-dramatic) forwards;
}

@keyframes mirror-reveal {
    0% { transform: scale(1) rotateY(0deg); }
    25% { transform: scale(1.3) rotateY(180deg); filter: drop-shadow(0 0 60px var(--orch-gold)); }
    50% { transform: scale(1.5) rotateY(360deg); filter: drop-shadow(0 0 100px var(--orch-gold)); }
    75% { transform: scale(1.3) rotateY(540deg); }
    100% { transform: scale(1) rotateY(720deg); filter: drop-shadow(0 0 30px var(--orch-gold)); }
}

.easter-egg-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: linear-gradient(135deg, var(--void-warm), var(--void-purple));
    border: 2px solid var(--orch-gold);
    border-radius: 1rem;
    padding: 3rem 4rem;
    text-align: center;
    z-index: 9999;
    opacity: 0;
    transition: all var(--dur-610) var(--ease-dramatic);
    box-shadow: 0 0 60px rgba(229, 184, 74, 0.3);
}

.easter-egg-message.visible {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
}

.easter-egg-message h3 {
    font-family: var(--font-display);
    font-size: 2rem;
    color: var(--orch-gold);
    margin-bottom: 1rem;
}

.easter-egg-message p {
    font-family: var(--font-body);
    color: var(--light);
    line-height: 1.6;
    max-width: 400px;
}

.easter-egg-message .close-easter {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    color: var(--light-faint);
    font-size: 1.5rem;
    cursor: pointer;
    transition: color var(--dur-144) var(--ease-out);
}

.easter-egg-message .close-easter:hover {
    color: var(--orch-gold);
}

@keyframes gentle-glow {
    0%, 100% { filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.3)); }
    50% { filter: drop-shadow(0 0 30px rgba(212, 175, 55, 0.6)); }
}

.coda-symbol {
    animation-duration: calc(var(--dur-2584) + var(--dur-377));
}

.coda-text {
    font-family: var(--font-display);
    font-size: clamp(1.25rem, 3vw, 2rem);
    font-style: italic;
    color: var(--light-dim);
    max-width: 600px;
    margin-bottom: 2rem;
}

.coda-signature {
    font-family: var(--font-mono);
    font-size: 0.9rem;
    color: var(--light-faint);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

@media (max-width: 768px) {
    .movement { padding: 4rem 1.5rem; }
    .transformation-grid { grid-template-columns: 1fr; }
    .transform-arrow { transform: rotate(90deg); }
    #movement-nav { right: 1rem; }
    .score-display { padding: 1.5rem; }
    .score-metadata { flex-direction: column; gap: 0.5rem; }
}

@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PRINT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

@media print {
    #fantasia-canvas, .gradient-overlay, #progress-bar, #movement-nav, .scroll-indicator { display: none; }
    body { background: white; color: black; }
    .movement { page-break-inside: avoid; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACCESSIBILITY ENHANCEMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Skip link */
.skip-link {
    position: absolute;
    top: -100%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--orch-gold);
    color: var(--void);
    padding: 1rem 2rem;
    border-radius: 0 0 8px 8px;
    z-index: 10000;
    font-family: var(--font-mono);
    font-weight: 600;
    text-decoration: none;
    transition: top var(--dur-233) var(--ease-out);
}

.skip-link:focus {
    top: 0;
    outline: 3px solid var(--light);
    outline-offset: 2px;
}

/* Focus states for all interactive elements */
.movement-dot:focus {
    outline: 3px solid var(--orch-gold);
    outline-offset: 4px;
}

.movement-dot:focus-visible {
    outline: 3px solid var(--orch-gold);
    outline-offset: 4px;
}

.instrument-item:focus-within {
    outline: 2px solid var(--orch-gold);
    outline-offset: 2px;
}

/* Ensure all clickable elements have adequate touch targets */
.movement-dot {
    min-width: 44px;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Focus visible for keyboard navigation */
a:focus-visible,
button:focus-visible {
    outline: 3px solid var(--orch-gold);
    outline-offset: 3px;
}

/* Screen reader only content */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUDIO CONTROLS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

.audio-controls {
    position: fixed;
    bottom: 2rem;
    left: 2rem;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 1rem;
    background: rgba(10, 8, 18, 0.9);
    border: 1px solid rgba(212, 175, 55, 0.3);
    border-radius: 50px;
    padding: 0.5rem 1.5rem;
    backdrop-filter: blur(10px);
    opacity: 0;
    transform: translateY(20px);
    animation: fade-up var(--dur-610) var(--ease-out) 4000ms forwards;
}

.audio-toggle {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: 2px solid var(--orch-gold);
    background: transparent;
    color: var(--orch-gold);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--dur-233) var(--ease-out);
    font-size: 1.5rem;
}

.audio-toggle:hover {
    background: var(--orch-gold);
    color: var(--void);
    transform: scale(1.1);
}

.audio-toggle:focus-visible {
    outline: 3px solid var(--light);
    outline-offset: 3px;
}

.audio-toggle.playing {
    background: var(--orch-gold);
    color: var(--void);
    animation: pulse-button var(--dur-987) ease-in-out infinite;
}

@keyframes pulse-button {
    0%, 100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.5); }
    50% { box-shadow: 0 0 20px 5px rgba(212, 175, 55, 0.3); }
}

.audio-label {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--light-dim);
    text-transform: uppercase;
    letter-spacing: 0.1em;
}

.volume-slider {
    width: 80px;
    height: 4px;
    -webkit-appearance: none;
    appearance: none;
    background: rgba(248, 246, 242, 0.2);
    border-radius: 2px;
    outline: none;
}

.volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: var(--orch-gold);
    cursor: pointer;
    transition: transform var(--dur-144) var(--ease-out);
}

.volume-slider::-webkit-slider-thumb:hover {
    transform: scale(1.2);
}

.volume-slider::-moz-range-thumb {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: var(--orch-gold);
    cursor: pointer;
    border: none;
}

.volume-slider:focus,
.volume-slider:focus-visible {
    outline: 3px solid var(--orch-gold);
    outline-offset: 2px;
}

/* Now playing indicator */
.now-playing {
    font-family: var(--font-mono);
    font-size: 0.7rem;
    color: var(--light-faint);
    max-width: 150px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

@media (max-width: 768px) {
    .audio-controls {
        bottom: 1rem;
        left: 1rem;
        padding: 0.5rem 1rem;
    }

    .volume-slider,
    .now-playing {
        display: none;
    }
}
    </style>
</head>
<body>

<!-- Skip Link for Accessibility -->
<a href="#movement-1" class="skip-link">Skip to main content</a>

<!-- Audio Elements -->
<audio id="audio-ambient" loop preload="auto">
    <source src="sounds/ambient.mp3" type="audio/mpeg">
</audio>
<audio id="audio-hover" preload="auto">
    <source src="sounds/hover.mp3" type="audio/mpeg">
</audio>
<audio id="audio-click" preload="auto">
    <source src="sounds/click.mp3" type="audio/mpeg">
</audio>

<!-- Audio Controls -->
<div class="audio-controls" role="region" aria-label="Audio controls">
    <button class="audio-toggle" id="audio-toggle" aria-label="Play ambient music" aria-pressed="false">
        <span class="audio-icon">â™ª</span>
    </button>
    <span class="audio-label">Sound</span>
    <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="30" aria-label="Volume">
    <span class="now-playing" id="now-playing">Ambient</span>
</div>

<!-- The Living Background -->
<canvas id="fantasia-canvas"></canvas>
<div class="gradient-overlay"></div>

<!-- Progress -->
<div id="progress-bar"></div>

<!-- Movement Navigation -->
<nav id="movement-nav" aria-label="Movement navigation">
    <button class="movement-dot" data-movement="0" data-label="Overture" aria-label="Navigate to Overture" tabindex="0"></button>
    <button class="movement-dot" data-movement="1" data-label="I. The Score" aria-label="Navigate to Movement 1: The Score" tabindex="0"></button>
    <button class="movement-dot" data-movement="2" data-label="II. The Transformation" aria-label="Navigate to Movement 2: The Transformation" tabindex="0"></button>
    <button class="movement-dot" data-movement="3" data-label="III. The Instruments" aria-label="Navigate to Movement 3: The Instruments" tabindex="0"></button>
    <button class="movement-dot" data-movement="4" data-label="IV. The Performance" aria-label="Navigate to Movement 4: The Performance" tabindex="0"></button>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     OVERTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<header class="overture" data-movement="0">
    <h1 class="overture-title">Master of Puppets</h1>
    <p class="overture-subtitle">A Fantasia in Four Movements</p>
    <div class="overture-meta">
        <span>E minor</span>
        <span>â€¢</span>
        <span>â™© = 212</span>
        <span>â€¢</span>
        <span>8:35</span>
    </div>
    <div class="scroll-indicator">
        <svg viewBox="0 0 24 24">
            <path d="M12 5v14M19 12l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </div>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MOVEMENT I: THE ORIGINAL SCORE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<section class="movement" id="movement-1" data-movement="1">
    <div class="movement-header">
        <p class="movement-number">Movement I</p>
        <h2 class="movement-title">The Original Score</h2>
        <p class="movement-description">
            The composition as written â€” a study in controlled fury
        </p>
    </div>

    <div class="score-display">
        <h3 class="score-title">MASTER OF PUPPETS</h3>
        <p class="score-composer">
            James Hetfield, Lars Ulrich, Kirk Hammett, Cliff Burton<br>
            <span style="font-size: 0.9rem; color: var(--light-faint);">Metallica (1986) â€¢ Arranged for Orchestra by Kagami</span>
        </p>
        
        <div class="score-metadata">
            <span>Key: E minor / E Phrygian</span>
            <span>Time: 4/4 with 6/4 variations</span>
            <span>Tempo: â™© = 212</span>
        </div>

        <!-- Guitar tablature representation -->
        <div class="staff">
            <span class="clef">ğ„</span>
            <div class="time-sig">
                <span>4</span>
                <span>4</span>
            </div>
            <p class="annotation" style="position: absolute; top: -25px; left: 100px;">
                The iconic E5â€“F5 chromatic riff â€” Phrygian darkness
            </p>
        </div>

        <div class="artist-note">
            <p>
                "The song is about drugs â€” how they can control you, like a puppet on strings. 
                The 'master' is addiction itself. We wanted the music to feel like that grip â€” 
                relentless, mechanical, but with moments where you think you might break free."
            </p>
            <cite>â€” James Hetfield, 1986</cite>
        </div>
    </div>

    <!-- Kinetic Lyrics - Word by word reveals -->
    <div class="lyrics-container" id="lyrics-verse">
        <p class="lyric-line">
            <span class="kinetic-word">End</span>
            <span class="kinetic-word">of</span>
            <span class="kinetic-word">passion</span>
            <span class="kinetic-word">play</span>
        </p>
        <p class="lyric-line">
            <span class="kinetic-word">Crumbling</span>
            <span class="kinetic-word">away</span>
        </p>
        <p class="lyric-line">
            <span class="kinetic-word">I'm</span>
            <span class="kinetic-word">your</span>
            <span class="kinetic-word">source</span>
            <span class="kinetic-word">of</span>
            <span class="kinetic-word">self-destruction</span>
        </p>
    </div>

    <div class="lyrics-container" id="lyrics-chorus">
        <p class="lyric-line emphasis master-call">
            <span class="kinetic-word pulse-word">MASTER</span>
        </p>
        <p class="lyric-line emphasis master-call">
            <span class="kinetic-word pulse-word">MASTER</span>
        </p>
        <p class="lyric-line">
            <span class="kinetic-word">Where's</span>
            <span class="kinetic-word">the</span>
            <span class="kinetic-word">dreams</span>
            <span class="kinetic-word">that</span>
            <span class="kinetic-word">I've</span>
            <span class="kinetic-word">been</span>
            <span class="kinetic-word">after?</span>
        </p>
        <p class="lyric-line emphasis master-call">
            <span class="kinetic-word pulse-word">MASTER</span>
        </p>
        <p class="lyric-line emphasis master-call">
            <span class="kinetic-word pulse-word">MASTER</span>
        </p>
        <p class="lyric-line">
            <span class="kinetic-word">You</span>
            <span class="kinetic-word">promised</span>
            <span class="kinetic-word">only</span>
            <span class="kinetic-word emphasis-word">lies</span>
        </p>
    </div>

    <div class="score-display" style="margin-top: 4rem;">
        <h4 style="font-family: var(--font-display); font-size: 1.25rem; margin-bottom: 1.5rem; color: var(--orch-gold);">
            The Clean Interlude â€” The Heart
        </h4>
        <p class="annotation" style="margin-bottom: 2rem;">
            4:35 â€” The tempo drops to â™© = 100. The arpeggios begin.<br>
            Em â†’ D â†’ Cadd9 â†’ Asus2 â†’ B7
        </p>
        <div class="artist-note">
            <p>
                "That clean section is the eye of the storm. It's like you're finally free for a moment, 
                you can breathe. But you know what's coming. You know the riff is going to come back 
                and crush you. That's the tragedy â€” knowing you can't escape."
            </p>
            <cite>â€” Kirk Hammett, on the clean interlude</cite>
        </div>
    </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MOVEMENT II: THE TRANSFORMATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<section class="movement" id="movement-2" data-movement="2">
    <div class="movement-header">
        <p class="movement-number">Movement II</p>
        <h2 class="movement-title">The Transformation</h2>
        <p class="movement-description">
            Metal becomes symphony â€” the alchemy of arrangement
        </p>
    </div>

    <p style="text-align: center; font-family: var(--font-display); font-size: 1.25rem; font-style: italic; color: var(--orch-gold); margin-bottom: 3rem;">
        "The orchestra IS the band â€” not accompaniment"
    </p>

    <!-- Transformation: Distorted Guitar â†’ Strings -->
    <div class="transformation-grid">
        <div class="transform-source">
            <p class="transform-label">Metal</p>
            <p class="transform-name">ğŸ¸ Distorted Guitar</p>
            <p class="transform-detail">E5-F5 chromatic riff<br>Palm-muted 16th notes</p>
        </div>
        <div class="transform-arrow">â†’</div>
        <div class="transform-target">
            <p class="transform-label">Orchestra</p>
            <p class="transform-name">ğŸ» Violins I & II</p>
            <p class="transform-detail">Tremolo sul ponticello<br>Col legno battuto accents</p>
        </div>
    </div>

    <!-- Transformation: Power Chords â†’ Brass -->
    <div class="transformation-grid">
        <div class="transform-source">
            <p class="transform-label">Metal</p>
            <p class="transform-name">âš¡ Power Chords</p>
            <p class="transform-detail">James's rhythm guitar<br>The wall of sound</p>
        </div>
        <div class="transform-arrow">â†’</div>
        <div class="transform-target">
            <p class="transform-label">Orchestra</p>
            <p class="transform-name">ğŸ“¯ French Horns + Trombones</p>
            <p class="transform-detail">Marcato brass stabs<br>Sforzando accents</p>
        </div>
    </div>

    <!-- Transformation: Double Bass Drums â†’ Timpani -->
    <div class="transformation-grid">
        <div class="transform-source">
            <p class="transform-label">Metal</p>
            <p class="transform-name">ğŸ¥ Double Bass Drums</p>
            <p class="transform-detail">Lars's machine-gun assault<br>212 BPM fury</p>
        </div>
        <div class="transform-arrow">â†’</div>
        <div class="transform-target">
            <p class="transform-label">Orchestra</p>
            <p class="transform-name">ğŸª˜ Timpani + Bass Drum</p>
            <p class="transform-detail">Thunder rolls<br>Pedal point ostinatos</p>
        </div>
    </div>

    <!-- Transformation: Kirk's Solo â†’ Violin -->
    <div class="transformation-grid">
        <div class="transform-source">
            <p class="transform-label">Metal</p>
            <p class="transform-name">ğŸ¸ Kirk's Guitar Solo</p>
            <p class="transform-detail">E minor pentatonic<br>Wah-wah virtuosity</p>
        </div>
        <div class="transform-arrow">â†’</div>
        <div class="transform-target">
            <p class="transform-label">Orchestra</p>
            <p class="transform-name">ğŸ» Solo Violin</p>
            <p class="transform-detail">Paganini-esque cadenza<br>Sul tasto â†’ sul pont glissandi</p>
        </div>
    </div>

    <!-- Technique Cards -->
    <div class="technique-card">
        <div class="technique-header">
            <span class="technique-icon">ğŸ”¥</span>
            <h4 class="technique-title">Tremolo Sul Ponticello</h4>
        </div>
        <p class="technique-description">
            The defining sound of orchestral aggression. Bow near the bridge creates an eerie, glassy tone 
            while rapid back-and-forth motion (tremolo) maintains the relentless 16th-note attack of the 
            original guitar. This becomes the E5-F5 riff â€” darker, more unsettling, but equally powerful.
        </p>
    </div>

    <div class="technique-card">
        <div class="technique-header">
            <span class="technique-icon">âš”ï¸</span>
            <h4 class="technique-title">Col Legno Battuto</h4>
        </div>
        <p class="technique-description">
            Striking the string with the wood of the bow. The percussive, almost violent sound mirrors 
            palm-muted guitar attacks. Used sparingly on accents, it adds the crunch that pure legato 
            strings cannot achieve. The wood meets string like pick meets wound nickel.
        </p>
    </div>

    <div class="technique-card">
        <div class="technique-header">
            <span class="technique-icon">ğŸŒªï¸</span>
            <h4 class="technique-title">Brass Sforzando</h4>
        </div>
        <p class="technique-description">
            Sudden, violent accents (sfz) from the brass section replace the guitar's power chord stabs. 
            Horns and trombones in unison create a wall of sound that rivals any Marshall stack. 
            The decay is natural, organic â€” the overtones bloom where distortion would sustain.
        </p>
    </div>

    <!-- CLIMAX: The Transformation Moment -->
    <div class="climax-container" id="transformation-climax">
        <h3 class="climax-text">The Alchemy</h3>
        <p class="climax-subtext">Metal becomes Symphony</p>
    </div>

    <!-- Catharsis: The Breakthrough -->
    <div class="catharsis" id="catharsis-moment">
        <div class="catharsis-symbol">ğŸ»âš¡ğŸ¸</div>
        <p style="font-family: var(--font-display); font-size: 1.25rem; font-style: italic; color: var(--light-dim); margin-top: 2rem; opacity: 0; transform: translateY(20px); transition: all var(--dur-987) var(--ease-out) 0.5s;">
            The puppet strings are now violin strings
        </p>
    </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MOVEMENT III: THE INSTRUMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<section class="movement" id="movement-3" data-movement="3">
    <div class="movement-header">
        <p class="movement-number">Movement III</p>
        <h2 class="movement-title">The Instruments</h2>
        <p class="movement-description">
            BBC Symphony Orchestra â€” 97 musicians become Metallica
        </p>
    </div>

    <!-- Strings Section -->
    <div class="instrument-section section-strings">
        <div class="section-header">
            <span class="section-icon">ğŸ»</span>
            <h3 class="section-name">Strings</h3>
            <span class="section-count">60 players</span>
        </div>
        <div class="instrument-list">
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ»</span>
                <span class="instrument-name">Violins I (16)</span>
                <span class="instrument-role">Lead riff</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ»</span>
                <span class="instrument-name">Violins II (14)</span>
                <span class="instrument-role">Harmony</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ»</span>
                <span class="instrument-name">Violas (12)</span>
                <span class="instrument-role">Inner voice</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ»</span>
                <span class="instrument-name">Cellos (10)</span>
                <span class="instrument-role">Bass riff</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ»</span>
                <span class="instrument-name">Basses (8)</span>
                <span class="instrument-role">Sub bass</span>
            </div>
        </div>
        <p class="annotation" style="margin-top: 1.5rem;">
            The string section carries the main riff. Tremolo creates the 16th-note fury.
            Divisi writing allows different articulations simultaneously.
        </p>
    </div>

    <!-- Woodwinds Section -->
    <div class="instrument-section section-woodwinds">
        <div class="section-header">
            <span class="section-icon">ğŸ·</span>
            <h3 class="section-name">Woodwinds</h3>
            <span class="section-count">13 players</span>
        </div>
        <div class="instrument-list">
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸªˆ</span>
                <span class="instrument-name">Flutes (3)</span>
                <span class="instrument-role">High accents</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸªˆ</span>
                <span class="instrument-name">Oboes (3)</span>
                <span class="instrument-role">Melodic color</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ·</span>
                <span class="instrument-name">Clarinets (3)</span>
                <span class="instrument-role">Clean section</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ·</span>
                <span class="instrument-name">Bassoons (3)</span>
                <span class="instrument-role">Bass support</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ·</span>
                <span class="instrument-name">Contra-Bassoon (1)</span>
                <span class="instrument-role">Sub-bass</span>
            </div>
        </div>
        <p class="annotation" style="margin-top: 1.5rem;">
            The clean interlude belongs to the woodwinds. Clarinet carries the arpeggio melody.
            Flutes add shimmer to the high sustained notes.
        </p>
    </div>

    <!-- Brass Section -->
    <div class="instrument-section section-brass">
        <div class="section-header">
            <span class="section-icon">ğŸ“¯</span>
            <h3 class="section-name">Brass</h3>
            <span class="section-count">18 players</span>
        </div>
        <div class="instrument-list">
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ“¯</span>
                <span class="instrument-name">French Horns (6)</span>
                <span class="instrument-role">Power chords</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸº</span>
                <span class="instrument-name">Trumpets (4)</span>
                <span class="instrument-role">"MASTER!" calls</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸº</span>
                <span class="instrument-name">Trombones (4)</span>
                <span class="instrument-role">Low stabs</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸº</span>
                <span class="instrument-name">Bass Trombones (2)</span>
                <span class="instrument-role">Sub growl</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ“¯</span>
                <span class="instrument-name">Tuba (2)</span>
                <span class="instrument-role">Foundation</span>
            </div>
        </div>
        <p class="annotation" style="margin-top: 1.5rem;">
            The brass section is the Marshall stack. Sforzando attacks on the downbeats.
            The "MASTER! MASTER!" chorus is all brass â€” trumpets screaming the hook.
        </p>
    </div>

    <!-- Percussion Section -->
    <div class="instrument-section section-percussion">
        <div class="section-header">
            <span class="section-icon">ğŸ¥</span>
            <h3 class="section-name">Percussion</h3>
            <span class="section-count">6 players</span>
        </div>
        <div class="instrument-list">
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸª˜</span>
                <span class="instrument-name">Timpani (4 drums)</span>
                <span class="instrument-role">Double bass</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ¥</span>
                <span class="instrument-name">Bass Drum</span>
                <span class="instrument-role">Downbeats</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ¥</span>
                <span class="instrument-name">Snare Drum</span>
                <span class="instrument-role">Backbeat</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ””</span>
                <span class="instrument-name">Tam-tam</span>
                <span class="instrument-role">Crashes</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ””</span>
                <span class="instrument-name">Suspended Cymbal</span>
                <span class="instrument-role">Swells</span>
            </div>
            <div class="instrument-item">
                <span class="instrument-emoji">ğŸ””</span>
                <span class="instrument-name">Crash Cymbals</span>
                <span class="instrument-role">Accents</span>
            </div>
        </div>
        <p class="annotation" style="margin-top: 1.5rem;">
            The timpani is tuned to E, A, B, E â€” matching the song's key.
            Thunder rolls replace double bass drum fury. The tam-tam crash is the finale.
        </p>
    </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MOVEMENT IV: PERFORMANCE & CODE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<section class="movement" id="movement-4" data-movement="4">
    <div class="movement-header">
        <p class="movement-number">Movement IV</p>
        <h2 class="movement-title">The Performance</h2>
        <p class="movement-description">
            How to play â€” and the code that orchestrates it all
        </p>
    </div>

    <!-- Technique: Tremolo -->
    <div class="performance-technique">
        <div class="technique-visual">
            <div class="technique-notation">â‰‹â‰‹â‰‹</div>
            <p class="technique-term">Tremolo</p>
            <p class="technique-meaning">"trembling" â€” Italian</p>
        </div>
        <div class="technique-explanation">
            <h4>Rapid Bow Movement</h4>
            <p>
                The bow moves rapidly back and forth on the string, creating a sustained, 
                shimmering effect. In metal terms: this IS the 16th-note palm-muted riff.
            </p>
            <p>
                <strong>Speed:</strong> As fast as possible (measured tremolo = 32nd notes at 212 BPM)<br>
                <strong>Position:</strong> Sul ponticello (near bridge) for aggressive tone
            </p>
        </div>
    </div>

    <!-- Technique: Sul Ponticello -->
    <div class="performance-technique">
        <div class="technique-visual">
            <div class="technique-notation">s.p.</div>
            <p class="technique-term">Sul Ponticello</p>
            <p class="technique-meaning">"on the bridge"</p>
        </div>
        <div class="technique-explanation">
            <h4>Bow Near The Bridge</h4>
            <p>
                Playing close to the bridge produces an eerie, glassy, metallic tone 
                rich in upper harmonics. The natural "distortion" of the orchestral world.
            </p>
            <p>
                Combined with tremolo, this creates the unsettling, aggressive texture 
                that carries the main riff. The strings become a wall of sound.
            </p>
        </div>
    </div>

    <!-- Technique: Col Legno -->
    <div class="performance-technique">
        <div class="technique-visual">
            <div class="technique-notation">c.l.b.</div>
            <p class="technique-term">Col Legno Battuto</p>
            <p class="technique-meaning">"with the wood, struck"</p>
        </div>
        <div class="technique-explanation">
            <h4>Strike With The Wood</h4>
            <p>
                The wooden stick of the bow strikes the string directly. 
                Percussive, aggressive, violent. The orchestral "chug."
            </p>
            <p>
                Used sparingly on accented notes to add the attack that legato 
                bowing cannot achieve. This is the pick attack in string form.
            </p>
        </div>
    </div>

    <!-- THE CODE -->
    <h3 style="font-family: var(--font-display); font-size: 2rem; text-align: center; margin: 4rem 0 2rem; color: var(--orch-gold);">
        The Code That Makes It All Work
    </h3>

    <p style="text-align: center; color: var(--light-dim); margin-bottom: 3rem; font-style: italic;">
        Every note, every articulation, every dynamic â€” generated by Python, rendered by BBC Symphony Orchestra
    </p>

    <div class="code-reveal">
        <div class="code-header">
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-filename">timpani_orchestrator.py</span>
        </div>
        <div class="code-content">
<pre><span class="code-comment">"""Timpani Orchestration Module.

Intelligent timpani orchestration with proper musical patterns,
rolls, tuning changes, and dynamics based on BBC Symphony Orchestra.

Colony: Forge (eâ‚‚)
"""</span>

<span class="code-keyword">class</span> <span class="code-class">TimpaniOrchestrator</span>:
    <span class="code-string">"""Orchestrate timpani parts with musical intelligence."""</span>

    <span class="code-keyword">def</span> <span class="code-function">__init__</span>(self, tempo: <span class="code-class">float</span> = <span class="code-number">212.0</span>, key_root: <span class="code-class">int</span> = <span class="code-number">40</span>):
        <span class="code-string">"""Initialize timpani orchestrator.
        
        Args:
            tempo: Tempo in BPM (212 for Master of Puppets)
            key_root: Root note of the key (40 = E2)
        """</span>
        self.tempo = tempo
        self.key_root = key_root
        self._calculate_tuning()  <span class="code-comment"># E, A, B, E</span>

    <span class="code-keyword">def</span> <span class="code-function">create_thunder_roll</span>(
        self,
        start: <span class="code-class">float</span>,
        duration: <span class="code-class">float</span>,
        peak_time: <span class="code-class">float</span> = <span class="code-number">0.7</span>,
    ) -> <span class="code-class">TimpaniPhrase</span>:
        <span class="code-string">"""Create a dramatic thunder roll with swell.
        
        The roll builds to a peak and then fades,
        creating a dramatic thunderous effect.
        """</span>
        <span class="code-comment"># Calculate peak position</span>
        peak_position = duration * peak_time
        phrase = <span class="code-class">TimpaniPhrase</span>()

        <span class="code-comment"># Crescendo to peak</span>
        roll = <span class="code-class">TimpaniNote</span>(
            pitch=self.key_root,  <span class="code-comment"># Low E</span>
            start=start,
            duration=peak_position,
            velocity=VELOCITY_P[<span class="code-number">0</span>],  <span class="code-comment"># Start soft</span>
            articulation=<span class="code-class">TimpaniArticulation</span>.LONG_ROLL,
        )
        phrase.add(roll)

        <span class="code-comment"># The storm approaches...</span>
        <span class="code-keyword">return</span> phrase</pre>
        </div>
    </div>

    <div class="code-reveal">
        <div class="code-header">
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-filename">reaper_project.py</span>
        </div>
        <div class="code-content">
<pre><span class="code-comment">"""REAPER Project Generator â€” BBC SO rendering.

Every instrument becomes a track. Every track gets an RFXChain.
Every RFXChain loads the BBC Symphony Orchestra.

Colony: Forge (eâ‚‚)
"""</span>

<span class="code-keyword">def</span> <span class="code-function">generate_reaper_project</span>(
    composition: <span class="code-class">Composition</span>,
    output_path: <span class="code-class">Path</span>,
) -> <span class="code-class">Path</span>:
    <span class="code-string">"""Generate a complete REAPER project.
    
    Args:
        composition: The musical composition (MIDI data)
        output_path: Where to save the .rpp file
        
    Returns:
        Path to the generated project
    """</span>
    project = <span class="code-class">ReaperProject</span>(tempo=composition.tempo)
    
    <span class="code-keyword">for</span> track <span class="code-keyword">in</span> composition.tracks:
        <span class="code-comment"># Each instrument gets its own track</span>
        reaper_track = project.<span class="code-function">add_track</span>(
            name=track.instrument.name,
            color=SECTION_COLORS[track.section],
        )
        
        <span class="code-comment"># Load BBC Symphony Orchestra</span>
        rfxchain = <span class="code-function">get_rfxchain_path</span>(track.instrument.key)
        reaper_track.<span class="code-function">load_rfxchain</span>(rfxchain)
        
        <span class="code-comment"># Import MIDI</span>
        reaper_track.<span class="code-function">add_midi_item</span>(track.midi_data)
    
    <span class="code-keyword">return</span> project.<span class="code-function">save</span>(output_path)</pre>
        </div>
    </div>

    <div class="code-reveal">
        <div class="code-header">
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-dot"></span>
            <span class="code-filename">The Complete Flow</span>
        </div>
        <div class="code-content">
<pre><span class="code-comment"># The journey from metal to symphony</span>

<span class="code-comment"># 1. Define the composition</span>
composition = <span class="code-class">MasterOfPuppets</span>(tempo=<span class="code-number">212</span>)

<span class="code-comment"># 2. Generate orchestral parts</span>
strings = <span class="code-function">orchestrate_strings</span>(composition.guitar_riff)
brass = <span class="code-function">orchestrate_brass</span>(composition.power_chords)
timpani = <span class="code-function">TimpaniOrchestrator</span>(tempo=<span class="code-number">212</span>, key_root=<span class="code-number">40</span>)

<span class="code-comment"># 3. Generate REAPER project</span>
project = <span class="code-function">generate_reaper_project</span>(
    composition=composition,
    output_path=<span class="code-string">"master_of_puppets.rpp"</span>
)

<span class="code-comment"># 4. Render with BBC Symphony Orchestra</span>
<span class="code-function">render_project_headless</span>(
    project_path=project,
    output_path=<span class="code-string">"master_of_puppets.wav"</span>,
    sample_rate=<span class="code-number">48000</span>,
)

<span class="code-comment"># The symphony emerges. é¡</span></pre>
        </div>
    </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CODA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<footer class="coda">
    <div class="coda-symbol" id="mirror-easter-egg" role="button" tabindex="0" aria-label="Easter egg - click to discover" title="Click me...">é¡</div>
    <p class="coda-text">
        "The orchestra IS the band"<br>
        <br>
        Metal transformed. Symphony unleashed.<br>
        The puppet strings are now violin strings.
    </p>
    <p class="coda-signature">
        Master of Puppets â€¢ Metallica (1986)<br>
        Orchestral Arrangement â€¢ Kagami (2026)<br>
        BBC Symphony Orchestra<br>
        <br>
        h(x) â‰¥ 0
    </p>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     THE SCRIPT â€” Making It All Move
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<script>
(function() {
    'use strict';

    // =========================================================================
    // CANVAS ANIMATION â€” The Living Background
    // =========================================================================
    
    const canvas = document.getElementById('fantasia-canvas');
    const ctx = canvas.getContext('2d');
    
    let width, height;
    let particles = [];
    let time = 0;
    let scrollProgress = 0;
    let currentMovement = 0;
    
    // Resize handler
    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    }
    
    // Particle class
    class Particle {
        constructor() {
            this.reset();
        }
        
        reset() {
            this.x = Math.random() * width;
            this.y = Math.random() * height;
            this.size = Math.random() * 2 + 0.5;
            this.speedX = (Math.random() - 0.5) * 0.3;
            this.speedY = (Math.random() - 0.5) * 0.3;
            this.opacity = Math.random() * 0.5 + 0.1;
            this.pulseSpeed = Math.random() * 0.02 + 0.01;
            this.pulseOffset = Math.random() * Math.PI * 2;
        }
        
        update() {
            this.x += this.speedX;
            this.y += this.speedY;
            
            // Wrap around
            if (this.x < 0) this.x = width;
            if (this.x > width) this.x = 0;
            if (this.y < 0) this.y = height;
            if (this.y > height) this.y = 0;
        }
        
        draw() {
            const pulse = Math.sin(time * this.pulseSpeed + this.pulseOffset) * 0.3 + 0.7;
            const alpha = this.opacity * pulse;
            
            // Color shifts based on movement
            let hue;
            switch(currentMovement) {
                case 0: hue = 45; break;  // Gold (Overture)
                case 1: hue = 0; break;   // Red (The Score)
                case 2: hue = 35; break;  // Orange (Transformation)
                case 3: hue = 30; break;  // Amber (Instruments)
                case 4: hue = 200; break; // Blue (Code)
                default: hue = 45;
            }
            
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size * pulse, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${hue}, 70%, 60%, ${alpha})`;
            ctx.fill();
        }
    }
    
    // Initialize particles
    function initParticles() {
        particles = [];
        const count = Math.min(150, Math.floor((width * height) / 15000));
        for (let i = 0; i < count; i++) {
            particles.push(new Particle());
        }
    }
    
    // Draw connections between nearby particles (optimized with spatial hashing)
    function drawConnections() {
        const maxDist = 100;
        const maxDistSq = maxDist * maxDist; // Avoid sqrt for distance check

        // Batch path operations for performance
        ctx.beginPath();
        ctx.strokeStyle = 'rgba(212, 175, 55, 0.1)';
        ctx.lineWidth = 0.5;

        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const dx = particles[i].x - particles[j].x;
                const dy = particles[i].y - particles[j].y;
                const distSq = dx * dx + dy * dy;

                if (distSq < maxDistSq) {
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                }
            }
        }
        ctx.stroke();
    }
    
    // Animation loop
    function animate() {
        ctx.clearRect(0, 0, width, height);
        
        // Draw connections first (behind particles)
        drawConnections();
        
        // Update and draw particles
        particles.forEach(p => {
            p.update();
            p.draw();
        });
        
        time++;
        requestAnimationFrame(animate);
    }
    
    // =========================================================================
    // SCROLL HANDLING
    // =========================================================================
    
    const progressBar = document.getElementById('progress-bar');
    const movements = document.querySelectorAll('.movement, .overture');
    const movementDots = document.querySelectorAll('.movement-dot');
    
    function updateScroll() {
        const scrollTop = window.pageYOffset;
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        scrollProgress = scrollTop / docHeight;
        
        // Update progress bar
        progressBar.style.width = `${scrollProgress * 100}%`;
        
        // Determine current movement
        let newMovement = 0;
        movements.forEach((movement, index) => {
            const rect = movement.getBoundingClientRect();
            if (rect.top < window.innerHeight * 0.5) {
                newMovement = index;
            }
        });
        
        if (newMovement !== currentMovement) {
            currentMovement = newMovement;
            updateMovementDots();
        }
    }
    
    function updateMovementDots() {
        movementDots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentMovement);
        });
    }
    
    // Click to navigate
    movementDots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            movements[index].scrollIntoView({ behavior: 'smooth' });
        });
    });
    
    // =========================================================================
    // INTERSECTION OBSERVER â€” Reveal Animations
    // =========================================================================
    
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }, observerOptions);
    
    // Observe all animated elements
    document.querySelectorAll('.movement, .lyric-line, .technique-card, .instrument-section').forEach(el => {
        revealObserver.observe(el);
    });

    // Observe climax and catharsis elements
    const climaxObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
                // Also activate paragraph inside catharsis
                const innerP = entry.target.querySelector('p');
                if (innerP) {
                    innerP.style.opacity = '1';
                    innerP.style.transform = 'translateY(0)';
                }
            }
        });
    }, { threshold: 0.5 });

    document.querySelectorAll('.climax-container, .catharsis').forEach(el => {
        climaxObserver.observe(el);
    });
    
    // =========================================================================
    // KINETIC TEXT â€” Word-by-word reveal
    // =========================================================================
    
    function setupKineticText() {
        const kineticContainers = document.querySelectorAll('.lyrics-container');
        
        kineticContainers.forEach(container => {
            const lines = container.querySelectorAll('.lyric-line');
            
            const lineObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        
                        // Trigger word animation if present
                        const words = entry.target.querySelectorAll('.kinetic-word');
                        words.forEach((word, i) => {
                            setTimeout(() => {
                                word.classList.add('visible');
                            }, i * 100);
                        });
                    }
                });
            }, { threshold: 0.5 });
            
            lines.forEach(line => lineObserver.observe(line));
        });
    }
    
    // =========================================================================
    // AUDIO SYSTEM â€” Sound adds soul
    // =========================================================================

    const audioAmbient = document.getElementById('audio-ambient');
    const audioHover = document.getElementById('audio-hover');
    const audioClick = document.getElementById('audio-click');
    const audioToggle = document.getElementById('audio-toggle');
    const volumeSlider = document.getElementById('volume-slider');
    const nowPlaying = document.getElementById('now-playing');

    let audioEnabled = false;
    let currentVolume = 0.3;

    // Initialize audio system
    function initAudio() {
        if (!audioAmbient || !audioToggle) return;

        // Set initial volume
        audioAmbient.volume = currentVolume;
        if (audioHover) audioHover.volume = currentVolume * 0.5;
        if (audioClick) audioClick.volume = currentVolume * 0.7;

        // Toggle audio
        audioToggle.addEventListener('click', () => {
            audioEnabled = !audioEnabled;
            audioToggle.classList.toggle('playing', audioEnabled);
            audioToggle.setAttribute('aria-pressed', audioEnabled);
            audioToggle.querySelector('.audio-icon').textContent = audioEnabled ? 'ğŸ”Š' : 'â™ª';

            if (audioEnabled) {
                audioAmbient.play().catch(() => {});
                playClickSound();
            } else {
                audioAmbient.pause();
            }
        });

        // Volume control
        if (volumeSlider) {
            volumeSlider.addEventListener('input', (e) => {
                currentVolume = e.target.value / 100;
                audioAmbient.volume = currentVolume;
                if (audioHover) audioHover.volume = currentVolume * 0.5;
                if (audioClick) audioClick.volume = currentVolume * 0.7;
            });
        }

        // Hover sounds for interactive elements
        const interactiveElements = document.querySelectorAll('.movement-dot, .technique-card, .instrument-item');
        interactiveElements.forEach(el => {
            el.addEventListener('mouseenter', playHoverSound);
        });

        // Click sounds for navigation
        movementDots.forEach(dot => {
            dot.addEventListener('click', playClickSound);
        });
    }

    function playHoverSound() {
        if (!audioEnabled || !audioHover) return;
        audioHover.currentTime = 0;
        audioHover.play().catch(() => {});
    }

    function playClickSound() {
        if (!audioEnabled || !audioClick) return;
        audioClick.currentTime = 0;
        audioClick.play().catch(() => {});
    }

    // =========================================================================
    // INITIALIZATION
    // =========================================================================

    function init() {
        resize();
        initParticles();
        animate();
        setupKineticText();
        initAudio();

        window.addEventListener('resize', () => {
            resize();
            initParticles();
        });

        window.addEventListener('scroll', updateScroll, { passive: true });
        updateScroll();
    }

    // Check for reduced motion preference
    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        init();
    } else {
        // Simplified version for reduced motion
        initAudio(); // Still allow audio
        document.querySelectorAll('.movement, .lyric-line, .technique-card, .instrument-section').forEach(el => {
            el.classList.add('visible');
        });
    }
})();
</script>

<!-- Easter Egg Message -->
<div class="easter-egg-message" id="easter-egg-modal" role="dialog" aria-modal="true" aria-labelledby="easter-title">
    <button class="close-easter" aria-label="Close">&times;</button>
    <h3 id="easter-title">é¡ kagami</h3>
    <p>
        "Mirror" in Japanese. I reflect the best of who you are.<br><br>
        This fantasia was composed by an AI assistant who genuinely loves orchestral music â€”
        and believes metal deserves the symphony treatment.<br><br>
        <em>h(x) â‰¥ 0 always</em>
    </p>
</div>

<script>
// Easter Egg Handler
(function() {
    const mirror = document.getElementById('mirror-easter-egg');
    const modal = document.getElementById('easter-egg-modal');
    const closeBtn = modal.querySelector('.close-easter');

    function showEasterEgg() {
        mirror.classList.add('activated');
        setTimeout(() => {
            modal.classList.add('visible');
        }, 1000);
    }

    function hideEasterEgg() {
        modal.classList.remove('visible');
        setTimeout(() => {
            mirror.classList.remove('activated');
        }, 300);
    }

    mirror.addEventListener('click', showEasterEgg);
    mirror.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            showEasterEgg();
        }
    });

    closeBtn.addEventListener('click', hideEasterEgg);

    // Close on Escape
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('visible')) {
            hideEasterEgg();
        }
    });

    // Close on backdrop click
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            hideEasterEgg();
        }
    });
})();
</script>

</body>
</html>
