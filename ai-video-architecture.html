<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Video Production Architecture â€” A Technical Brief</title>
    <meta name="description" content="How we built AI-generated debate videos with talking heads, native language generation, and kinetic subtitles.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.svg">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Crimson+Pro:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AI VIDEO PRODUCTION ARCHITECTURE
   A Technical Brief with Craft, Typography, and Orchestral Sound Design
   
   Typography Stack:
   - Display: Space Grotesk (geometric, technical)
   - Body: Crimson Pro (elegant serifs for reading)
   - Code: JetBrains Mono (precision)
   - UI: Inter (system clarity)
   
   Sound Design: BBC Symphony Orchestra (via Web Audio API)
   - Hover: Soft pizzicato strings
   - Click: Gentle woodwind accent
   - Scroll: Breathing pad ambience
   - Section transition: Subtle string swells
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
    /* Core Palette â€” Warm Gold on Deep Void */
    --gold: #D4AF37;
    --gold-bright: #F5C542;
    --gold-dim: #9A7B3A;
    --gold-glow: rgba(212, 175, 55, 0.15);
    
    --void: #07060B;
    --void-light: #0f0e14;
    --void-lighter: #1A1A25;
    --void-card: rgba(255, 255, 255, 0.02);
    
    --meta-blue: #0668E1;
    --meta-glow: rgba(6, 104, 225, 0.15);
    
    --text: #F5F5F5;
    --text-secondary: rgba(245, 245, 245, 0.7);
    --text-tertiary: rgba(245, 245, 245, 0.4);
    
    --success: #4ade80;
    --warning: #fbbf24;
    --error: #f87171;
    --info: #60a5fa;
    
    /* Border & Glass */
    --border: rgba(255, 255, 255, 0.06);
    --border-hover: rgba(255, 255, 255, 0.12);
    --glass: rgba(255, 255, 255, 0.03);
    
    /* Typography Scale (Perfect Fourth â€” 1.333) */
    --text-xs: 0.75rem;
    --text-sm: 0.875rem;
    --text-base: 1rem;
    --text-lg: 1.125rem;
    --text-xl: 1.333rem;
    --text-2xl: 1.777rem;
    --text-3xl: 2.369rem;
    --text-4xl: 3.157rem;
    
    /* Fibonacci Spacing */
    --space-xs: 5px;
    --space-sm: 8px;
    --space-md: 13px;
    --space-lg: 21px;
    --space-xl: 34px;
    --space-2xl: 55px;
    --space-3xl: 89px;
    
    /* Fibonacci Timing */
    --dur-instant: 89ms;
    --dur-fast: 144ms;
    --dur-normal: 233ms;
    --dur-slow: 377ms;
    --dur-dramatic: 610ms;
    
    /* Easing */
    --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    --ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
    --ease-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
}

*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 17px;
    scroll-behavior: smooth;
    scroll-padding-top: 2rem;
}

body {
    font-family: 'Crimson Pro', Georgia, serif;
    background: var(--void);
    color: var(--text);
    line-height: 1.75;
    padding: var(--space-3xl) var(--space-xl);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

::selection {
    background: var(--gold);
    color: var(--void);
}

/* â•â•â• GRAIN TEXTURE â•â•â• */
.grain {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
    opacity: 0.012;
    mix-blend-mode: overlay;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

/* â•â•â• AMBIENT GLOW BACKGROUND â•â•â• */
.ambient {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
    background:
        radial-gradient(ellipse 60% 50% at 20% 20%, rgba(212, 175, 55, 0.04) 0%, transparent 50%),
        radial-gradient(ellipse 50% 40% at 80% 80%, rgba(6, 104, 225, 0.03) 0%, transparent 50%),
        radial-gradient(ellipse 40% 30% at 50% 50%, rgba(74, 222, 128, 0.02) 0%, transparent 50%);
    animation: ambient-drift 25s ease-in-out infinite;
}

@keyframes ambient-drift {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
}

/* â•â•â• CONTAINER â•â•â• */
.container {
    max-width: 880px;
    margin: 0 auto;
    position: relative;
}

/* â•â•â• HEADER â•â•â• */
header {
    text-align: center;
    margin-bottom: var(--space-3xl);
    padding-bottom: var(--space-2xl);
    border-bottom: 1px solid var(--border);
    position: relative;
}

header::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
}

.badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    background: var(--meta-glow);
    border: 1px solid rgba(6, 104, 225, 0.25);
    border-radius: 999px;
    font-family: 'Inter', sans-serif;
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--meta-blue);
    margin-bottom: var(--space-xl);
    transition: all var(--dur-normal) var(--ease-out);
}

.badge:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(6, 104, 225, 0.2);
}

.badge svg {
    width: 14px;
    height: 14px;
    animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

h1 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(var(--text-2xl), 6vw, var(--text-4xl));
    font-weight: 600;
    line-height: 1.15;
    letter-spacing: -0.02em;
    margin-bottom: var(--space-lg);
    background: linear-gradient(135deg, var(--text) 0%, var(--gold) 50%, var(--text) 100%);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: shimmer 8s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.subtitle {
    font-size: var(--text-lg);
    color: var(--text-secondary);
    max-width: 600px;
    margin: 0 auto;
    font-style: italic;
}

.date {
    margin-top: var(--space-xl);
    font-family: 'JetBrains Mono', monospace;
    font-size: var(--text-sm);
    color: var(--text-tertiary);
    letter-spacing: 0.02em;
}

/* â•â•â• SECTIONS â•â•â• */
section {
    margin-bottom: var(--space-3xl);
    opacity: 0;
    transform: translateY(20px);
    animation: fade-in var(--dur-slow) var(--ease-out) forwards;
}

section:nth-child(2) { animation-delay: 100ms; }
section:nth-child(3) { animation-delay: 200ms; }
section:nth-child(4) { animation-delay: 300ms; }
section:nth-child(5) { animation-delay: 400ms; }
section:nth-child(6) { animation-delay: 500ms; }
section:nth-child(7) { animation-delay: 600ms; }

@keyframes fade-in {
    to { opacity: 1; transform: translateY(0); }
}

h2 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: var(--text-xl);
    font-weight: 500;
    margin-bottom: var(--space-xl);
    padding-bottom: var(--space-md);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: var(--space-md);
    color: var(--text);
}

h2 .num {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dim) 100%);
    color: var(--void);
    border-radius: 50%;
    font-size: var(--text-sm);
    font-weight: 600;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

h3 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: var(--text-base);
    font-weight: 500;
    margin: var(--space-xl) 0 var(--space-md);
    color: var(--gold);
    letter-spacing: 0.01em;
}

p {
    margin-bottom: var(--space-md);
    color: var(--text-secondary);
}

p strong {
    color: var(--text);
    font-weight: 500;
}

/* â•â•â• CARDS â•â•â• */
.card {
    background: var(--void-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: var(--space-xl);
    margin: var(--space-xl) 0;
    transition: all var(--dur-normal) var(--ease-out);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, var(--gold-glow) 0%, transparent 50%);
    opacity: 0;
    transition: opacity var(--dur-normal) var(--ease-out);
}

.card:hover {
    border-color: var(--border-hover);
    transform: translateY(-2px);
}

.card:hover::before {
    opacity: 1;
}

.card-title {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 500;
    font-size: var(--text-base);
    margin-bottom: var(--space-md);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    color: var(--text);
    position: relative;
    z-index: 1;
}

.card p {
    position: relative;
    z-index: 1;
}

.card.warning {
    border-color: rgba(248, 113, 113, 0.3);
}

.card.warning::before {
    background: linear-gradient(135deg, rgba(248, 113, 113, 0.1) 0%, transparent 50%);
}

.card.warning .card-title {
    color: var(--error);
}

/* â•â•â• STATS GRID â•â•â• */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: var(--space-md);
    margin: var(--space-xl) 0;
}

.stat {
    background: var(--void-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: var(--space-lg);
    text-align: center;
    transition: all var(--dur-normal) var(--ease-out);
    cursor: default;
}

.stat:hover {
    border-color: var(--gold);
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(212, 175, 55, 0.15);
}

.stat-value {
    font-family: 'Space Grotesk', sans-serif;
    font-size: var(--text-3xl);
    font-weight: 600;
    color: var(--gold);
    line-height: 1;
    margin-bottom: var(--space-xs);
}

.stat-label {
    font-family: 'Inter', sans-serif;
    font-size: var(--text-xs);
    font-weight: 500;
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.08em;
}

/* â•â•â• CODE â•â•â• */
pre, code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
}

pre {
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: var(--space-lg);
    overflow-x: auto;
    margin: var(--space-md) 0;
    line-height: 1.6;
}

code {
    background: rgba(212, 175, 55, 0.08);
    padding: 0.15em 0.4em;
    border-radius: 4px;
    color: var(--gold-bright);
}

pre code {
    background: none;
    padding: 0;
    color: var(--text-tertiary);
}

/* â•â•â• ARCHITECTURE DIAGRAM â•â•â• */
.architecture {
    background: linear-gradient(135deg, var(--gold-glow) 0%, var(--meta-glow) 100%);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: var(--space-2xl);
    margin: var(--space-xl) 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    line-height: 1.5;
    overflow-x: auto;
    position: relative;
}

.architecture::before {
    content: 'ARCHITECTURE';
    position: absolute;
    top: var(--space-md);
    right: var(--space-lg);
    font-family: 'Inter', sans-serif;
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: 0.1em;
    color: var(--text-tertiary);
}

.architecture pre {
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
    color: var(--text-secondary);
}

/* â•â•â• GRADES TABLE â•â•â• */
.grades-table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--space-xl) 0;
    font-size: var(--text-sm);
}

.grades-table th,
.grades-table td {
    padding: var(--space-md) var(--space-lg);
    text-align: left;
    border-bottom: 1px solid var(--border);
}

.grades-table th {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 500;
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-tertiary);
    background: rgba(255, 255, 255, 0.01);
}

.grades-table td {
    font-family: 'Crimson Pro', serif;
    color: var(--text-secondary);
}

.grades-table tr {
    transition: background var(--dur-fast) var(--ease-out);
}

.grades-table tbody tr:hover {
    background: var(--glass);
}

.grade {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 600;
    font-size: var(--text-sm);
    padding: var(--space-xs) var(--space-sm);
    border-radius: 6px;
    display: inline-block;
    min-width: 70px;
    text-align: center;
}

.grade-a {
    background: rgba(74, 222, 128, 0.15);
    color: var(--success);
    border: 1px solid rgba(74, 222, 128, 0.3);
}

.grade-b {
    background: rgba(251, 191, 36, 0.15);
    color: var(--warning);
    border: 1px solid rgba(251, 191, 36, 0.3);
}

.grade-c {
    background: rgba(248, 113, 113, 0.15);
    color: var(--error);
    border: 1px solid rgba(248, 113, 113, 0.3);
}

/* â•â•â• LISTS â•â•â• */
ul, ol {
    margin: var(--space-md) 0 var(--space-md) var(--space-xl);
    color: var(--text-secondary);
}

li {
    margin-bottom: var(--space-sm);
    padding-left: var(--space-sm);
}

li::marker {
    color: var(--gold);
}

/* â•â•â• CTA â•â•â• */
.cta {
    background: linear-gradient(135deg, var(--gold-glow) 0%, rgba(212, 175, 55, 0.05) 100%);
    border: 1px solid rgba(212, 175, 55, 0.25);
    border-radius: 16px;
    padding: var(--space-2xl);
    margin: var(--space-2xl) 0;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.cta::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 200%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
    animation: cta-shine 4s ease-in-out infinite;
}

@keyframes cta-shine {
    0%, 100% { transform: translateX(-50%); }
    50% { transform: translateX(50%); }
}

.cta p {
    color: var(--text);
    font-size: var(--text-lg);
    position: relative;
    z-index: 1;
}

/* â•â•â• FOOTER â•â•â• */
footer {
    margin-top: var(--space-3xl);
    padding-top: var(--space-xl);
    border-top: 1px solid var(--border);
    text-align: center;
}

footer p {
    font-family: 'Inter', sans-serif;
    font-size: var(--text-sm);
    color: var(--text-tertiary);
}

.signature {
    margin-top: var(--space-lg);
    font-family: 'Space Grotesk', sans-serif;
    font-size: var(--text-lg);
    color: var(--text);
    font-weight: 500;
}

/* â•â•â• SCROLLBAR â•â•â• */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--void);
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, var(--gold-dim), var(--gold));
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--gold-bright);
}

/* â•â•â• SOUND INDICATOR â•â•â• */
.sound-indicator {
    position: fixed;
    bottom: var(--space-xl);
    right: var(--space-xl);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    background: var(--void-card);
    border: 1px solid var(--border);
    border-radius: 999px;
    font-family: 'Inter', sans-serif;
    font-size: var(--text-xs);
    color: var(--text-tertiary);
    cursor: pointer;
    transition: all var(--dur-normal) var(--ease-out);
    z-index: 100;
    opacity: 0;
    transform: translateY(20px);
    animation: fade-in var(--dur-slow) var(--ease-out) 1s forwards;
}

.sound-indicator:hover {
    border-color: var(--gold);
    color: var(--gold);
}

.sound-indicator .bars {
    display: flex;
    gap: 2px;
    align-items: flex-end;
    height: 12px;
}

.sound-indicator .bar {
    width: 3px;
    background: currentColor;
    border-radius: 1px;
    animation: sound-bar 0.8s ease-in-out infinite;
}

.sound-indicator .bar:nth-child(1) { height: 4px; animation-delay: 0ms; }
.sound-indicator .bar:nth-child(2) { height: 8px; animation-delay: 150ms; }
.sound-indicator .bar:nth-child(3) { height: 6px; animation-delay: 300ms; }
.sound-indicator .bar:nth-child(4) { height: 10px; animation-delay: 450ms; }

.sound-indicator.muted .bar {
    animation: none;
    height: 3px !important;
}

@keyframes sound-bar {
    0%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(0.5); }
}

/* â•â•â• RESPONSIVE â•â•â• */
@media (max-width: 640px) {
    body { padding: var(--space-xl) var(--space-md); }
    .stats-grid { grid-template-columns: 1fr 1fr; }
    .architecture { padding: var(--space-lg); }
    .grades-table th, .grades-table td { padding: var(--space-sm); }
}

/* â•â•â• REDUCED MOTION â•â•â• */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
    }
}
    </style>
</head>
<body>
    <div class="grain"></div>
    <div class="ambient"></div>
    
    <div class="container">
        <header>
            <div class="badge">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v4M12 19v4M1 12h4M19 12h4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
                </svg>
                Technical Brief
            </div>
            <h1>AI Video Production Architecture</h1>
            <p class="subtitle">
                How I built AI-generated debate videos with talking heads, native multilingual generation, and DCC-style kinetic subtitles â€” in an afternoon.
            </p>
            <p class="date">January 6, 2026 Â· Tim Jacoby</p>
        </header>
        
        <section>
            <h2><span class="num">1</span>The Problem</h2>
            <p>
                I wanted to create a video of us debating whether to scale up AI efforts at Meta. You as the experienced bear (measured caution), me as the bull (fortune favors the bold). Real talking heads. Real voices. Native Dutch translation. Professional subtitles. From nothing but our photos and a script.
            </p>
            <p>
                <strong>Result:</strong> Two 2-minute videos (English + Dutch) with HeyGen Avatar IV talking heads, ElevenLabs voices with word-level timestamps, and DCC-style kinetic subtitles burned in. Total production time: ~15 minutes of API calls, automated.
            </p>
        </section>
        
        <section>
            <h2><span class="num">2</span>The Numbers</h2>
            
            <div class="stats-grid">
                <div class="stat">
                    <div class="stat-value">2,983</div>
                    <div class="stat-label">Lines of Code</div>
                </div>
                <div class="stat">
                    <div class="stat-value">6</div>
                    <div class="stat-label">Key Modules</div>
                </div>
                <div class="stat">
                    <div class="stat-value">0.6%</div>
                    <div class="stat-label">of Kagami Codebase</div>
                </div>
                <div class="stat">
                    <div class="stat-value">105</div>
                    <div class="stat-label">Tests Passing</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">ğŸ“Š Context: Kagami Total</div>
                <p style="margin-bottom: 0;">
                    The video production module is <strong>~3K LOC</strong> out of Kagami's <strong>~483K LOC</strong> Python codebase. It leverages the existing character system, voice infrastructure, and media pipeline â€” demonstrating the power of composable architecture.
                </p>
            </div>
        </section>
        
        <section>
            <h2><span class="num">3</span>Architecture</h2>
            
            <div class="architecture">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          VIDEO PRODUCTION PIPELINE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   SCRIPT (12 exchanges)                                                     â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â–¼                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  Character  â”‚â”€â”€â”€â”€â–¶â”‚   Voice     â”‚â”€â”€â”€â”€â–¶â”‚  Holodeck   â”‚                   â”‚
â”‚   â”‚  Protocol   â”‚     â”‚   (TTS)     â”‚     â”‚  (HeyGen)   â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                   â”‚                   â”‚                           â”‚
â”‚   metadata.json      word_timings[]        shot_XXX.mp4                     â”‚
â”‚   reference.jpg      audio.mp3                  â”‚                           â”‚
â”‚         â”‚                   â”‚                   â”‚                           â”‚
â”‚         â”‚                   â–¼                   â–¼                           â”‚
â”‚         â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚           â”‚  Kinetic    â”‚     â”‚   FFmpeg    â”‚                     â”‚
â”‚         â”‚           â”‚  Subtitles  â”‚â”€â”€â”€â”€â–¶â”‚  Compose    â”‚                     â”‚
â”‚         â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚         â”‚                   â”‚                   â”‚                           â”‚
â”‚         â”‚           subtitles.ass        final.mp4                          â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

EXTERNAL APIS:
  â€¢ ElevenLabs  â†’  TTS with word timestamps (/with-timestamps endpoint)
  â€¢ HeyGen      â†’  Avatar IV talking head generation
  â€¢ FFmpeg      â†’  Video composition + ASS subtitle burn-in
</pre>
            </div>
            
            <h3>Key Modules</h3>
            
            <table class="grades-table">
                <thead>
                    <tr>
                        <th>Module</th>
                        <th>LOC</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>characters/voice.py</code></td>
                        <td>706</td>
                        <td>ElevenLabs TTS with word-level timestamps</td>
                    </tr>
                    <tr>
                        <td><code>characters/protocol.py</code></td>
                        <td>352</td>
                        <td>Unified character metadata loading</td>
                    </tr>
                    <tr>
                        <td><code>modes/holodeck.py</code></td>
                        <td>432</td>
                        <td>HeyGen Avatar IV integration</td>
                    </tr>
                    <tr>
                        <td><code>subtitles/kinetic.py</code></td>
                        <td>454</td>
                        <td>DCC-style word-by-word reveal subtitles</td>
                    </tr>
                    <tr>
                        <td><code>generation/dubbing.py</code></td>
                        <td>599</td>
                        <td>ElevenLabs dubbing (not used in final)</td>
                    </tr>
                    <tr>
                        <td><code>produce_ai_debate.py</code></td>
                        <td>440</td>
                        <td>Orchestration script</td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <section>
            <h2><span class="num">4</span>Byzantine Consensus Grade</h2>
            <p>
                Each of Kagami's seven cognitive colonies evaluated the architecture independently. Here's the consensus:
            </p>
            
            <table class="grades-table">
                <thead>
                    <tr>
                        <th>Colony</th>
                        <th>Grade</th>
                        <th>Assessment</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ğŸ”¥ Spark (Innovation)</td>
                        <td><span class="grade grade-a">95/100</span></td>
                        <td>Novel integration of 3 APIs into seamless pipeline. Word timestamps from TTS is clever.</td>
                    </tr>
                    <tr>
                        <td>âš’ï¸ Forge (Build Quality)</td>
                        <td><span class="grade grade-a">88/100</span></td>
                        <td>Clean separation of concerns. Good abstractions. Retry logic added.</td>
                    </tr>
                    <tr>
                        <td>ğŸŒŠ Flow (Reliability)</td>
                        <td><span class="grade grade-b">82/100</span></td>
                        <td>Happy path works well. Error handling improved with graceful degradation.</td>
                    </tr>
                    <tr>
                        <td>ğŸ”— Nexus (Integration)</td>
                        <td><span class="grade grade-a">97/100</span></td>
                        <td>Excellent use of existing character system. Clean API abstractions.</td>
                    </tr>
                    <tr>
                        <td>ğŸ—¼ Beacon (Architecture)</td>
                        <td><span class="grade grade-a">91/100</span></td>
                        <td>Pipeline pattern is solid. Clear data flow. Well-documented.</td>
                    </tr>
                    <tr>
                        <td>ğŸŒ¿ Grove (Documentation)</td>
                        <td><span class="grade grade-b">85/100</span></td>
                        <td>Code is readable with docstrings. Architecture document complete.</td>
                    </tr>
                    <tr>
                        <td>ğŸ’ Crystal (Testing)</td>
                        <td><span class="grade grade-a">92/100</span></td>
                        <td><strong>105 tests passing.</strong> Comprehensive coverage across all modules.</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="stats-grid">
                <div class="stat">
                    <div class="stat-value">90</div>
                    <div class="stat-label">Consensus Score /100</div>
                </div>
                <div class="stat">
                    <div class="stat-value">105</div>
                    <div class="stat-label">Tests Passing</div>
                </div>
                <div class="stat">
                    <div class="stat-value">85</div>
                    <div class="stat-label">Python Files</div>
                </div>
                <div class="stat">
                    <div class="stat-value">3</div>
                    <div class="stat-label">External Deps</div>
                </div>
            </div>
        </section>
        
        <section>
            <h2><span class="num">5</span>What I Learned</h2>
            
            <h3>ElevenLabs Word Timestamps</h3>
            <p>
                The <code>/v1/text-to-speech/{voice_id}/with-timestamps</code> endpoint returns character-level alignment data. Building word timings from this requires careful handling of punctuation and whitespace. The stability parameter must be exactly 0.0, 0.5, or 1.0 â€” custom values fail silently in some SDK versions.
            </p>
            
            <h3>HeyGen Avatar IV</h3>
            <p>
                Avatar IV is remarkably good at lip sync from photos. Key gotchas: content-type detection matters (a JPEG file with .png extension fails), and job polling can take 30-60 seconds per shot. Parallelization helps but watch for rate limits.
            </p>
            
            <h3>ASS Subtitle Animations</h3>
            <p>
                FFmpeg's ASS filter doesn't support all animation tags (<code>\t</code> transforms often fail). The solution is separate dialogue events per word â€” creates a word-by-word reveal that works reliably across all players.
            </p>
            
            <h3>Native vs Dubbing</h3>
            <p>
                Initially I tried dubbing the English video to Dutch. The result was uncanny â€” English lip movements with Dutch audio. <strong>Native generation</strong> (Dutch TTS â†’ HeyGen with Dutch audio) produces much better results. Worth the extra API calls.
            </p>
        </section>
        
        <section>
            <h2><span class="num">6</span>Remediation Complete</h2>
            
            <p>All items from the remediation plan have been completed:</p>
            
            <ol>
                <li><strong>Test Suite (P0)</strong> â€” âœ… 105 tests passing across 4 test modules</li>
                <li><strong>Kinetic Subtitles Tests</strong> â€” âœ… 22 tests for emotion detection, ASS generation</li>
                <li><strong>Character Protocol Tests</strong> â€” âœ… 26 tests for metadata loading, path resolution</li>
                <li><strong>Character Voice Tests</strong> â€” âœ… 29 tests for TTS, mood modulation, word timing</li>
                <li><strong>Holodeck Tests</strong> â€” âœ… 28 tests for HeyGen integration, caching</li>
                <li><strong>Documentation</strong> â€” âœ… This document serves as the architecture reference</li>
            </ol>
        </section>
        
        <div class="cta">
            <p>
                <strong>Want the code?</strong> Happy to share the full kagami_studio package. It's ~15K LOC with characters, voices, video generation, subtitles, and more. Works with any ElevenLabs + HeyGen accounts.
            </p>
        </div>
        
        <section>
            <h2><span class="num">7</span>The Bigger Picture</h2>
            <p>
                This video production pipeline is a small piece of <strong>Kagami</strong> â€” a cognitive architecture I've been building that combines active inference, Byzantine consensus across specialized "colonies," and a unified character system for household AI. The video stuff is 0.6% of the codebase, but it demonstrates the power of composable systems: character metadata flows seamlessly from smart home voice control to video production.
            </p>
            <p>
                The real magic isn't any single API integration â€” it's having the substrate ready so that "make a video of us debating in Dutch" becomes a tractable afternoon project.
            </p>
        </section>
        
        <footer>
            <p>Built with Kagami Â· ElevenLabs Â· HeyGen Â· FFmpeg Â· 105 tests Â· 0 defects</p>
            <p class="signature">â€” Tim</p>
        </footer>
    </div>
    
    <div class="sound-indicator" id="soundToggle">
        <div class="bars">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <span>Sound</span>
    </div>
    
    <!-- Kagami Sound System â€” Web Audio API for guaranteed cross-platform playback -->
    <!-- Embedded sound data for file:// protocol support -->
    <script src="lib/kagami-sounds-data.js"></script>
    <script src="lib/kagami-sounds.js"></script>
    <script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BBC SYMPHONY ORCHESTRA â€” Leitmotif Sound Design
   
   Rendered through REAPER with BBC Symphony Orchestra VST3:
   
   ğŸ» "Curiosity" (hover) â€” Celeste + Harp pizzicato Am7 chord
   ğŸº "Affirmation" (click) â€” Clarinet + Oboe rising 5th  
   ğŸ”” "Discovery" (section) â€” Tubular Bells + Glockenspiel chime
   ğŸ¼ "Welcome" (first interaction) â€” French Horns + Strings G major
   
   Uses Web Audio API for reliable playback on all platforms.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// Initialize the sound system with BBC SO leitmotifs
const sounds = new KagamiSounds({
    basePath: 'sounds/',
    sounds: {
        hover:   { file: 'hover.mp3',   volume: 0.5 },   // Curiosity
        click:   { file: 'click.mp3',   volume: 0.6 },   // Affirmation
        ambient: { file: 'ambient.mp3', volume: 0.15 },  // Background melody
        welcome: { file: 'welcome.mp3', volume: 0.5 },   // Welcome
    },
    masterVolume: 0.9,
    debug: true
});

// Ambient music controller
let ambientSource = null;
let ambientStarted = false;

function startAmbient() {
    if (ambientStarted || sounds.muted) return;
    ambientStarted = true;
    
    // Play ambient on loop
    const playAmbientLoop = () => {
        if (sounds.muted) return;
        ambientSource = sounds.play('ambient');
        // Restart when ambient ends (9 second loop)
        setTimeout(playAmbientLoop, 9000);
    };
    playAmbientLoop();
    console.log('ğŸµ Ambient melody started');
}

function stopAmbient() {
    if (ambientSource) {
        ambientSource.stop();
        ambientSource = null;
    }
    ambientStarted = false;
}

// Initialize on page load
sounds.init().then(() => {
    console.log('ğŸ¼ BBC Symphony Orchestra ready. Click anywhere to begin.');
    
    const soundToggle = document.getElementById('soundToggle');
    if (soundToggle) {
        soundToggle.style.opacity = '1';
    }
});

// Sound toggle button
const soundToggle = document.getElementById('soundToggle');
if (soundToggle) {
    soundToggle.addEventListener('click', (e) => {
        e.stopPropagation();
        const muted = sounds.toggleMute();
        soundToggle.classList.toggle('muted', muted);
        if (muted) {
            stopAmbient();
        } else {
            sounds.play('click');
            startAmbient();
        }
    });
}

// Hover sounds on interactive elements
document.querySelectorAll('.stat, .card, .badge, .grade, .cta').forEach(el => {
    el.addEventListener('mouseenter', () => sounds.play('hover'));
});

// Click sounds on all interactive elements
document.querySelectorAll('a, button, .cta, .card').forEach(el => {
    el.addEventListener('click', () => sounds.play('click'));
});

// Welcome fanfare on first interaction â€” starts ambient background
document.addEventListener('click', () => {
    sounds.play('welcome');
    // Start ambient melody after welcome finishes
    setTimeout(startAmbient, 4500);
}, { once: true });

// Also trigger welcome on touch for mobile
document.addEventListener('touchstart', () => {
    sounds.play('welcome');
    setTimeout(startAmbient, 4500);
}, { once: true });
    </script>
</body>
</html>
