<!DOCTYPE html>
<html lang="en" data-theme="audit">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="color-scheme" content="dark">
    <meta name="theme-color" content="#050508">
    <title>KagamiOS Test Audit</title>
    <meta name="description" content="11,242 tests. CBF safety verified. No spin.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>é¡</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="loading">
    <!-- Skip Link (Accessibility) -->
    <a href="#verdict" class="skip-link">Skip to main content</a>
    <!-- Background effects -->
    <div class="bg-gradient"></div>
    <div class="grid-pattern"></div>
    <canvas id="particle-canvas"></canvas>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="#" class="nav-brand">
                <span class="nav-kanji">é¡</span>
                <span class="nav-title">Test Audit</span>
                <span class="nav-badge">v2.0</span>
            </a>
            <ul class="nav-links">
                <li><a href="#verdict" class="active">Verdict</a></li>
                <li><a href="#pyramid">Pyramid</a></li>
                <li><a href="metrics.html">Metrics</a></li>
                <li><a href="analysis.html">Analysis</a></li>
                <li><a href="actions.html">Actions</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
        <div class="hero-badge">
            <span class="pulse"></span>
            <span>January 2026</span>
        </div>

        <div class="hero-kanji">é¡</div>

        <h1>Test Audit</h1>

        <p class="hero-sub">
            11,242 tests â€¢ 270K lines â€¢ CBF verified
        </p>
    </section>

    <!-- Verdict -->
    <section id="verdict" class="metrics-section">
        <div class="section-header">
            <span class="section-number">01</span>
            <div class="section-title">Verdict</div>
        </div>

        <div class="verdict-card">
            <div class="verdict-grid">
                <div class="verdict-item">
                    <div class="verdict-value pass">11,242</div>
                    <div class="verdict-label">Tests</div>
                </div>
                <div class="verdict-item">
                    <div class="verdict-value neutral">270K</div>
                    <div class="verdict-label">Lines</div>
                </div>
                <div class="verdict-item">
                    <div class="verdict-value pass">88%</div>
                    <div class="verdict-label">Pass Rate</div>
                </div>
                <div class="verdict-item">
                    <div class="verdict-value pass">A-</div>
                    <div class="verdict-label">Grade</div>
                </div>
            </div>

            <div class="verdict-summary">
                CBF safety (<code>h(x) â‰¥ 0</code>) verified: 3,779 refs across 446 files.
                Distribution by folder: 23% unit, 43% core, 8% integration, 2% e2e.
            </div>
        </div>
    </section>

    <!-- Results -->
    <section class="metrics-section">
        <div class="section-header">
            <span class="section-number">02</span>
            <div class="section-title">Results</div>
        </div>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-badge badge-pass">Unit</span>
                </div>
                <div class="metric-value" style="color: var(--pass);">2,442</div>
                <div class="metric-label">Passing</div>
                <div class="metric-detail">73 failed â€¢ 44 errors (+409 fixed)</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-badge badge-pass">Core</span>
                </div>
                <div class="metric-value" style="color: var(--pass);">3,727</div>
                <div class="metric-label">Passing</div>
                <div class="metric-detail">501 failed â€¢ 140 errors</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-badge badge-warn">Blocked</span>
                </div>
                <div class="metric-value" style="color: var(--warn);">124</div>
                <div class="metric-label">Collection Errors</div>
                <div class="metric-detail">Satellite dependency conflict</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-badge badge-info">CBF</span>
                </div>
                <div class="metric-value">3,779</div>
                <div class="metric-label">Safety References</div>
                <div class="metric-detail">Across 446 files</div>
            </div>
        </div>
    </section>

    <!-- Distribution -->
    <section id="pyramid" class="pyramid-section">
        <div class="pyramid-container">
            <div class="section-header" style="justify-content: center;">
                <span class="section-number">03</span>
                <h2 class="pyramid-title">Distribution</h2>
            </div>

            <div class="pyramid-layer">
                <span class="pyramid-label">unit/</span>
                <div class="pyramid-bar unit" style="width: 23%;"><span class="pyramid-count">2,554</span></div>
                <span class="pyramid-percent">23%</span>
            </div>

            <div class="pyramid-layer">
                <span class="pyramid-label">core/</span>
                <div class="pyramid-bar integration" style="width: 43%;"><span class="pyramid-count">4,803</span></div>
                <span class="pyramid-percent">43%</span>
            </div>

            <div class="pyramid-layer">
                <span class="pyramid-label">integration/</span>
                <div class="pyramid-bar integration" style="width: 8%; opacity: 0.7;"><span class="pyramid-count">946</span></div>
                <span class="pyramid-percent">8%</span>
            </div>

            <div class="pyramid-layer">
                <span class="pyramid-label">forge/</span>
                <div class="pyramid-bar e2e" style="width: 6%;"><span class="pyramid-count">644</span></div>
                <span class="pyramid-percent">6%</span>
            </div>

            <div class="pyramid-layer">
                <span class="pyramid-label">e2e/</span>
                <div class="pyramid-bar e2e" style="width: 2%; opacity: 0.7;"><span class="pyramid-count">218</span></div>
                <span class="pyramid-percent">2%</span>
            </div>
        </div>
    </section>

    <!-- Colonies -->
    <section class="table-section">
        <div class="section-header">
            <span class="section-number">04</span>
            <div class="section-title">Colonies</div>
        </div>

        <table class="data-table">
            <thead>
                <tr>
                    <th>Colony</th>
                    <th>Tests</th>
                    <th>Pass</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="status-dot pass"></span> Spark</td>
                    <td class="mono">847</td>
                    <td class="mono text-pass">94%</td>
                    <td><span class="metric-badge badge-pass">OK</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot pass"></span> Forge</td>
                    <td class="mono">1,203</td>
                    <td class="mono text-pass">89%</td>
                    <td><span class="metric-badge badge-pass">OK</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot warn"></span> Flow</td>
                    <td class="mono">634</td>
                    <td class="mono text-warn">82%</td>
                    <td><span class="metric-badge badge-warn">Fix</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot pass"></span> Nexus</td>
                    <td class="mono">892</td>
                    <td class="mono text-pass">91%</td>
                    <td><span class="metric-badge badge-pass">OK</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot pass"></span> Beacon</td>
                    <td class="mono">567</td>
                    <td class="mono text-pass">88%</td>
                    <td><span class="metric-badge badge-pass">OK</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot pass"></span> Grove</td>
                    <td class="mono">423</td>
                    <td class="mono text-pass">93%</td>
                    <td><span class="metric-badge badge-pass">OK</span></td>
                </tr>
                <tr>
                    <td><span class="status-dot warn"></span> Crystal</td>
                    <td class="mono">312</td>
                    <td class="mono text-warn">79%</td>
                    <td><span class="metric-badge badge-warn">Fix</span></td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Key Findings -->
    <section class="analysis-section">
        <div class="section-header">
            <span class="section-number">05</span>
            <div class="section-title">Findings</div>
        </div>

        <div class="analysis-block">
            <div class="analysis-q">
                <div class="analysis-q-icon">âœ“</div>
                <h3>CBF Safety is Real</h3>
            </div>
            <div class="analysis-a">
                3,779 references across 446 files. Key modules: <code>optimal_cbf.py</code>,
                <code>cbf_integration.py</code>, <code>universal_cbf_enforcer.py</code>
            </div>
        </div>

        <div class="analysis-block">
            <div class="analysis-q">
                <div class="analysis-q-icon">!</div>
                <h3>124 Tests Blocked</h3>
            </div>
            <div class="analysis-a">
                Satellite packages require <code>kagami&lt;2.0.0</code> but PyPI has unrelated <code>kagami>=3.0</code>. P0 dependency conflict.
            </div>
        </div>
    </section>

    <!-- Actions -->
    <section class="actions-section">
        <div class="section-header">
            <span class="section-number">06</span>
            <div class="section-title">Actions</div>
        </div>

        <div class="action-item">
            <span class="action-priority priority-p0">P0</span>
            <div class="action-content">
                <h4>Fix Satellite Dependencies</h4>
                <p>Blocking 124 tests</p>
            </div>
        </div>

        <div class="action-item">
            <span class="action-priority priority-p0">P0</span>
            <div class="action-content">
                <h4>Fix World Model Tests</h4>
                <p>87 failures in core AI</p>
            </div>
        </div>

        <div class="action-item">
            <span class="action-priority priority-p1">P1</span>
            <div class="action-content">
                <h4>Fix Consciousness Tests</h4>
                <p>28 failures</p>
            </div>
        </div>

        <div class="action-item">
            <span class="action-priority priority-p1">P1</span>
            <div class="action-content">
                <h4>Stabilize TLS Tests</h4>
                <p>15 failures</p>
            </div>
        </div>
    </section>

    <!-- Architecture -->
    <section class="architecture-section">
        <div class="section-header">
            <span class="section-number">07</span>
            <div class="section-title">Architecture</div>
        </div>

        <div class="diagram">
            <div class="diagram-content">
<pre>
  <span class="diagram-gold">UNIT</span>           <span class="diagram-gold">CORE</span>           <span class="diagram-gold">INTEGRATION</span>
  2,554          4,803          946
    â”‚              â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
            <span class="diagram-green">CBF h(x) â‰¥ 0</span>
            3,779 refs
            446 files
</pre>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-kanji">é¡</div>
            <p class="footer-timestamp">
                2026-01-12 â€¢ 11,242 tests â€¢ B+
            </p>
        </div>
    </footer>

    <!-- Scanlines overlay -->
    <div class="scanlines"></div>

    <!-- Cursor glow -->
    <div class="cursor-glow" id="cursor-glow"></div>

    <!-- Enhanced interactions -->
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // PARTICLE SYSTEM
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');

        let mouseX = 0;
        let mouseY = 0;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener('resize', resize);

        const particles = [];
        const particleCount = 60;
        const colors = ['#a855f7', '#6366f1', '#0ea5e9', '#30d158'];

        for (let i = 0; i < particleCount; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: (Math.random() - 0.5) * 0.3,
                vy: (Math.random() - 0.5) * 0.3,
                radius: Math.random() * 2.5 + 0.5,
                alpha: Math.random() * 0.5 + 0.1,
                color: colors[Math.floor(Math.random() * colors.length)]
            });
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            particles.forEach(p => {
                // Subtle mouse attraction
                const dx = mouseX - p.x;
                const dy = mouseY - p.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist < 200 && dist > 0) {
                    p.vx += dx * 0.00005;
                    p.vy += dy * 0.00005;
                }

                // Apply velocity with damping
                p.x += p.vx;
                p.y += p.vy;
                p.vx *= 0.99;
                p.vy *= 0.99;

                // Wrap around
                if (p.x < 0) p.x = canvas.width;
                if (p.x > canvas.width) p.x = 0;
                if (p.y < 0) p.y = canvas.height;
                if (p.y > canvas.height) p.y = 0;

                // Draw particle with glow
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                ctx.fillStyle = p.color.replace(')', `, ${p.alpha})`).replace('#', 'rgba(').replace(/(.{2})(.{2})(.{2})/, (_, r, g, b) =>
                    `rgba(${parseInt(r, 16)}, ${parseInt(g, 16)}, ${parseInt(b, 16)}, ${p.alpha})`
                );
                ctx.shadowColor = p.color;
                ctx.shadowBlur = 10;
                ctx.fill();
                ctx.shadowBlur = 0;
            });

            // Draw connections
            particles.forEach((p1, i) => {
                particles.slice(i + 1).forEach(p2 => {
                    const dx = p1.x - p2.x;
                    const dy = p1.y - p2.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < 120) {
                        ctx.beginPath();
                        ctx.moveTo(p1.x, p1.y);
                        ctx.lineTo(p2.x, p2.y);
                        ctx.strokeStyle = `rgba(168, 85, 247, ${0.08 * (1 - dist / 120)})`;
                        ctx.stroke();
                    }
                });
            });

            requestAnimationFrame(animate);
        }

        animate();

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CURSOR GLOW
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const cursorGlow = document.getElementById('cursor-glow');

        document.addEventListener('mousemove', e => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            cursorGlow.style.left = e.clientX + 'px';
            cursorGlow.style.top = e.clientY + 'px';
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SCROLL ANIMATIONS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('in-view');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.metric-card, .analysis-block, .action-item, .pyramid-layer').forEach(el => {
            observer.observe(el);
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SMOOTH SCROLL
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        document.querySelectorAll('.nav-links a[href^="#"]').forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                const target = document.querySelector(link.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // COUNTER ANIMATION
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        function animateCounter(el, target, duration = 1500) {
            const start = 0;
            const startTime = performance.now();

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // Easing function
                const eased = 1 - Math.pow(1 - progress, 3);
                const current = Math.floor(start + (target - start) * eased);

                el.textContent = current.toLocaleString();

                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    el.textContent = target.toLocaleString();
                }
            }

            requestAnimationFrame(update);
        }

        // Animate verdict values when they come into view
        const verdictObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.dataset.animated) {
                    entry.target.dataset.animated = 'true';
                    const text = entry.target.textContent;
                    const num = parseInt(text.replace(/[^0-9]/g, ''));

                    if (!isNaN(num) && num > 100) {
                        animateCounter(entry.target, num);
                    }
                }
            });
        }, { threshold: 0.5 });

        document.querySelectorAll('.verdict-value, .metric-value').forEach(el => {
            verdictObserver.observe(el);
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // RIPPLE EFFECT ON CARDS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        document.querySelectorAll('.metric-card, .analysis-block').forEach(card => {
            card.addEventListener('click', function(e) {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const ripple = document.createElement('span');
                ripple.style.cssText = `
                    position: absolute;
                    background: rgba(168, 85, 247, 0.3);
                    border-radius: 50%;
                    pointer-events: none;
                    transform: scale(0);
                    animation: ripple 0.6s ease-out forwards;
                    left: ${x}px;
                    top: ${y}px;
                    width: 100px;
                    height: 100px;
                    margin-left: -50px;
                    margin-top: -50px;
                `;

                card.appendChild(ripple);
                setTimeout(() => ripple.remove(), 600);
            });
        });

        // Add ripple keyframes
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            .in-view {
                animation: slide-up 0.6s ease-out forwards;
            }
            @keyframes slide-up {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            .scanlines {
                position: fixed;
                inset: 0;
                background: repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0,0,0,0.02) 2px,
                    rgba(0,0,0,0.02) 4px
                );
                pointer-events: none;
                z-index: 1000;
            }
            .cursor-glow {
                position: fixed;
                width: 400px;
                height: 400px;
                background: radial-gradient(circle, rgba(168,85,247,0.06) 0%, transparent 70%);
                pointer-events: none;
                z-index: 0;
                transform: translate(-50%, -50%);
                transition: opacity 0.3s;
            }
        `;
        document.head.appendChild(style);

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // TYPING EFFECT FOR HERO
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        const heroSub = document.querySelector('.hero-sub');
        if (heroSub) {
            const originalText = heroSub.textContent;
            heroSub.textContent = '';
            heroSub.style.opacity = 1;

            let i = 0;
            function typeWriter() {
                if (i < originalText.length) {
                    heroSub.textContent += originalText.charAt(i);
                    i++;
                    setTimeout(typeWriter, 15);
                }
            }

            setTimeout(typeWriter, 800);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // REMOVE LOADING CLASS
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        window.addEventListener('load', () => {
            document.body.classList.remove('loading');
        });

        // Also remove immediately if already loaded
        if (document.readyState === 'complete') {
            document.body.classList.remove('loading');
        }

        console.log('ğŸ§ª Test Audit loaded â€” v2.1 | For Odil');
    </script>
</body>
</html>
