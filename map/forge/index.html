<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    <title>Forge ¬∑ Kagami Character Generation</title>
    <meta name="description" content="Forge: Text-to-3D character generation, facial animation, rigging, personality AI, and multi-format export. 34,689 lines of Python across 111 files.">
    <meta name="theme-color" content="#0A0806">
    <meta name="color-scheme" content="dark">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî®</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <a href="#overview" class="skip-link">Skip to main content</a>

    <nav class="nav">
        <div class="nav-inner">
            <a href="../map/" class="nav-logo">ü™û Kagami</a>
            <div class="nav-links">
                <a href="#overview" class="nav-link">Overview</a>
                <a href="#pipeline" class="nav-link">Pipeline</a>
                <a href="#modules" class="nav-link">Modules</a>
                <a href="#rooms" class="nav-link">Rooms</a>
                <a href="#api" class="nav-link">API</a>
            </div>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-icon">üî®</div>
        <h1 class="hero-title">Forge</h1>
        <p class="hero-subtitle">Character Generation System</p>
        <p class="hero-desc">
            Text-to-3D character generation with facial animation, skeleton rigging,
            personality AI, and multi-format export. Full production pipeline.
        </p>
        <div class="hero-stats">
            <div class="stat">
                <span class="stat-value">34.7K</span>
                <span class="stat-label">Lines of Code</span>
            </div>
            <div class="stat">
                <span class="stat-value">111</span>
                <span class="stat-label">Python Files</span>
            </div>
            <div class="stat">
                <span class="stat-value">9</span>
                <span class="stat-label">Export Formats</span>
            </div>
        </div>
    </header>

    <main>
        <!-- Overview -->
        <section class="section" id="overview">
            <div class="section-header">
                <p class="section-number">01</p>
                <h2 class="section-title">System Architecture</h2>
                <p class="section-desc">
                    ForgeService orchestrates the complete character generation pipeline
                    from text prompt to exportable 3D assets.
                </p>
            </div>

            <div class="verified">
                <div class="verified-header">‚úì VERIFIED LOC COUNTS (wc -l)</div>
                <pre>service.py:      610 LOC    schema.py:       754 LOC    safety.py:        121 LOC
orchestrator.py: 368 LOC    streaming.py:    129 LOC    rooms_export.py: 1,128 LOC
visual_design/:  3,214 LOC  motion/:        3,861 LOC   behavior_ai/:    1,472 LOC
export/:         3,112 LOC  conversation/:  1,930 LOC   TOTAL:          34,689 LOC</pre>
            </div>

            <div class="architecture">
                <h3 class="architecture-title">packages/kagami/forge/</h3>
                <svg class="architecture-svg" viewBox="0 0 900 480" role="img">
                    <defs>
                        <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" stop-color="#FB923C" stop-opacity="0.2"/>
                            <stop offset="100%" stop-color="#FBBF24" stop-opacity="0.2"/>
                        </linearGradient>
                    </defs>

                    <rect x="20" y="10" width="860" height="460" rx="8" fill="none" stroke="#FB923C" stroke-width="1" opacity="0.2"/>

                    <text x="450" y="40" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="11" font-weight="600">ENTRY LAYER</text>

                    <g>
                        <rect x="40" y="55" width="260" height="65" rx="6" fill="#FB923C" fill-opacity="0.1" stroke="#FB923C"/>
                        <text x="170" y="80" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">ForgeService</text>
                        <text x="170" y="98" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">execute() ¬∑ generate_character()</text>
                        <text x="170" y="112" text-anchor="middle" fill="#FB923C" font-family="IBM Plex Mono" font-size="10" font-weight="600">610 LOC ‚úì</text>
                    </g>

                    <g>
                        <rect x="320" y="55" width="240" height="65" rx="6" fill="#60A5FA" fill-opacity="0.1" stroke="#60A5FA"/>
                        <text x="440" y="80" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">SemanticCache</text>
                        <text x="440" y="98" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">similarity matching ¬∑ TTL=1hr</text>
                        <text x="440" y="112" text-anchor="middle" fill="#60A5FA" font-family="IBM Plex Mono" font-size="10" font-weight="600">semantic_cache.py</text>
                    </g>

                    <g>
                        <rect x="580" y="55" width="260" height="65" rx="6" fill="#EF4444" fill-opacity="0.1" stroke="#EF4444"/>
                        <text x="710" y="80" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">SafetyGate</text>
                        <text x="710" y="98" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">ethical() ¬∑ threat() ¬∑ fail_closed</text>
                        <text x="710" y="112" text-anchor="middle" fill="#EF4444" font-family="IBM Plex Mono" font-size="10" font-weight="600">121 LOC ‚úì</text>
                    </g>

                    <text x="450" y="150" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="11" font-weight="600">ORCHESTRATION</text>

                    <g>
                        <rect x="40" y="165" width="820" height="55" rx="6" fill="#A78BFA" fill-opacity="0.1" stroke="#A78BFA"/>
                        <text x="450" y="192" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">ForgeMatrix ¬∑ Orchestrator</text>
                        <text x="450" y="210" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">ComponentRegistry ¬∑ StageExecution ¬∑ <tspan fill="#A78BFA" font-weight="600">368 LOC ‚úì</tspan></text>
                    </g>

                    <text x="450" y="250" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="11" font-weight="600">GENERATION MODULES</text>

                    <g>
                        <rect x="40" y="265" width="155" height="70" rx="6" fill="#FBBF24" fill-opacity="0.1" stroke="#FBBF24"/>
                        <text x="117" y="290" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="12" font-weight="600">Visual Design</text>
                        <text x="117" y="306" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="9">6 files</text>
                        <text x="117" y="322" text-anchor="middle" fill="#FBBF24" font-family="IBM Plex Mono" font-size="10" font-weight="600">3,214 LOC ‚úì</text>
                    </g>

                    <g>
                        <rect x="210" y="265" width="135" height="70" rx="6" fill="#34D399" fill-opacity="0.1" stroke="#34D399"/>
                        <text x="277" y="290" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="12" font-weight="600">Rigging</text>
                        <text x="277" y="306" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="9">UniRig ¬∑ Skeleton</text>
                        <text x="277" y="322" text-anchor="middle" fill="#34D399" font-family="IBM Plex Mono" font-size="10" font-weight="600">modules/rigging/</text>
                    </g>

                    <g>
                        <rect x="360" y="265" width="155" height="70" rx="6" fill="#F472B6" fill-opacity="0.1" stroke="#F472B6"/>
                        <text x="437" y="290" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="12" font-weight="600">Motion</text>
                        <text x="437" y="306" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="9">9 files</text>
                        <text x="437" y="322" text-anchor="middle" fill="#F472B6" font-family="IBM Plex Mono" font-size="10" font-weight="600">3,861 LOC ‚úì</text>
                    </g>

                    <g>
                        <rect x="530" y="265" width="155" height="70" rx="6" fill="#A78BFA" fill-opacity="0.1" stroke="#A78BFA"/>
                        <text x="607" y="290" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="12" font-weight="600">Behavior AI</text>
                        <text x="607" y="306" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="9">4 files</text>
                        <text x="607" y="322" text-anchor="middle" fill="#A78BFA" font-family="IBM Plex Mono" font-size="10" font-weight="600">1,472 LOC ‚úì</text>
                    </g>

                    <g>
                        <rect x="700" y="265" width="155" height="70" rx="6" fill="#4ADE80" fill-opacity="0.1" stroke="#4ADE80"/>
                        <text x="777" y="290" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="12" font-weight="600">Conversation</text>
                        <text x="777" y="306" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="9">6 files</text>
                        <text x="777" y="322" text-anchor="middle" fill="#4ADE80" font-family="IBM Plex Mono" font-size="10" font-weight="600">1,930 LOC ‚úì</text>
                    </g>

                    <text x="450" y="365" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="11" font-weight="600">OUTPUT LAYER</text>

                    <g>
                        <rect x="40" y="380" width="400" height="70" rx="6" fill="#60A5FA" fill-opacity="0.1" stroke="#60A5FA"/>
                        <text x="240" y="405" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">Export Manager</text>
                        <text x="240" y="423" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">FBX ¬∑ GLTF ¬∑ USD ¬∑ OBJ ¬∑ DAE ¬∑ PLY ¬∑ STL ¬∑ X3D</text>
                        <text x="240" y="440" text-anchor="middle" fill="#60A5FA" font-family="IBM Plex Mono" font-size="10" font-weight="600">12 files ¬∑ 3,112 LOC ‚úì</text>
                    </g>

                    <g>
                        <rect x="460" y="380" width="400" height="70" rx="6" fill="#FB923C" fill-opacity="0.1" stroke="#FB923C"/>
                        <text x="660" y="405" text-anchor="middle" fill="#F8F4EF" font-family="IBM Plex Sans" font-size="13" font-weight="600">Rooms Export</text>
                        <text x="660" y="423" text-anchor="middle" fill="#9A8E7E" font-family="IBM Plex Mono" font-size="10">CRDT sync ¬∑ HybridLogicalClock ¬∑ LWW-Register</text>
                        <text x="660" y="440" text-anchor="middle" fill="#FB923C" font-family="IBM Plex Mono" font-size="10" font-weight="600">1,128 LOC ‚úì</text>
                    </g>

                    <defs>
                        <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                            <polygon points="0 0, 8 3, 0 6" fill="#FB923C"/>
                        </marker>
                    </defs>
                    <line x1="170" y1="120" x2="170" y2="160" stroke="#FB923C" stroke-width="1.5" marker-end="url(#arrow)" opacity="0.6"/>
                    <line x1="450" y1="220" x2="450" y2="260" stroke="#A78BFA" stroke-width="1.5" marker-end="url(#arrow)" opacity="0.6"/>
                    <line x1="240" y1="335" x2="240" y2="375" stroke="#60A5FA" stroke-width="1.5" marker-end="url(#arrow)" opacity="0.6"/>
                    <line x1="660" y1="335" x2="660" y2="375" stroke="#FB923C" stroke-width="1.5" marker-end="url(#arrow)" opacity="0.6"/>
                </svg>
            </div>
        </section>

        <!-- Pipeline -->
        <section class="section" id="pipeline">
            <div class="section-header">
                <p class="section-number">02</p>
                <h2 class="section-title">Generation Pipeline</h2>
                <p class="section-desc">
                    8-stage pipeline from text concept to exportable 3D character.
                </p>
            </div>

            <div class="pipeline-stages">
                <div class="pipeline-stage"><div class="stage-box">üìù Concept</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">üé® Visual</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">ü¶¥ Rigging</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">üé¨ Animation</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">üß† Personality</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">üåç World</div><span class="stage-arrow">‚Üí</span></div>
                <div class="pipeline-stage"><div class="stage-box">üì¶ Export</div></div>
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th>Stage</th>
                        <th>Module</th>
                        <th>Key File</th>
                        <th>LOC</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>1. Visual Design</strong></td>
                        <td><code>modules/visual_design/</code></td>
                        <td>character_profiler.py</td>
                        <td>3,214</td>
                    </tr>
                    <tr>
                        <td><strong>2. Rigging</strong></td>
                        <td><code>modules/rigging/</code></td>
                        <td>UniRig skeleton binding</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>3. Animation</strong></td>
                        <td><code>modules/motion/</code></td>
                        <td>facial_animator.py (1,065 LOC)</td>
                        <td>3,861</td>
                    </tr>
                    <tr>
                        <td><strong>4. Personality</strong></td>
                        <td><code>modules/behavior_ai/</code></td>
                        <td>personality_engine.py (724 LOC)</td>
                        <td>1,472</td>
                    </tr>
                    <tr>
                        <td><strong>5. Voice</strong></td>
                        <td><code>modules/voice/</code></td>
                        <td>TTS profile generation</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>6. Narrative</strong></td>
                        <td><code>backstory_synthesizer</code></td>
                        <td>Backstory, motivations</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>7. World</strong></td>
                        <td><code>modules/world/</code></td>
                        <td>Scene composition</td>
                        <td>‚Äî</td>
                    </tr>
                    <tr>
                        <td><strong>8. Export</strong></td>
                        <td><code>modules/export/</code></td>
                        <td>8 format exporters</td>
                        <td>3,112</td>
                    </tr>
                </tbody>
            </table>

            <div class="code-block">
                <pre><span class="comment"># VERIFIED: Direct from kagami.forge.__init__.py</span>
<span class="keyword">from</span> kagami.forge <span class="keyword">import</span> (
    <span class="class">ForgeService</span>,
    <span class="class">ForgeOperation</span>,
    <span class="class">ForgeRequest</span>,
    <span class="class">ForgeResponse</span>,
    get_forge_service,
)

<span class="comment"># ForgeOperation enum (service.py:43-57)</span>
<span class="class">ForgeOperation</span>.CHARACTER_GENERATION   <span class="comment"># "character.generate"</span>
<span class="class">ForgeOperation</span>.IMAGE_TO_CHARACTER     <span class="comment"># "character.from_image"</span>
<span class="class">ForgeOperation</span>.ANIMATION_FACIAL       <span class="comment"># "animation.facial"</span>
<span class="class">ForgeOperation</span>.ANIMATION_GESTURE      <span class="comment"># "animation.gesture"</span>
<span class="class">ForgeOperation</span>.ANIMATION_MOTION       <span class="comment"># "animation.motion"</span>
<span class="class">ForgeOperation</span>.GENESIS_VIDEO          <span class="comment"># "genesis.video"</span>
<span class="class">ForgeOperation</span>.VALIDATION             <span class="comment"># "validation"</span>
<span class="class">ForgeOperation</span>.CONTENT_SAFETY         <span class="comment"># "content_safety"</span>

<span class="comment"># Usage</span>
service = get_forge_service()
result = <span class="keyword">await</span> service.<span class="function">generate_character</span>(
    concept=<span class="string">"warrior princess"</span>,
    quality_mode=<span class="string">"draft"</span>,  <span class="comment"># "preview" | "draft" | "final"</span>
)</pre>
            </div>
        </section>

        <!-- Modules -->
        <section class="section" id="modules">
            <div class="section-header">
                <p class="section-number">03</p>
                <h2 class="section-title">Core Modules</h2>
                <p class="section-desc">
                    111 Python files organized by capability.
                </p>
            </div>

            <p class="category-header">Service Layer</p>
            <div class="cards-grid">
                <article class="module-card" style="--card-color: #FB923C">
                    <div class="card-icon">‚ö°</div>
                    <h3 class="card-name">ForgeService</h3>
                    <p class="card-path">forge/service.py</p>
                    <p class="card-desc">Unified entry point. Abstracts ForgeMatrix, handles request standardization, metrics, semantic caching.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">610</div><div class="card-stat-label">LOC ‚úì</div></div>
                        <div class="card-stat"><div class="card-stat-value">8</div><div class="card-stat-label">Operations</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">API</span><span class="tag">Async</span></div>
                </article>

                <article class="module-card" style="--card-color: #A78BFA">
                    <div class="card-icon">üéØ</div>
                    <h3 class="card-name">ForgeMatrix</h3>
                    <p class="card-path">forge/matrix/orchestrator.py</p>
                    <p class="card-desc">Pipeline orchestrator. ComponentRegistry tracks generation modules. Coordinates stage execution.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">368</div><div class="card-stat-label">LOC ‚úì</div></div>
                        <div class="card-stat"><div class="card-stat-value">8</div><div class="card-stat-label">Stages</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Orchestrator</span></div>
                </article>

                <article class="module-card" style="--card-color: #EF4444">
                    <div class="card-icon">üõ°Ô∏è</div>
                    <h3 class="card-name">SafetyGate</h3>
                    <p class="card-path">forge/safety.py</p>
                    <p class="card-desc">Content safety. Ethical check, threat detection. Fails closed ‚Äî violations never pass.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">121</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Safety</span></div>
                </article>

                <article class="module-card" style="--card-color: #FBBF24">
                    <div class="card-icon">üìä</div>
                    <h3 class="card-name">Schema</h3>
                    <p class="card-path">forge/schema.py</p>
                    <p class="card-desc">Data structures: Character, Mesh, Skeleton, Animation, VoiceProfile, PersonalityProfile, QualityMetrics.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">754</div><div class="card-stat-label">LOC ‚úì</div></div>
                        <div class="card-stat"><div class="card-stat-value">50+</div><div class="card-stat-label">Types</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Types</span><span class="tag">Dataclass</span></div>
                </article>
            </div>

            <p class="category-header">Generation Modules</p>
            <div class="cards-grid">
                <article class="module-card" style="--card-color: #FBBF24">
                    <div class="card-icon">üé®</div>
                    <h3 class="card-name">Visual Design</h3>
                    <p class="card-path">forge/modules/visual_design/</p>
                    <p class="card-desc">Text-to-3D mesh generation. CharacterVisualProfiler analyzes concepts.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">6</div><div class="card-stat-label">Files</div></div>
                        <div class="card-stat"><div class="card-stat-value">3,214</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">3D</span><span class="tag">ML</span></div>
                </article>

                <article class="module-card" style="--card-color: #F472B6">
                    <div class="card-icon">üé¨</div>
                    <h3 class="card-name">Motion</h3>
                    <p class="card-path">forge/modules/motion/</p>
                    <p class="card-desc">FacialAnimator with 50+ blendshapes. GestureEngine for body language. MotionRetargeting.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">9</div><div class="card-stat-label">Files</div></div>
                        <div class="card-stat"><div class="card-stat-value">3,861</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Animation</span><span class="tag">PyTorch</span></div>
                </article>

                <article class="module-card" style="--card-color: #A78BFA">
                    <div class="card-icon">üß†</div>
                    <h3 class="card-name">Personality Engine</h3>
                    <p class="card-path">forge/modules/behavior_ai/</p>
                    <p class="card-desc">Big Five personality generation. Six archetypes: Analytical, Expressive, Driving, Amiable, Creative, Guardian.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">4</div><div class="card-stat-label">Files</div></div>
                        <div class="card-stat"><div class="card-stat-value">1,472</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">LLM</span><span class="tag">AI</span></div>
                </article>

                <article class="module-card" style="--card-color: #60A5FA">
                    <div class="card-icon">üì¶</div>
                    <h3 class="card-name">Export Manager</h3>
                    <p class="card-path">forge/modules/export/</p>
                    <p class="card-desc">8 format exporters: FBX, GLTF, USD, OBJ, DAE, PLY, STL, X3D. Materials and animations included.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">12</div><div class="card-stat-label">Files</div></div>
                        <div class="card-stat"><div class="card-stat-value">3,112</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Export</span><span class="tag">Async</span></div>
                </article>
            </div>

            <p class="category-header">Integration Modules</p>
            <div class="cards-grid">
                <article class="module-card" style="--card-color: #34D399">
                    <div class="card-icon">üí¨</div>
                    <h3 class="card-name">Conversation</h3>
                    <p class="card-path">forge/modules/conversation/</p>
                    <p class="card-desc">ForgeConversationManager, RealtimeRoomStreamer, SmartHomeRoomMapper. Room-aware audio routing.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">6</div><div class="card-stat-label">Files</div></div>
                        <div class="card-stat"><div class="card-stat-value">1,930</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Audio</span><span class="tag">Realtime</span></div>
                </article>

                <article class="module-card" style="--card-color: #FB923C">
                    <div class="card-icon">üîó</div>
                    <h3 class="card-name">Rooms Export</h3>
                    <p class="card-path">forge/rooms_export.py</p>
                    <p class="card-desc">CRDT-based export to multiplayer Rooms. HybridLogicalClock, LWW-Register for conflict-free updates.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">1,128</div><div class="card-stat-label">LOC ‚úì</div></div>
                        <div class="card-stat"><div class="card-stat-value">CRDT</div><div class="card-stat-label">Sync</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">CRDT</span><span class="tag">Multiplayer</span></div>
                </article>

                <article class="module-card" style="--card-color: #A78BFA">
                    <div class="card-icon">üì°</div>
                    <h3 class="card-name">Streaming</h3>
                    <p class="card-path">forge/streaming.py</p>
                    <p class="card-desc">StreamingGenerator yields ProgressUpdate with stage, percent, message, preview_url, eta_seconds.</p>
                    <div class="card-stats">
                        <div class="card-stat"><div class="card-stat-value">129</div><div class="card-stat-label">LOC ‚úì</div></div>
                    </div>
                    <div class="module-tags"><span class="tag">Async</span><span class="tag">Generator</span></div>
                </article>
            </div>
        </section>

        <!-- Rooms -->
        <section class="section" id="rooms">
            <div class="section-header">
                <p class="section-number">04</p>
                <h2 class="section-title">Rooms Integration</h2>
                <p class="section-desc">
                    Export characters to multiplayer environments with CRDT sync.
                </p>
            </div>

            <div class="code-block">
                <pre><span class="comment"># VERIFIED: from kagami.forge import ForgeRoomsExporter</span>
<span class="keyword">from</span> kagami.forge <span class="keyword">import</span> <span class="class">ForgeRoomsExporter</span>

exporter = <span class="class">ForgeRoomsExporter</span>()

<span class="comment"># Export with CRDT semantics (rooms_export.py)</span>
success = <span class="keyword">await</span> exporter.<span class="function">export_character_to_room</span>(
    room_id=<span class="string">"gallery_01"</span>,
    character_data={
        <span class="string">"id"</span>: <span class="string">"warrior_01"</span>,
        <span class="string">"gltf_url"</span>: <span class="string">"https://cdn.example.com/warrior.glb"</span>,
    },
    position=[<span class="number">5.0</span>, <span class="number">0.0</span>, <span class="number">-3.0</span>],
)

<span class="comment"># CRDT guarantees: Commutative, Associative, Idempotent</span></pre>
            </div>
        </section>

        <!-- API -->
        <section class="section" id="api">
            <div class="section-header">
                <p class="section-number">05</p>
                <h2 class="section-title">API Reference</h2>
                <p class="section-desc">
                    REST endpoints from kagami_api/routes/command/forge/
                </p>
            </div>

            <div class="verified">
                <div class="verified-header">‚úì VERIFIED ROUTES (from __init__.py)</div>
                <pre>kagami_api/routes/command/forge/
‚îú‚îÄ‚îÄ generate.py          POST /generate
‚îú‚îÄ‚îÄ animate.py           POST /animate/*
‚îú‚îÄ‚îÄ validate.py          POST /validate
‚îú‚îÄ‚îÄ intent.py            POST /intent
‚îú‚îÄ‚îÄ image_generation.py  POST /image/*
‚îî‚îÄ‚îÄ content_safety.py    POST /safety/*</pre>
            </div>

            <div class="cards-grid">
                <article class="module-card" style="--card-color: #FB923C">
                    <div class="card-icon">üåê</div>
                    <h3 class="card-name">REST Endpoints</h3>
                    <p class="card-path">/api/command/forge/</p>
                    <p class="card-desc">FastAPI routes for character generation, animation, validation.</p>
                    <div class="code-block" style="margin-top: 16px;">
                        <pre>POST /generate     <span class="comment"># Character</span>
POST /animate/*    <span class="comment"># Animation</span>
POST /validate     <span class="comment"># Validation</span>
POST /intent       <span class="comment"># Intent parsing</span>
POST /image/*      <span class="comment"># Image gen</span>
POST /safety/*     <span class="comment"># Safety check</span></pre>
                    </div>
                </article>

                <article class="module-card" style="--card-color: #FBBF24">
                    <div class="card-icon">‚öôÔ∏è</div>
                    <h3 class="card-name">Quality Levels</h3>
                    <p class="card-path">schema.py:100-107</p>
                    <p class="card-desc">QualityLevel enum from schema.</p>
                    <div class="code-block" style="margin-top: 16px;">
                        <pre><span class="comment"># Verified from schema.py</span>
LOW    = <span class="string">"low"</span>
MEDIUM = <span class="string">"medium"</span>
HIGH   = <span class="string">"high"</span>
ULTRA  = <span class="string">"ultra"</span>
CUSTOM = <span class="string">"custom"</span></pre>
                    </div>
                </article>

                <article class="module-card" style="--card-color: #60A5FA">
                    <div class="card-icon">üìã</div>
                    <h3 class="card-name">Export Formats</h3>
                    <p class="card-path">schema.py:73-84</p>
                    <p class="card-desc">ExportFormat enum from schema.</p>
                    <div class="code-block" style="margin-top: 16px;">
                        <pre><span class="comment"># Verified from schema.py</span>
FBX  GLTF  GLB  USD
OBJ  DAE   BLEND
MAX  MAYA</pre>
                    </div>
                </article>

                <article class="module-card" style="--card-color: #A78BFA">
                    <div class="card-icon">üìÅ</div>
                    <h3 class="card-name">Export Modules</h3>
                    <p class="card-path">modules/export/</p>
                    <p class="card-desc">Actual exporter implementations.</p>
                    <div class="code-block" style="margin-top: 16px;">
                        <pre><span class="comment"># 12 files in export/</span>
fbx_exporter.py
gltf_exporter.py
usd_exporter.py
obj_exporter.py
dae_exporter.py
ply_exporter.py
stl_exporter.py
x3d_exporter.py</pre>
                    </div>
                </article>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-icon">üî®</div>
        <p class="footer-tagline">Forge ¬∑ Character Generation System</p>
        <p class="footer-desc">Part of <a href="../map/">Kagami</a> ¬∑ 34,689 LOC ¬∑ 111 files ¬∑ All counts verified with wc -l</p>
    </footer>

    <script>
        document.querySelectorAll('a[href^="#"]').forEach(a => {
            a.addEventListener('click', e => {
                e.preventDefault();
                document.querySelector(a.getAttribute('href'))?.scrollIntoView({ behavior: 'smooth' });
            });
        });
        console.log('%cüî® Forge', 'color: #FB923C; font-size: 24px; font-weight: bold;');
        console.log('%cAll LOC counts verified with wc -l ¬∑ 34,689 total', 'color: #34D399;');
    </script>
</body>
</html>
